<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>Media - Category - Asimov's Blog</title><link>https://asimov.top/categories/media/</link><description>Media - Category - Asimov's Blog</description><generator>Hugo -- gohugo.io</generator><managingEditor>1224513626@qq.com (asimov)</managingEditor><webMaster>1224513626@qq.com (asimov)</webMaster><lastBuildDate>Sat, 12 Jun 2021 21:23:46 +0800</lastBuildDate><atom:link href="https://asimov.top/categories/media/" rel="self" type="application/rss+xml"/><item><title>FFmpeg ç¼–ç å’Œç¼–è¾‘å…¥é—¨</title><link>https://asimov.top/ffmpeg-encoding-and-editing-course/</link><pubDate>Sat, 12 Jun 2021 21:23:46 +0800</pubDate><author>asimov</author><guid>https://asimov.top/ffmpeg-encoding-and-editing-course/</guid><description><![CDATA[<div class="featured-image">
                <img src="https://ahmadawais.com/wp-content/uploads/2021/05/FFmpeg.jpg" referrerpolicy="no-referrer">
            </div><p>æœ¬æ–‡ä¸»è¦å†…å®¹ç¿»è¯‘è‡ªä¸€ç¯‡ä»‹ç» FFmpeg å…¥é—¨çŸ¥è¯†çš„è‹±æ–‡ Web å¹»ç¯ç‰‡ï¼ŒåŠ å…¥äº†ä¸€äº›ä¸ªäººç†è§£ä¸å­¦ä¹ æ³¨é‡Šã€‚</p>
<p>æˆ‘ç¿»è¯‘è¿™ç¯‡æ–‡ç« çš„ç›®çš„ï¼Œä¸€æ˜¯å­¦ä¹  FFmpeg ç›¸å…³çš„çŸ¥è¯†ï¼ŒäºŒæ˜¯ç»ƒä¹ è‹±æ–‡ç¿»è¯‘èƒ½åŠ›ã€‚ä½†æ˜¯å—é™äºä¸ªäººæ°´å¹³ï¼Œæœ‰äº›è‹±æ–‡ä¸“ä¸šåè¯ç¿»è¯‘æˆä¸­æ–‡æœ‰äº›æ€ªå¼‚ï¼Œç¢°åˆ°è§‰å¾—ç¿»è¯‘ä¸å¥½çš„åœ°æ–¹ï¼Œæ–‡ä¸­ä¼šé™„ä¸ŠåŸæ–‡è¯è¯­ï¼Œå»ºè®®ç»“åˆåŸæ–‡æ›´å¥½ç†è§£ã€‚</p>
<p>åŸæ–‡ä½œè€…æ˜¯ä¸€åè§†é¢‘è´¨é‡ä¸ä½“éªŒè´¨é‡ç ”ç©¶å‘˜ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ UniversitÃ¤t Ilmenau çš„ä¸€ååšå£«ç”Ÿå’ŒåŠ©ç†ç ”ç©¶å‘˜ã€‚åŸæ–‡å†™å¾—éå¸¸æ£’ï¼Œæ–‡æœ¬è´¨é‡å’Œæ’ç‰ˆéƒ½æ¯”æˆ‘çš„è¯‘æ–‡æ›´å¥½ï¼Œå»ºè®®æœ‰è‹±æ–‡åŸºç¡€çš„æœ‹å‹ç›´æ¥é˜…è¯»åŸæ–‡ï¼Œé“¾æ¥ï¼š<a href="https://slhck.info/ffmpeg-encoding-course" target="_blank" rel="noopener noreffer ">FFMPEG ENCODING AND EDITING COURSE</a></p>
<h2 id="è¯¾ç¨‹ç›®æ ‡">è¯¾ç¨‹ç›®æ ‡</h2>
<ul>
<li>åŸºæœ¬æ¦‚å¿µ</li>
<li>å®‰è£… ffmpeg å’Œç›¸å…³å·¥å…·</li>
<li>ç¼–ç è§†é¢‘</li>
<li>ä½¿ç”¨è¿‡æ»¤å™¨ï¼ˆæ»¤é•œï¼‰</li>
<li>åˆ†æè§†é¢‘</li>
</ul>
<h2 id="å‰ç½®è¦æ±‚">å‰ç½®è¦æ±‚</h2>
<ul>
<li>è¿™ä»½å¹»ç¯ç‰‡ï¼ˆåŸæ–‡æ˜¯ web å¹»ç¯ç‰‡çš„å½¢å¼ï¼‰</li>
<li>å·²å®‰è£… ffmpegã€ffprobeã€ffplay</li>
<li>ä¸€äº›æ ·ä¾‹è§†é¢‘ï¼Œæ¯”å¦‚ï¼š<a href="http://distribution.bbb3d.renderfarming.net/video/mp4/bbb_sunflower_1080p_60fps_normal.mp4" target="_blank" rel="noopener noreffer ">Big Buck Bunny</a></li>
</ul>
<h2 id="èµ„æº">èµ„æº</h2>
<p>å¦‚æœä½ éœ€è¦ä¸€äº›æ ·ä¾‹è§†é¢‘ç”¨åšæµ‹è¯•ï¼Œå¯ä»¥å‚è€ƒ VQEG (Video Quality Experts Group) çš„è¯´æ˜ï¼šhttps://www.its.bldrdoc.gov/vqeg/video-datasets-and-organizations.aspx</p>
<h1 id="ffmpeg-ç®€ä»‹">FFMPEG ç®€ä»‹</h1>
<h2 id="å…³äº">å…³äº</h2>
<ul>
<li>ç”¨äºå¤šåª’ä½“ç¼–è¾‘ã€è½¬æ¢&hellip; çš„å…è´¹å¼€æºè½¯ä»¶</li>
<li>å¼€å§‹äº 2000 å¹´</li>
<li>æŒç»­ç»´æŠ¤å’Œå¼€å‘è‡³ä»Š</li>
</ul>
<p>ç±»ä¼¼æˆ–ç›¸å…³ï¼ˆä¸”æœ‰ç”¨ï¼‰çš„æ¡†æ¶ï¼š</p>
<ul>
<li><a href="https://www.imagemagick.org/" target="_blank" rel="noopener noreffer ">ImageMagick</a></li>
<li><a href="https://www.mltframework.org/" target="_blank" rel="noopener noreffer ">MLT Framework</a></li>
</ul>
<h2 id="å·¥å…·">å·¥å…·</h2>
<p>FFmpeg æ˜¯ä¸€ç³»åˆ—è½¯ä»¶åŒ…å’Œç±»åº“çš„ç»„åˆï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>å‘½ä»¤è¡Œå·¥å…·ï¼šffmpegã€ffprobeã€ffplay</li>
<li>ç±»åº“ï¼šlibavformat, libavcodec, libavfilter, â€¦</li>
</ul>
<p>å…¶ä¸­ç±»åº“è¢«è®¸å¤šé¡¹ç›®ä½¿ç”¨ï¼ˆæ¯”å¦‚ VLCã€MLT Framework ç­‰ï¼‰å¹¶ä¸”å¯ä»¥åœ¨ C/C++ ä»£ç ä¸­ä½¿ç”¨</p>
<h2 id="ç±»åº“">ç±»åº“</h2>
<ul>
<li>libavformatï¼šè¯»å–å’Œå†™å…¥å®¹å™¨æ ¼å¼ï¼ˆAVI, MKV, MP4, â€¦ï¼‰</li>
<li>libavcodecï¼šè¯»å–å’Œå†™å…¥ç¼–è§£ç å™¨ï¼ˆH.264, H.265, VP9, â€¦ï¼‰</li>
<li>libavfilterï¼šå„ç§ä¸ªæ ·çš„è§†é¢‘å’ŒéŸ³é¢‘è¿‡æ»¤å™¨</li>
<li>ä»¥åŠå…¶ä»–&hellip;</li>
</ul>
<p>å…³äºå¦‚ä½•ä»¥ç¼–ç¨‹çš„æ–¹å¼ä½¿ç”¨ç±»åº“çš„æ ·ä¾‹ï¼š
<a href="http://leixiaohua1020.github.io/#ffmpeg-development-examples" target="_blank" rel="noopener noreffer ">http://leixiaohua1020.github.io/#ffmpeg-development-examples</a></p>
<p>ä»¥åŠä¸€äº›å…¶ä»–æœ‰ç”¨çš„ï¼ˆé FFmpeg çš„ï¼‰ç±»åº“ï¼š</p>
<ul>
<li>OpenCV: é¢å‘æ›´å¤šç±»å‹çš„ä¿¡å·å¤„ç†</li>
<li>Python: MoviePy, pyav, scikit-video</li>
</ul>
<h2 id="æ¶æ„">æ¶æ„</h2>
<p>ç®€åŒ–çš„ FFmpeg æ•´ä½“æ¶æ„</p>
<p></p>
<h2 id="å®‰è£…--ç¼–è¯‘">å®‰è£… / ç¼–è¯‘</h2>
<table>
<thead>
<tr>
<th>å®‰è£…æ–¹å¼</th>
<th>ä¼˜åŠ¿</th>
<th>åŠ£åŠ¿</th>
</tr>
</thead>
<tbody>
<tr>
<td>ä»æºç ç¼–è¯‘</td>
<td>å¯ä»¥è‡ªå®šä¹‰æ‰€æœ‰é…ç½®ï¼Œå·¥å…·ï¼Œç¼–è§£ç å™¨</td>
<td>è´¹æ—¶é—´ï¼Œå‡çº§å›°éš¾</td>
</tr>
<tr>
<td>ä¸‹è½½é¢„ç¼–è¯‘ç‰ˆæœ¬</td>
<td>ç®€å•ä¸”å¿«é€Ÿ</td>
<td>ä¸æä¾›æ‰€æœ‰ç¼–è§£ç å™¨ï¼Œéœ€è¦æ‰‹åŠ¨å‡çº§</td>
</tr>
<tr>
<td>åŒ…ç®¡ç†å™¨å®‰è£…</td>
<td>ç®€å•ä¸”å¿«é€Ÿ</td>
<td>å¯èƒ½ä¸æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼Œä¹Ÿä¸æä¾›æ‰€æœ‰ç¼–è§£ç å™¨</td>
</tr>
</tbody>
</table>
<ul>
<li>è·å–æºä»£ç å’Œé¢„ç¼–è¯‘ç‰ˆæœ¬ï¼šhttp://ffmpeg.org/download.html</li>
<li>Windows é¢„ç¼–è¯‘ç‰ˆæœ¬ï¼šhttps://ffmpeg.org/download.html#build-windows</li>
</ul>
<h2 id="è·å–å¸®åŠ©">è·å–å¸®åŠ©</h2>
<ul>
<li>å®˜æ–¹æ–‡æ¡£ï¼šhttps://ffmpeg.org/ffmpeg-all.html</li>
<li>Wiki çŸ¥è¯†åº“ï¼šhttp://trac.ffmpeg.org/wiki</li>
<li>IRC èŠå¤©å®¤ï¼š#ffmpeg</li>
<li>é‚®ä»¶åˆ—è¡¨ï¼šhttps://lists.ffmpeg.org/mailman/listinfo/ffmpeg-user/</li>
<li>Stack Overflow: <a href="https://stackoverflow.com/" target="_blank" rel="noopener noreffer ">https://stackoverflow.com/</a> and use #ffmpeg</li>
<li>Super User: <a href="http://superuser.com/" target="_blank" rel="noopener noreffer ">http://superuser.com/</a> and use #ffmpeg</li>
<li>â€¦ æˆ–è€…é—®æˆ‘</li>
</ul>
<h1 id="åŸºç¡€è§†é¢‘ç¼–ç æ¦‚å¿µ">åŸºç¡€è§†é¢‘ç¼–ç æ¦‚å¿µ</h1>
<h2 id="å®¹å™¨æ ¼å¼container-formats">å®¹å™¨æ ¼å¼ï¼ˆContainer Formatsï¼‰</h2>
<p>å®¹å™¨åŒ…å«åª’ä½“æ•°æ®ã€‚æ¯”å¦‚ï¼š</p>
<ul>
<li>MP4: MPEG-4 Part 14 å®¹å™¨ï¼Œç”¨äº H.264, H.264, AAC éŸ³é¢‘, â€¦</li>
<li>MKV: å¯ä»¥åŒ…å«å‡ ä¹æ‰€æœ‰åª’ä½“ç¼–ç æ ¼å¼çš„ä¸‡èƒ½å®¹å™¨</li>
<li>WebM: MKV å®¹å™¨çš„å­é›†ï¼Œä¸»è¦ç”¨äºç½‘ç»œåª’ä½“æµ</li>
<li>AVI: ä¼ ç»Ÿå®¹å™¨</li>
</ul>
<p>åœ¨ FFmpeg ä¸­æŸ¥çœ‹æ”¯æŒçš„å®¹å™¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ffmpeg -formats
</span></span><span class="line"><span class="cl">File formats:
</span></span><span class="line"><span class="cl"> D. <span class="o">=</span> Demuxing supported
</span></span><span class="line"><span class="cl"> .E <span class="o">=</span> Muxing supported
</span></span><span class="line"><span class="cl"> --
</span></span><span class="line"><span class="cl"> D  3dostr          3DO STR
</span></span><span class="line"><span class="cl">  E 3g2             3GP2 <span class="o">(</span>3GPP2 file format<span class="o">)</span>
</span></span><span class="line"><span class="cl">  E 3gp             3GP <span class="o">(</span>3GPP file format<span class="o">)</span>
</span></span><span class="line"><span class="cl"> D  4xm             4X Technologies
</span></span><span class="line"><span class="cl">  E a64             a64 - video <span class="k">for</span> Commodore <span class="m">64</span>
</span></span><span class="line"><span class="cl"> D  aa              Audible AA format files
</span></span><span class="line"><span class="cl"> ...
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ç¼–è§£ç å™¨codecs">ç¼–è§£ç å™¨ï¼ˆCodecsï¼‰</h2>
<ul>
<li>ç¼–è§£ç å™¨ = ç¼–ç å™¨ / è§£ç å™¨</li>
<li>å¦‚ä½•ç¼–ç å’Œè§£ç è§†é¢‘ã€éŸ³é¢‘&hellip;çš„è§„èŒƒ</li>
<li>é€šå¸¸ä¸æ˜¯å¦‚ä½•ç¼–ç  / å‹ç¼©æ•°æ®çš„è§„èŒƒ</li>
<li>æœ‰æ—¶å€™ â€œç¼–è§£ç å™¨â€ è¢«ç”¨äºç›´æ¥æŒ‡ä»£ ç¼–ç  / è§£ç çš„è½¯ä»¶</li>
</ul>
<p>è¯‘è€…æŒ‰ï¼šCodec å¯ä»¥ç†è§£ä¸ºç¼–ç åè®®ï¼Œä¸åŒçš„åè®®å¤„ç†æ•°æ®ï¼ˆéŸ³è§†é¢‘ï¼‰çš„è§„åˆ™ä¸ä¸€æ ·ï¼Œåè®®æœ‰å…è´¹å¼€æºçš„ï¼Œè‡ªç„¶ä¹Ÿæœ‰å•†ç”¨ç§æœ‰çš„ã€‚</p>
<p>æŸ¥çœ‹ FFmpeg æ”¯æŒçš„ç¼–è§£ç å™¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ffmpeg -codecs
</span></span><span class="line"><span class="cl">Codecs:
</span></span><span class="line"><span class="cl"> D..... <span class="o">=</span> Decoding supported
</span></span><span class="line"><span class="cl"> .E.... <span class="o">=</span> Encoding supported
</span></span><span class="line"><span class="cl"> ..V... <span class="o">=</span> Video codec
</span></span><span class="line"><span class="cl"> ..A... <span class="o">=</span> Audio codec
</span></span><span class="line"><span class="cl"> ..S... <span class="o">=</span> Subtitle codec
</span></span><span class="line"><span class="cl"> ...I.. <span class="o">=</span> Intra frame-only codec
</span></span><span class="line"><span class="cl"> ....L. <span class="o">=</span> Lossy compression
</span></span><span class="line"><span class="cl"> .....S <span class="o">=</span> Lossless compression
</span></span><span class="line"><span class="cl"> -------
</span></span><span class="line"><span class="cl"> D.VI.. 012v                 Uncompressed 4:2:2 10-bit
</span></span><span class="line"><span class="cl"> D.V.L. 4xm                  4X Movie
</span></span><span class="line"><span class="cl"> D.VI.S 8bps                 QuickTime 8BPS video
</span></span><span class="line"><span class="cl"> .EVIL. a64_multi            Multicolor charset <span class="k">for</span> Commodore <span class="m">64</span> <span class="o">(</span>encoders: a64multi <span class="o">)</span>
</span></span><span class="line"><span class="cl"> .EVIL. a64_multi5           Multicolor charset <span class="k">for</span> Commodore 64, extended with 5th color <span class="o">(</span>colram<span class="o">)</span> <span class="o">(</span>encoders: a64multi5 <span class="o">)</span>
</span></span><span class="line"><span class="cl"> D.V..S aasc                 Autodesk RLE
</span></span><span class="line"><span class="cl"> D.VIL. aic                  Apple Intermediate Codec
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="æœ€é‡è¦çš„æœ‰æŸç¼–è§£ç å™¨lossy-codecs">æœ€é‡è¦çš„æœ‰æŸç¼–è§£ç å™¨ï¼ˆLossy Codecsï¼‰</h2>
<p>ç›®å‰ä¸»è¦ä½¿ç”¨çš„ï¼Œç”± ITU / ISO æ ‡å‡†åŒ–ï¼š</p>
<ul>
<li>ğŸ¥ H.262 / MPEG-2 Part H: ä¸»è¦æ˜¯å¹¿æ’­ã€ç”µè§†ä½¿ç”¨ï¼Œç”¨äºå‘åå…¼å®¹</li>
<li>ğŸ¥ H.264 / MPEG-4 Part 10: å½“ä»Šè§†é¢‘ç¼–ç å™¨çš„äº‹å®æ ‡å‡†ï¼ˆ2018å¹´ï¼‰</li>
<li>ğŸ¥ H.265 / HEVC / MPEG-H: H.264 çš„ç»§ä»»è€…ï¼Œè§†é¢‘è´¨é‡æå‡ 50%</li>
<li>ğŸ”Š MP3 / MPEG-2 Audio Layer III: æ›¾ç»æ˜¯éŸ³é¢‘ç¼–ç çš„äº‹å®æ ‡å‡†</li>
<li>ğŸ”Š AAC / ISO/IEC 14496-3:2009: é«˜çº§éŸ³é¢‘ç¼–ç æ ‡å‡†</li>
</ul>
<p>å…æˆæƒè´¹ï¼ˆå…ç‰ˆæƒçš„ï¼‰ä¸»è¦ç«äº‰è€…ï¼š</p>
<ul>
<li>ğŸ¥ VP8: ç”± Google æå‡ºçš„å¼€æºå…è´¹ç¼–è§£ç å™¨ï¼ˆå¦‚ä»Šä½¿ç”¨å¹¶ä¸å¤šï¼‰</li>
<li>ğŸ¥ VP9: VP8 çš„ç»§ä»»è€…ï¼Œå‡ ä¹å’Œ H.265 ä¸€æ ·å¥½</li>
<li>ğŸ¥ AV1: VP9 çš„ç»§ä»»è€…ï¼Œå£°ç§°æ¯” H.265 æ›´å¥½</li>
</ul>
<h2 id="æœ€é‡è¦çš„æ— æŸç¼–è§£ç å™¨lossless-codecs">æœ€é‡è¦çš„æ— æŸç¼–è§£ç å™¨ï¼ˆLossless Codecsï¼‰</h2>
<p>æ— æŸç¼–è§£ç å™¨åœ¨å­˜æ¡£ã€ç¼–è¾‘&hellip;é¢†åŸŸéå¸¸æœ‰ç”¨
æ— æŸç¼–ç  = åœ¨è¾ƒå°çš„æ–‡ä»¶ä½“ç§¯ä¸‹æ²¡æœ‰å‹ç¼©æŸå¤±</p>
<ul>
<li>ğŸ¥ Raw YUV, HuffYUV, FFV1, ffvhuff â€¦</li>
<li>ğŸ”Š Raw PCM, FLAC, ALAC, â€¦</li>
</ul>
<p>å½“ç„¶ï¼Œè¿˜æœ‰ â€œè§†è§‰æ— æŸâ€ ç¼–è§£ç å™¨ï¼š</p>
<ul>
<li>ğŸ¥ Apple ProRes, Avid DNxHD, JPEG2000, high-quality H.264/H.265, &hellip;</li>
<li>High bitrate and usually only I-framesï¼ˆé«˜ç ç‡å¸§å†…å‹ç¼©ï¼‰</li>
</ul>
<h2 id="ç¼–ç å™¨encoders">ç¼–ç å™¨ï¼ˆEncodersï¼‰</h2>
<ul>
<li>ç¼–ç å™¨æ˜¯è¾“å‡ºç¼–ç åå­—èŠ‚æµçš„å®é™…è½¯ä»¶</li>
<li>ç¼–ç å™¨ä¼šå½±å“è§†é¢‘çš„è´¨é‡å’Œæ€§èƒ½ï¼Œä¸€äº›ç¼–ç å™¨ä¼šå¥½äºå¦ä¸€äº›ï¼ˆæœ‰äº›å…è´¹ï¼Œæœ‰äº›ä¸å…è´¹ï¼‰</li>
</ul>
<p>è¯‘è€…æŒ‰ï¼šEncoder å¯ä»¥ç†è§£ä¸º Codecï¼ˆç¼–ç åè®®ï¼‰çš„å…·ä½“å®ç°æ–¹å¼ï¼Œä¸åŒçš„å®ç°æ–¹å¼å„æœ‰ä¼˜åŠ£ï¼Œæœ‰å…è´¹å¼€æºçš„å®ç°ï¼Œä¹Ÿæœ‰å•†ç”¨ç§æœ‰çš„å®ç°ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li>ğŸ¥ libx264: æœ€å—æ¬¢è¿çš„ H.264 ç¼–ç å™¨</li>
<li>ğŸ¥ NVENC: NVIDIA GPU ä¸“ç”¨çš„ H.264 ç¼–ç å™¨</li>
<li>ğŸ¥ libx265: å…è´¹å¼€æºçš„ HEVCï¼ˆH.265ï¼‰ç¼–ç å™¨</li>
<li>ğŸ¥ libvpx: Google æ¨å‡ºçš„ VP8 å’Œ VP9 ç¼–ç å™¨</li>
<li>ğŸ¥ libaom: AV1 ç¼–ç å™¨</li>
<li>ğŸ”Š libfdk-aac: AAC ç¼–ç å™¨</li>
<li>ğŸ”Š aac: åŸç”Ÿï¼ˆé»˜è®¤ï¼‰ FFmpeg AAC ç¼–ç å™¨</li>
<li>â€¦</li>
</ul>
<p>æ€»çš„æ¥è¯´ï¼Œç¼–ç å™¨æ–¹é¢æœ‰å¾ˆå¤šç«äº‰ã€‚</p>
<p>æŸ¥çœ‹ FFmpeg æ”¯æŒçš„ç¼–ç å™¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ffmpeg -encoders
</span></span><span class="line"><span class="cl">Encoders:
</span></span><span class="line"><span class="cl"> V..... <span class="o">=</span> Video
</span></span><span class="line"><span class="cl"> A..... <span class="o">=</span> Audio
</span></span><span class="line"><span class="cl"> S..... <span class="o">=</span> Subtitle
</span></span><span class="line"><span class="cl"> .F.... <span class="o">=</span> Frame-level multithreading
</span></span><span class="line"><span class="cl"> ..S... <span class="o">=</span> Slice-level multithreading
</span></span><span class="line"><span class="cl"> ...X.. <span class="o">=</span> Codec is experimental
</span></span><span class="line"><span class="cl"> ....B. <span class="o">=</span> Supports draw_horiz_band
</span></span><span class="line"><span class="cl"> .....D <span class="o">=</span> Supports direct rendering method <span class="m">1</span>
</span></span><span class="line"><span class="cl"> ------
</span></span><span class="line"><span class="cl"> V..... a64multi             Multicolor charset <span class="k">for</span> Commodore <span class="m">64</span> <span class="o">(</span>codec a64_multi<span class="o">)</span>
</span></span><span class="line"><span class="cl"> V..... a64multi5            Multicolor charset <span class="k">for</span> Commodore 64, extended with 5th color <span class="o">(</span>colram<span class="o">)</span> <span class="o">(</span>codec a64_multi5<span class="o">)</span>
</span></span><span class="line"><span class="cl"> V..... alias_pix            Alias/Wavefront PIX image
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="åƒç´ æ ¼å¼pixel-formats">åƒç´ æ ¼å¼ï¼ˆPixel Formatsï¼‰</h2>
<ul>
<li>è§†é¢‘æµä¸­åŸå§‹åƒç´ çš„è¡¨ç¤º</li>
<li>æŒ‡å®šäº®åº¦ / è‰²å½©å’Œé¥±å’Œåº¦çš„é‡‡æ ·é¡ºåº</li>
</ul>
<p></p>
<p>æŸ¥çœ‹ FFmpeg æ”¯æŒçš„åƒç´ æ ¼å¼ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">âœ  ~ ffmpeg -pix_fmts --hide_banner
</span></span><span class="line"><span class="cl">Pixel formats:
</span></span><span class="line"><span class="cl">I.... <span class="o">=</span> Supported Input  format <span class="k">for</span> conversion
</span></span><span class="line"><span class="cl">.O... <span class="o">=</span> Supported Output format <span class="k">for</span> conversion
</span></span><span class="line"><span class="cl">..H.. <span class="o">=</span> Hardware accelerated format
</span></span><span class="line"><span class="cl">...P. <span class="o">=</span> Paletted format
</span></span><span class="line"><span class="cl">....B <span class="o">=</span> Bitstream format
</span></span><span class="line"><span class="cl">FLAGS NAME            NB_COMPONENTS BITS_PER_PIXEL BIT_DEPTHS
</span></span><span class="line"><span class="cl">-----
</span></span><span class="line"><span class="cl">IO... yuv420p                <span class="m">3</span>             <span class="m">12</span>      8-8-8
</span></span><span class="line"><span class="cl">IO... yuyv422                <span class="m">3</span>             <span class="m">16</span>      8-8-8
</span></span><span class="line"><span class="cl">IO... rgb24                  <span class="m">3</span>             <span class="m">24</span>      8-8-8
</span></span><span class="line"><span class="cl">IO... bgr24                  <span class="m">3</span>             <span class="m">24</span>      8-8-8
</span></span><span class="line"><span class="cl">IO... yuv422p                <span class="m">3</span>             <span class="m">16</span>      8-8-8
</span></span><span class="line"><span class="cl">IO... yuv444p                <span class="m">3</span>             <span class="m">24</span>      8-8-8
</span></span><span class="line"><span class="cl">IO... yuv410p                <span class="m">3</span>              <span class="m">9</span>      8-8-8
</span></span><span class="line"><span class="cl">IO... yuv411p                <span class="m">3</span>             <span class="m">12</span>      8-8-8
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯‘è€…æŒ‰ï¼šè¿™å—æˆ‘ä¹Ÿæ²¡çœ‹æ˜ç™½ï¼Œå…ˆæ”¾ç€å§ ğŸ˜‚ï¼Œæˆ‘æ¯”è¾ƒå…³å¿ƒè§†é¢‘ç¼–ç ï¼ˆæ•°æ®å‹ç¼©ï¼‰çš„éƒ¨åˆ†</p>
<h1 id="ç”¨-ffmpeg-å‘½ä»¤è¡Œå·¥å…·ç¼–ç ">ç”¨ FFmpeg å‘½ä»¤è¡Œå·¥å…·ç¼–ç </h1>
<h2 id="åŸºæœ¬è¯­æ³•">åŸºæœ¬è¯­æ³•</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg &lt;global-options&gt; &lt;input-options&gt; -i &lt;input&gt; &lt;output-options&gt; &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å…¨å±€å‚æ•°ï¼ˆglobal-optionsï¼‰ç”¨äºæ—¥å¿—è¾“å‡ºï¼Œè¦†ç›–æ–‡ä»¶ç­‰</li>
<li>è¾“å…¥å‚æ•°ï¼ˆinput-optionsï¼‰ç”¨äºè¯»å–æ–‡ä»¶</li>
<li>è¾“å‡ºå‚æ•°ï¼ˆoutput-optionsï¼‰ç”¨äºï¼š
<ul>
<li>è½¬æ¢ï¼ˆç¼–ç æ ¼å¼ï¼Œè§†é¢‘è´¨é‡ç­‰ï¼‰</li>
<li>è¿‡æ»¤å™¨ï¼ˆfilteringï¼‰</li>
<li>æµæ˜ å°„ï¼ˆstream mappingï¼‰</li>
<li>&hellip;</li>
</ul>
</li>
</ul>
<p>å®Œæ•´çš„å¸®åŠ© / å‚è€ƒæ–‡æ¡£ï¼š<code>ffmpeg -h full</code> æˆ–è€… <code>man ffmpeg</code> ä½†æ˜¯å†…å®¹éå¸¸éå¸¸å¤šï¼</p>
<h2 id="è½¬ç å’Œè½¬æ¢transcoding-and-transmuxing">è½¬ç å’Œè½¬æ¢ï¼ˆTRANSCODING AND TRANSMUXINGï¼‰</h2>
<p>ä»ä¸€ç§ç¼–ç æ ¼å¼è½¬ç åˆ°å¦ä¸€ç§ç¼–ç æ ¼å¼ï¼ˆTranscodingï¼‰ï¼Œæ¯”å¦‚ç”¨ libx264 ç¼–ç å™¨è½¬ä¸º H.264 ç¼–ç æ ¼å¼</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -c:v libx264 output.mp4
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»ä¸€ç§è§†é¢‘å®¹å™¨è½¬æ¢ä¸ºå¦ä¸€ç§è§†é¢‘å®¹å™¨ï¼Œä¸ç”¨é‡æ–°ç¼–ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i input.mp4 -c copy output.mkv
</span></span></code></pre></td></tr></table>
</div>
</div><p>ffmpeng ä¼šä»è¾“å…¥ä¸­è·å–ä¸€ä¸ªè§†é¢‘ã€éŸ³é¢‘å’Œå­—å¹•æµå¹¶å°†å…¶æ˜ å°„åˆ°è¾“å‡ºæ–‡ä»¶ä¸­ã€‚</p>
<p>æ³¨é‡Šï¼š</p>
<ul>
<li>-c è®¾ç½®ç¼–ç å™¨ï¼ˆå‚è€ƒ ffmpeg -encoders)</li>
<li>-c å¤åˆ¶æ¯”ç‰¹æµï¼ˆcopy only copies bitstreamï¼‰</li>
<li>-c:v è®¾ç½®è§†é¢‘ç¼–ç å™¨</li>
<li>-c:a è®¾ç½®éŸ³é¢‘ç¼–ç å™¨</li>
<li>-an å’Œ -vn åˆ†åˆ«æ˜¯ç¦ç”¨éŸ³é¢‘å’Œè§†é¢‘æµ</li>
</ul>
<h3 id="è½¬ç çš„èƒŒåtranscoding-background">è½¬ç çš„èƒŒåï¼ˆTRANSCODING BACKGROUNDï¼‰</h3>
<p>èŠ‚é€‰è‡ª <a href="http://ffmpeg.org/ffmpeg-all.html" target="_blank" rel="noopener noreffer ">http://ffmpeg.org/ffmpeg-all.html</a>ï¼š</p>
<blockquote>
<p>ffmpeg [â€¦] read[s] input files and get packets containing encoded data from them. When there are multiple input files, ffmpeg tries to keep them synchronized [â€¦].
Encoded packets are then passed to the decoder. [â€¦] The decoder produces uncompressed frames [â€¦] which can be processed further by filtering [â€¦]. After filtering, the frames are passed to the encoder, which encodes them and outputs encoded packets. Finally those are passed to the muxer, which writes the encoded packets to the output file.</p>
</blockquote>
<p>è¯‘è€…æŒ‰ï¼šè¿™æ®µä¸“ä¸šåè¯å¤ªå¤šï¼Œå°è¯•ç¿»è¯‘äº†å‡ æ¬¡éƒ½æ„Ÿè§‰å¤ªåƒµç¡¬å¤ªå¥‡æ€ªäº†ã€‚å…¶å®å°±æ˜¯å‰é¢é‚£ä¸ªæ¶æ„å›¾çš„æ–‡å­—æè¿°ã€‚</p>
<p>å¤§æ¦‚æ„æ€æ˜¯ï¼šffmpeg ä»æ–‡ä»¶ä¸­è¯»å–ç¼–ç è¿‡çš„æ•°æ®åŒ…ï¼Œå¦‚æœæœ‰å¤šä¸ªæ–‡ä»¶ï¼Œffmpeg ä¼šå°è¯•åŒæ­¥å¤šä¸ªæ–‡ä»¶ã€‚ç„¶åè¿™äº›ç¼–ç è¿‡çš„æ•°æ®åŒ…ï¼ˆencoded packetsï¼‰ä¼šè¢«å‘é€åˆ°è§£ç å™¨ï¼ˆdecoderï¼‰ï¼Œè§£ç å™¨å°†è¿™äº›æ•°æ®åŒ…è§£ç ä¸ºåŸå§‹è§†é¢‘å¸§ï¼ˆuncompressed framesï¼‰ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨å„ç§è¿‡æ»¤å™¨ï¼ˆfiltersï¼‰æ¥å¤„ç†è¿™äº›è§†é¢‘å¸§ï¼ˆframesï¼‰ï¼Œç„¶åè¿™äº›å¤„ç†è¿‡åçš„è§†é¢‘å¸§ç‡ä¼šè¢«å‘é€åˆ°ç¼–ç å™¨ï¼ˆencoderï¼‰ï¼Œç¼–ç å™¨ä¼šå°†ä»–ä»¬ç¼–ç ä¸ºæ•°æ®åŒ…ï¼ˆencoded packetsï¼‰ï¼Œæœ€åè¿™äº›æ•°æ®åŒ…ä¼šè¢«å‘é€åˆ°æ··æµå™¨ï¼ˆmuxerï¼‰ï¼Œæœ€ç»ˆæ··æµå™¨å°†è¿™äº›æ•°æ®åŒ…è¾“å‡ºä¸ºæ–‡ä»¶ã€‚</p>
<h2 id="æŸ¥æ‰¾å’Œå‰ªåˆ‡seeking-and-cutting">æŸ¥æ‰¾å’Œå‰ªåˆ‡ï¼ˆSEEKING AND CUTTINGï¼‰</h2>
<p>ä» &lt;èµ·å§‹ç‚¹ï¼ˆstartï¼‰&gt; ç”¨ &lt;æŒç»­æ—¶é—´ï¼ˆdurationï¼‰&gt; æˆ–è€… &lt;ç»“æŸç‚¹ï¼ˆendï¼‰&gt; æ¥å‰ªåˆ‡è§†é¢‘</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -ss &lt;start&gt; -i &lt;input&gt; -t &lt;duration&gt; -c copy &lt;output&gt;
</span></span><span class="line"><span class="cl">ffmpeg -ss &lt;start&gt; -i &lt;input&gt; -to &lt;end&gt; -c copy &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¾‹å¦‚ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -ss 00:01:50 -i &lt;input&gt; -t 10.5 -c copy &lt;output&gt;
</span></span><span class="line"><span class="cl">ffmpeg -ss 2.5 -i &lt;input&gt; -to <span class="m">10</span> -c copy &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ä½¿ç”¨-seekng-æ³¨æ„äº‹é¡¹">ä½¿ç”¨ SEEKNG æ³¨æ„äº‹é¡¹</h3>
<ul>
<li>é‡æ–°ç¼–ç è§†é¢‘æ—¶ï¼Œseeking æ€»æ˜¯å¯ä»¥ç²¾ç¡®åˆ°æ—¶é—´æˆ³</li>
<li>å½“æ‹·è´è§†é¢‘æµè€Œæ²¡æœ‰ç»è¿‡é‡æ–°ç¼–ç æ—¶ï¼ˆ-c copyï¼‰ï¼Œffmpeg å¯èƒ½ä¼šåŒ…å«æœªæ˜¾ç¤ºä½†æ˜¯å¿…è¦çš„å¸§</li>
<li>ä½¿ç”¨ <code>-c copy</code> å‰ªåˆ‡è§†é¢‘æ—¶ï¼Œå¯èƒ½ä¼šäº§ç”Ÿé»‘å¸§å¼€å¤´çš„è§†é¢‘ï¼ˆåœ¨æŸäº›æ’­æ”¾å™¨ä¸Šï¼‰</li>
<li>è¯¦æƒ…å¯ä»¥æŸ¥çœ‹ï¼š
<ul>
<li><a href="http://trac.ffmpeg.org/wiki/Seeking" target="_blank" rel="noopener noreffer ">http://trac.ffmpeg.org/wiki/Seeking</a></li>
<li><a href="https://superuser.com/questions/138331/using-ffmpeg-to-cut-up-video" target="_blank" rel="noopener noreffer ">https://superuser.com/questions/138331/using-ffmpeg-to-cut-up-video</a></li>
</ul>
</li>
</ul>
<p>è¯‘è€…æŒ‰ï¼šä¹‹æ‰€ä»¥åœ¨å‰ªåˆ‡è§†é¢‘æ—¶ï¼Œè½¬ç äºä¸è½¬ç å­˜åœ¨æ—¶é—´å‡†ç¡®æ€§ä¸Šçš„å·®åˆ«ï¼Œæ˜¯å› ä¸ºè½¬ç æ—¶ï¼ŒåŸè§†é¢‘çš„æ¯ä¸€å¸§éƒ½ä¼šè¢« ffmpeg è¯»å–å‡ºæ¥ï¼ˆä¹Ÿå°±æ˜¯ decodeï¼‰ï¼Œå› æ­¤å¯ä»¥å‡†ç¡®çš„å®šä½åˆ°æ—¶é—´ç‚¹ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰è½¬ç ï¼Œç›´æ¥å¤åˆ¶è§†é¢‘æµçš„æ—¶å€™ï¼Œffmpeg å¹¶ä¸ä¼šé€å¸§åˆ†æè§†é¢‘ï¼Œè€Œæ˜¯é‡‡ç”¨â€œå…³é”®å¸§â€æ¥å®šä½æ—¶é—´ï¼Œå½“è®¾å®šçš„æ—¶é—´ç‚¹ä¸Šæ²¡æœ‰å…³é”®å¸§æ—¶ï¼Œå°±ä¼šå‡ºç°ä¸€äº›æ—¶é—´åå·®ã€‚</p>
<h2 id="è®¾ç½®è´¨é‡">è®¾ç½®è´¨é‡</h2>
<ul>
<li>è¾“å‡ºæ–‡ä»¶çš„è´¨é‡å–å†³äºç¼–ç å™¨é»˜è®¤è®¾ç½®äºåŸææ–™ï¼ˆä¹Ÿå°±æ˜¯åŸè§†é¢‘ï¼‰çš„è´¨é‡</li>
<li>ä¸è¦åœ¨æœªè®¾ç½®ä»»ä½•è´¨é‡æ°´å¹³çš„æƒ…å†µä¸‹è¿›è¡Œç¼–ç </li>
<li>é€šå¸¸æƒ…å†µä¸‹ï¼Œä½ éœ€è¦é€‰æ‹©ä¸€ä¸ªç›®æ ‡æ¯”ç‰¹ç‡æˆ–è€…è´¨é‡æ°´å¹³</li>
<li>ç›®æ ‡æ¯”ç‰¹ç‡å–å†³äºè§†é¢‘çš„ç±»å‹ï¼Œå¤§å°å’Œå¸§ç‡</li>
</ul>
<h3 id="è®¾ç½®è´¨é‡çš„å‚æ•°">è®¾ç½®è´¨é‡çš„å‚æ•°</h3>
<p>å¯èƒ½ä¼šä½¿ç”¨åˆ°çš„å‚æ•°ï¼ˆä»…ç¤ºä¾‹ï¼‰</p>
<ul>
<li>-b:v æˆ–è€… -b:a è®¾ç½®æ¯”ç‰¹ç‡
<ul>
<li>æ¯”å¦‚ï¼š-b:v 1000K = 1000kbit/s, -b:v 8M = 8Mbit/s</li>
</ul>
</li>
<li>q:v æˆ–è€… -q:a è®¾ç½®å›ºå®šè´¨é‡å‚æ•°
<ul>
<li>æ¯”å¦‚ï¼š-q:a 2 è®¾ç½®ä¸ºåŸç”Ÿ AAC ç¼–ç å™¨</li>
</ul>
</li>
</ul>
<p>ä¸€äº›ç¼–ç æ–¹å¼çš„ç¤ºä¾‹ï¼š</p>
<ul>
<li>-crf ç”¨æ¥è®¾ç½® libx264/libx265 çš„ æ’å®šç ç‡å› å­ï¼ˆ<a href="http://slhck.info/video/2017/02/24/crf-guide.html" target="_blank" rel="noopener noreffer ">Constant Rate Factor</a>ï¼‰</li>
<li>vbr ä¸º FDK-AAC ç¼–ç å™¨è®¾ç½®å›ºå®šè´¨é‡</li>
<li>è¿˜æœ‰å¾ˆå¤šå…¶ä»–å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨ <code>ffmpeg -h encoder=libx264 for examples</code> æŸ¥çœ‹ï¼Œå¦‚ä¸‹</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">âœ  ~ ffmpeg -h <span class="nv">encoder</span><span class="o">=</span>libx264 <span class="k">for</span> examples -hide_banner
</span></span><span class="line"><span class="cl">Encoder libx264 <span class="o">[</span>libx264 H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10<span class="o">]</span>:
</span></span><span class="line"><span class="cl">    General capabilities: dr1 delay threads 
</span></span><span class="line"><span class="cl">    Threading capabilities: other
</span></span><span class="line"><span class="cl">    Supported pixel formats: yuv420p yuvj420p yuv422p yuvj422p yuv444p yuvj444p nv12 nv16 nv21 yuv420p10le yuv422p10le yuv444p10le nv20le gray gray10le
</span></span><span class="line"><span class="cl">libx264 AVOptions:
</span></span><span class="line"><span class="cl">  -preset            &lt;string&gt;     E..V....... Set the encoding preset <span class="o">(</span>cf. x264 --fullhelp<span class="o">)</span> <span class="o">(</span>default <span class="s2">&#34;medium&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  -tune              &lt;string&gt;     E..V....... Tune the encoding params <span class="o">(</span>cf. x264 --fullhelp<span class="o">)</span>
</span></span><span class="line"><span class="cl">  -profile           &lt;string&gt;     E..V....... Set profile restrictions <span class="o">(</span>cf. x264 --fullhelp<span class="o">)</span> 
</span></span><span class="line"><span class="cl">  -fastfirstpass     &lt;boolean&gt;    E..V....... Use fast settings when encoding first pass <span class="o">(</span>default <span class="nb">true</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  -level             &lt;string&gt;     E..V....... Specify level <span class="o">(</span>as defined by Annex A<span class="o">)</span>
</span></span><span class="line"><span class="cl">  -passlogfile       &lt;string&gt;     E..V....... Filename <span class="k">for</span> <span class="m">2</span> pass stats
</span></span><span class="line"><span class="cl">  -wpredp            &lt;string&gt;     E..V....... Weighted prediction <span class="k">for</span> P-frames
</span></span><span class="line"><span class="cl">  -a53cc             &lt;boolean&gt;    E..V....... Use A53 Closed Captions <span class="o">(</span><span class="k">if</span> available<span class="o">)</span> <span class="o">(</span>default <span class="nb">true</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  -x264opts          &lt;string&gt;     E..V....... x264 options
</span></span><span class="line"><span class="cl">  -crf               &lt;float&gt;      E..V....... Select the quality <span class="k">for</span> constant quality mode <span class="o">(</span>from -1 to FLT_MAX<span class="o">)</span> <span class="o">(</span>default -1<span class="o">)</span>
</span></span><span class="line"><span class="cl">  -crf_max           &lt;float&gt;      E..V....... In CRF mode, prevents VBV from lowering quality beyond this point. <span class="o">(</span>from -1 to FLT_MAX<span class="o">)</span> <span class="o">(</span>default -1<span class="o">)</span>
</span></span><span class="line"><span class="cl">  -qp                &lt;int&gt;        E..V....... Constant quantization parameter rate control method <span class="o">(</span>from -1 to INT_MAX<span class="o">)</span> <span class="o">(</span>default -1<span class="o">)</span>
</span></span><span class="line"><span class="cl">  -aq-mode           &lt;int&gt;        E..V....... AQ method <span class="o">(</span>from -1 to INT_MAX<span class="o">)</span> <span class="o">(</span>default -1<span class="o">)</span>
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ä»€ä¹ˆæ˜¯-crf">ä»€ä¹ˆæ˜¯ CRFï¼Ÿ</h3>
<ul>
<li>CRF = <a href="http://slhck.info/video/2017/02/24/crf-guide.html" target="_blank" rel="noopener noreffer ">Constant Rate Factor</a></li>
<li>åœ¨æ•´ä¸ªç¼–ç è¿‡ç¨‹ä¸­ï¼Œä¿æŒæ’å®šçš„è´¨é‡</li>
<li>åœ¨ä¸å¤ªæ³¨é‡æ–‡ä»¶å¤§å°çš„æƒ…å†µä¸‹ï¼Œé€‚åˆä»¥å›ºå®šçš„è´¨é‡å­˜å‚¨è§†é¢‘</li>
</ul>
<h3 id="ç¤ºä¾‹è½¬ç ä¸º-h264part-1">ç¤ºä¾‹ï¼šè½¬ç ä¸º H.264ï¼ŒPart 1</h3>
<p>ä»¥å›ºå®šè´¨é‡ï¼ˆCRFï¼‰ç¼–ç ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -c:v libx264 -crf <span class="m">23</span> -c:a aac -b:a 128k output.mkv
</span></span></code></pre></td></tr></table>
</div>
</div><p>é’ˆå¯¹ H.264 ç¼–ç ï¼ŒCRF åœ¨ 18 åˆ° 28 ä¹‹é—´çœ‹èµ·æ¥â€œæ¯”è¾ƒå¥½â€ï¼ŒCRF å€¼è¶Šä½è§†é¢‘è´¨é‡è¶Šå¥½ã€‚ï¼ˆ HEVC å’Œ VP9 ç¼–ç çš„ CRF å€¼ä¸åŒï¼‰</p>
<h3 id="ç¤ºä¾‹è½¬ç ä¸º-h264part-2">ç¤ºä¾‹ï¼šè½¬ç ä¸º H.264ï¼ŒPart 2</h3>
<p>åŒé‡ç¼–ç ï¼ˆTwo-passï¼‰æ¨¡å¼ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -y -i &lt;input&gt; -c:v libx264 -b:v 8M -pass <span class="m">1</span> -c:a aac -b:a 128k -f mp4 /dev/null
</span></span><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -c:v libx264 -b:v 8M -pass <span class="m">2</span> -c:a aac -b:a 128k output.mp4
</span></span></code></pre></td></tr></table>
</div>
</div><p>Windows ç”¨æˆ·ï¼šç”¨ <code>nul</code> ä»£æ›¿ <code>/dev/null</code></p>
<p>æ›´å¤šç»†èŠ‚ï¼Œå‚è€ƒï¼š<a href="https://trac.ffmpeg.org/wiki/Encode/H.264" target="_blank" rel="noopener noreffer ">https://trac.ffmpeg.org/wiki/Encode/H.264</a></p>
<h2 id="ç ç‡æ§åˆ¶">ç ç‡æ§åˆ¶</h2>
<p>ä¸åŒçš„æ§åˆ¶æ–¹å¼ï¼š</p>
<ul>
<li>å›ºå®šç ç‡ï¼ˆConstant Bitrateï¼šCBRï¼‰</li>
<li>åŠ¨æ€ç ç‡ï¼ˆVariable Bitrateï¼šVBRï¼‰
<ul>
<li>å¹³å‡ç ç‡ï¼ˆAverage Bitrateï¼šABRï¼‰</li>
<li>æ’å®šè´¨é‡å‚æ•°ï¼ˆConstant quantization parameterï¼šCQPï¼‰</li>
<li>åŸºäºå¿ƒé‡Œè§†è§‰ç‰¹å¾çš„æ’å®šè´¨é‡ï¼Œæ¯”å¦‚ x264/x265/libvpx-vp9 ç¼–ç å™¨ä¸­ä½¿ç”¨ CRFï¼ˆConstant quality, based on psychovisual propertiesï¼‰</li>
<li>é™åˆ¶å‹ç ç‡ï¼ˆConstrained Bitrateï¼šVBVï¼‰</li>
</ul>
</li>
</ul>
<p>å…·ä½“åœ¨å“ªç§æƒ…å†µä¸‹ä½¿ç”¨å“ªç§ç ç‡æ¨¡å¼ï¼Œå‚è€ƒï¼š<a href="https://slhck.info/video/2017/03/01/rate-control.html" target="_blank" rel="noopener noreffer ">https://slhck.info/video/2017/03/01/rate-control.html</a></p>
<p><strong>é‡è¦è¯´æ˜ï¼šåˆé€‚çš„ç ç‡å–å†³äºå†…å®¹ç‰¹å¾ï¼</strong></p>
<p>è¯‘è€…æŒ‰ï¼šå¯¹è§†é¢‘æ¥è¯´ï¼Œç ç‡å¹¶éè¶Šé«˜è¶Šå¥½ï¼Œä¸åŒå†…å®¹ç‰¹å¾çš„è§†é¢‘å¯¹ç ç‡çš„è¦æ±‚å¹¶ä¸ä¸€æ ·ï¼Œå…·ä½“å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š<a href="https://sspai.com/post/66001" target="_blank" rel="noopener noreffer ">ä»€ä¹ˆå†³å®šäº†ä½ çœ‹åˆ°çš„ç”»è´¨</a></p>
<h3 id="ç ç‡æ§åˆ¶ç¤ºä¾‹">ç ç‡æ§åˆ¶ç¤ºä¾‹</h3>
<p></p>
<ul>
<li>ä¸åŒç ç‡æ§åˆ¶æ¨¡å¼ä¸‹ï¼Œå¸§å¤§å°éšæ—¶é—´å˜åŒ–å›¾ï¼ˆå·²å¹³æ»‘åŒ–å¤„ç†ï¼‰</li>
<li>æ³¨æ„ ABR æ¨¡å¼ä¸‹ï¼Œåœ¨ä¸€å¼€å§‹å¯¹ç ç‡çš„é”™è¯¯ä¼°è®¡</li>
</ul>
<h3 id="é€Ÿåº¦-vs-è´¨é‡-vs-æ–‡ä»¶å¤§å°speed-vs-quality-vs-file-size">é€Ÿåº¦ VS è´¨é‡ VS æ–‡ä»¶å¤§å°ï¼ˆSPEED VS. QUALITY VS. FILE SIZEï¼‰</h3>
<p>æœ‰æŸç¼–ç æ¨¡å¼æ€»æ˜¯åœ¨è¿™ä¸‰è€…ä¹‹é—´é€‰æ‹©</p>
<p></p>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li>ä½ å¯ä»¥è®©è§†é¢‘è´¨é‡åˆå¥½ï¼Œç¼–ç åˆå¿«ï¼Œä½†æ˜¯è¾“å‡ºæ–‡ä»¶ä¼šå¾ˆå¤§</li>
<li>ä½ å¯ä»¥è®©è§†é¢‘è´¨é‡åˆå¥½ï¼Œæ–‡ä»¶åˆå°ï¼Œä½†æ˜¯ç¼–ç é€Ÿåº¦ä¼šå¾ˆæ…¢</li>
<li>ä½ å¯ä»¥è®©æ–‡ä»¶åˆå°ï¼Œç¼–ç åˆå¿«ï¼Œä½†æ˜¯è§†é¢‘è´¨é‡å°±ä¼šæ¯”è¾ƒå·®</li>
</ul>
<p>ç¼–è€…æŒ‰ï¼šå‡¡äº‹éœ€è¦åšæŠ‰æ‹©çš„åœ°æ–¹ï¼Œä¸å¯èƒ½ä¸‰è§’æ€»åœ¨é‚£å„¿ç­‰ç€ä½ ã€‚è§†é¢‘ç¼–ç æ—¶å¦‚ä½•å¹³è¡¡é€Ÿåº¦ã€è´¨é‡å’Œæ–‡ä»¶å¤§å°ï¼Œæ˜¯æœ€é‡è¦ä¹Ÿæ˜¯æœ€å¤æ‚çš„è¯¾é¢˜ä¹‹ä¸€ï¼Œåé¢ä¼šå­¦ä¹ /æ’°å†™/ç¿»è¯‘æ›´å¤šçš„æ–‡ç« æ¥ä»‹ç»ã€‚</p>
<h3 id="x264-ç¼–ç å™¨ä¸­çš„é€Ÿåº¦è´¨é‡é¢„è®¾">X264 ç¼–ç å™¨ä¸­çš„é€Ÿåº¦/è´¨é‡é¢„è®¾</h3>
<p>ä½¿ç”¨é¢„è®¾æ¥é€‰æ‹© libx264 çš„ç¼–ç é€Ÿåº¦</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -c:v libx264 -crf <span class="m">23</span> -preset ultrafast -an output.mkv
</span></span><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -c:v libx264 -crf <span class="m">23</span> -preset medium -an output.mkv
</span></span><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -c:v libx264 -crf <span class="m">23</span> -preset veryslow -an output.mkv
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰€æœ‰é¢„è®¾ï¼šultrafast, superfast, veryfast, faster, fast, medium, slow, slower, veryslow</p>
<p>åŒç­‰è´¨é‡ä¸‹ï¼Œä¸€äº›ç¼–ç é€Ÿåº¦äºæ–‡ä»¶ä½“ç§¯çš„å¯¹æ¯”æ ·ä¾‹ï¼š</p>
<table>
<thead>
<tr>
<th>Preset</th>
<th>Encoding Time</th>
<th>File Size</th>
</tr>
</thead>
<tbody>
<tr>
<td>ultrafast</td>
<td>4.85s</td>
<td>15M</td>
</tr>
<tr>
<td>medium</td>
<td>24.13s</td>
<td>5.2M</td>
</tr>
<tr>
<td>veryslow</td>
<td>112.23s</td>
<td>4.9M</td>
</tr>
</tbody>
</table>
<h2 id="æ”¹å˜å¸§ç‡">æ”¹å˜å¸§ç‡</h2>
<p>ç®€å•çš„é€šè¿‡ä¸¢å¼ƒå¸§å’Œå¤åˆ¶å¸§çš„æ–¹å¼æ¥æ”¹å˜å¸§ç‡ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -r <span class="m">24</span> &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ›´å¤æ‚çš„æ–¹æ³•æ¶‰åŠåˆ°è¿‡æ»¤å™¨ï¼ˆfilterï¼‰å‚è€ƒ fps, mpdecimate, minterpolate filters:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -filter:v <span class="nv">fps</span><span class="o">=</span><span class="m">24</span> &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="è½¨é“æ˜ å°„stream-mapping">è½¨é“æ˜ å°„ï¼ˆSTREAM MAPPINGï¼‰</h2>
<p>æ¯ä¸€ä¸ªæ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ IDï¼Œä» 0 å¼€å§‹</p>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li><code>0:0</code> æ˜¯ç¬¬ä¸€ä¸ªè¾“å…¥æ–‡ä»¶çš„ç¬¬ä¸€æ¡è½¨é“ï¼ˆSteamï¼‰</li>
<li><code>0:1</code> æ˜¯ç¬¬ä¸€ä¸ªè¾“å…¥æ–‡ä»¶çš„ç¬¬äºŒæ¡è½¨é“</li>
<li><code>2:a:0</code> æ˜¯ç¬¬ä¸‰ä¸ªè¾“å…¥æ–‡ä»¶çš„ç¬¬ä¸€æ¡éŸ³è½¨</li>
<li>&hellip;</li>
</ul>
<p>ä½ å¯ä»¥å°†è¾“å…¥æ–‡ä»¶çš„è½¨é“æ˜ å°„åˆ°è¾“å‡ºæ–‡ä»¶ä¸­ï¼ˆmap input streams to outputï¼‰ä¾‹å¦‚ï¼šå°†éŸ³é¢‘æ·»åŠ åˆ°è§†é¢‘ä¸­ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i input.mp4 -i input.m4a -c copy -map 0:v:0 -map 1:a:0 output.mp4
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ›´å¤šç»†èŠ‚è¯·å‚è€ƒï¼š<a href="http://trac.ffmpeg.org/wiki/Map" target="_blank" rel="noopener noreffer ">http://trac.ffmpeg.org/wiki/Map</a></p>
<h2 id="ç®€å•è¿‡æ»¤å™¨simple-filtering">ç®€å•è¿‡æ»¤å™¨ï¼ˆSIMPLE FILTERINGï¼‰</h2>
<p>FFmpeg æœ‰å¾ˆå¤šè§†é¢‘ã€éŸ³é¢‘ã€å­—å¹•çš„è¿‡æ»¤å™¨ï¼ˆfilterï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -filter:v <span class="s2">&#34;&lt;filter1&gt;,&lt;filter2&gt;,&lt;filter3&gt;&#34;</span> &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸€ä¸ªè¿‡æ»¤å™¨ï¼ˆæ»¤é•œï¼‰æœ‰ä¸€ä¸ªåç§°ï¼Œä¸€äº›å¯é€‰é¡¹ï¼Œä»¥åŠä¸€äº›é¢„è®¾å‚æ•°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">-filter:v &lt;name&gt;<span class="o">=</span>&lt;option1&gt;<span class="o">=</span>&lt;value1&gt;:&lt;option2&gt;<span class="o">=</span>&lt;value2&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ç¼©æ”¾scaling">ç¼©æ”¾ï¼ˆSCALINGï¼‰</h3>
<p>ç¼©æ”¾åˆ° 320 x 240</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -vf <span class="s2">&#34;scale=w=320:h=240&#34;</span> &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¼©æ”¾åˆ°é«˜åº¦ 240 ä¸”ä¿æŒçºµæ¨ªæ¯”å¯è¢« 2 æ•´é™¤</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -vf <span class="nv">scale</span><span class="o">=</span><span class="nv">w</span><span class="o">=</span>-2:h<span class="o">=</span><span class="m">240</span> &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¼©æ”¾åˆ° 1280 x 720ï¼Œå¦‚æœéœ€è¦çš„è¯ç¼©æ”¾åˆ°æ›´å°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -vf <span class="s2">&#34;scale=1280:720:force_original_aspect_ratio=decrease&#34;</span> &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ›´å¤šå…³äºç¼©æ”¾çš„æŠ€å·§ï¼š</p>
<ul>
<li><a href="http://trac.ffmpeg.org/wiki/Scaling%20%28resizing%29%20with%20ffmpeg" target="_blank" rel="noopener noreffer ">http://trac.ffmpeg.org/wiki/Scaling%20(resizing)%20with%20ffmpeg</a></li>
<li><a href="https://superuser.com/questions/547296/" target="_blank" rel="noopener noreffer ">https://superuser.com/questions/547296/</a></li>
</ul>
<h3 id="å¡«å……padding">å¡«å……ï¼ˆPADDINGï¼‰</h3>
<p>å¡«å……é»‘è¾¹åˆ°æ–‡ä»¶ä¸­ï¼Œä¾‹å¦‚å°† 1920 x 800 çš„è§†é¢‘å¡«å……åˆ° 1920 x 1080ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -vf <span class="s2">&#34;pad=1920:1080:(ow-iw)/2:(oh-ih)/2&#34;</span> &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p></p>
<p>ä½¿ç”¨å¤‡æ³¨ï¼š</p>
<ul>
<li>å¯ä»¥ä½¿ç”¨æ•°å­¦è¡¨è¾¾å¼</li>
<li>ow å’Œ oh æ˜¯è¾“å‡ºæ–‡ä»¶çš„å®½å’Œé«˜</li>
<li>iw å’Œ ih æ˜¯è¾“å…¥æ–‡ä»¶çš„å®½å’Œé«˜</li>
</ul>
<h3 id="æ·¡å…¥æ·¡å‡ºfading">æ·¡å…¥æ·¡å‡ºï¼ˆFADINGï¼‰</h3>
<p>åœ¨ç‰¹å®šçš„æ—¶é—´ç‚¹ä½¿ç”¨æŒ‡å®šæŒç»­æ—¶é—´çš„ç®€å•æ·¡å…¥æ·¡å‡ºæ•ˆæœï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -filter:v <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="s2">&#34;fade=t=in:st=0:d=5,fade=t=out:st=30:d=5&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯‘è€…æŒ‰ï¼šä½¿ç”¨ FFmpeg å‘½ä»¤è¡Œæ—¶ï¼Œæœ‰æ—¶ä¸€è¡Œä»£ç å¤ªé•¿ä¸æ–¹ä¾¿ç¼–å†™å’ŒæŸ¥çœ‹ï¼Œå°±å¯ä»¥ä½¿ç”¨æ¢è¡Œç¬¦åˆ†è¡Œç¼–å†™ï¼Œä¸åŒçš„ Shell æœ‰ä¸åŒçš„æ¢è¡Œç¬¦ï¼Œä¾‹å¦‚ â€œ\â€ æ˜¯ Bash çš„æ¢è¡Œç¬¦ï¼ŒWindows ä¸‹ CMD çš„æ¢è¡Œç¬¦æ˜¯ â€œ^â€ï¼Œè¯·æ³¨æ„æ›¿æ¢ã€‚</p>
<h3 id="æ–‡æœ¬ç»˜å›¾--æ–‡å­—æ°´å°drawing-text">æ–‡æœ¬ç»˜å›¾ / æ–‡å­—æ°´å°ï¼ˆDRAWING TEXTï¼‰</h3>
<p>ç”¨äºåœ¨è§†é¢‘ä¸ŠåŠ ä¸Šæ–‡æœ¬çš„å¤æ‚ç³»ç»Ÿï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -vf <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span><span class="nv">drawtext</span><span class="o">=</span><span class="s2">&#34;text=&#39;Test Text&#39;:x=100:y=50:\
</span></span></span><span class="line"><span class="cl"><span class="s2">fontsize=24:fontcolor=yellow:box=1:boxcolor=red&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>&lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å­—ä½“ã€å¤§å°ã€ä½ç½®ã€é¢œè‰²&hellip;éƒ½æœ‰éƒ½æœ‰å„ç§ç›¸å…³çš„å‚æ•°</li>
<li>æ–‡å­—çƒ§å½•åŠŸèƒ½å¯ä»¥æ‹“å±•ï¼Œä¾‹å¦‚æŒ‰å¸§æ•°æˆ–è€…æ—¶é—´ç çƒ§å½•</li>
</ul>
<p>æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œå‚è€ƒï¼š<a href="http://ffmpeg.org/ffmpeg-all.html#drawtext-1" target="_blank" rel="noopener noreffer ">http://ffmpeg.org/ffmpeg-all.html#drawtext-1</a></p>
<h2 id="å¤æ‚è¿‡æ»¤å™¨complex-filtering">å¤æ‚è¿‡æ»¤å™¨ï¼ˆCOMPLEX FILTERINGï¼‰</h2>
<p>å¤æ‚è¿‡æ»¤å™¨ä¸æ­¢ä¸€ä¸ªè¾“å…¥æˆ–è€…è¾“å‡ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input1&gt; -i &lt;input2&gt; -filter_complex <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="s2">&#34;[0:v:0][1:v:0]overlay[outv]&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -map <span class="s2">&#34;[outv]&#34;</span> &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿‡ç¨‹æ‹†è§£ï¼š</p>
<ul>
<li>æŒ‡å®šè¾“å…¥åˆ°è¿‡æ»¤é“¾ï¼ˆfilterchainï¼‰ï¼ˆä¾‹å¦‚ [0:v:0][1:v:0]ï¼‰</li>
<li>æŒ‡å®šè¿‡æ»¤é“¾ä¸­çš„æ»¤é•œï¼ˆä¾‹å¦‚ï¼šoverlayï¼‰</li>
<li>æŒ‡å®šè¿‡æ»¤é“¾çš„è¾“å‡ºæ ‡ç­¾ï¼ˆä¾‹å¦‚ï¼š[outv]ï¼‰</li>
<li>æ˜ å°„è¾“å‡ºæ ‡ç­¾åˆ°è¾“å‡ºæ–‡ä»¶</li>
<li>ä½¿ç”¨ ; ä¸€æ¬¡å¯ä»¥åŒæ—¶ä½¿ç”¨å¤šä¸ªè¿‡æ»¤é“¾</li>
</ul>
<p>æ›´å¤šè¯¦ç»†å†…å®¹ï¼Œå‚è€ƒï¼š<a href="http://ffmpeg.org/ffmpeg-all.html#Filtergraph-syntax-1" target="_blank" rel="noopener noreffer ">http://ffmpeg.org/ffmpeg-all.html#Filtergraph-syntax-1</a></p>
<h3 id="æ‹¼æ¥è½¨é“concatenating-streams">æ‹¼æ¥è½¨é“ï¼ˆCONCATENATING STREAMSï¼‰</h3>
<p>è§£ç ä¸‰ä¸ªè§†é¢‘/éŸ³é¢‘è½¨é“å¹¶æ‹¼æ¥åˆ°å¦ä¸€ä¸ªä¸­ï¼š</p>
<p></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input1&gt; -i &lt;input2&gt; -i &lt;input3&gt; -filter_complex <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="s2">&#34;[0:0][0:1][1:0][1:1][2:0][2:1]concat=n=3:v=1:a=1[outv][outa]&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -map <span class="s2">&#34;[outv]&#34;</span> -map <span class="s2">&#34;[outa]&#34;</span> &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ›´å¤šä¿¡æ¯ï¼Œå‚è€ƒï¼š<a href="http://trac.ffmpeg.org/wiki/Concatenate" target="_blank" rel="noopener noreffer ">http://trac.ffmpeg.org/wiki/Concatenate</a>ï¼ˆä¹Ÿé€‚ç”¨äºå…¶ä»–æ–¹æ³•ï¼‰</p>
<h3 id="æ—¶é—´çº¿ç¼–è¾‘timeline-editing">æ—¶é—´çº¿ç¼–è¾‘ï¼ˆTIMELINE EDITINGï¼‰</h3>
<p>ä»…åœ¨ç‰¹å®šæ—¶é—´ç‚¹å¯ç”¨è¿‡æ»¤å™¨</p>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li>åœ¨å·¦ä¸Šè§’æ˜¾ç¤ºæ°´å°</li>
<li>ä»…åœ¨ç¬¬ 1 å’Œç¬¬ 2 ç§’æ˜¾ç¤º</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;video&gt; -i &lt;watermark&gt; -filter_complex <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="s2">&#34;[0:v][1:v]overlay=10:10:enable=&#39;between(t,1,2)&#39;[outv]&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -map <span class="s2">&#34;[outv]&#34;</span> &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ›´å¤šç”¨æ³•ï¼Œè¯·å‚è€ƒï¼š<a href="http://ffmpeg.org/ffmpeg-all.html#Timeline-editing" target="_blank" rel="noopener noreffer ">http://ffmpeg.org/ffmpeg-all.html#Timeline-editing</a></p>
<h2 id="å…¶ä»–è¿‡æ»¤å™¨">å…¶ä»–è¿‡æ»¤å™¨</h2>
<p>é™¤äº†å‰é¢ä»‹ç»çš„é‚£äº›è¿‡æ»¤å™¨ï¼Œffmpeg ç”Ÿæ€ä¸­è¿˜æœ‰å¾ˆå¤šå¾ˆå¤šå…¶ä»–çš„è¿‡æ»¤å™¨ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li>ä½¿ç”¨é€‰æ‹©è¿‡æ»¤å™¨æ£€æµ‹åœºæ™¯å˜åŒ–</li>
<li>å»é™¤æ°´å°ï¼ˆdelogoï¼‰</li>
<li>æ¨¡ç³Šã€è¾¹ç¼˜æ£€æµ‹å’Œå·ç§¯æ»¤æ³¢å™¨</li>
<li>è§†é¢‘ç¨³å®š</li>
<li>çŸ¢é‡ç¤ºæ³¢å™¨ã€ç›´æ–¹å›¾å’Œå…¶ä»–ä¿¡æ¯</li>
<li>è‰²åº¦å’Œ alpha æ§åˆ¶</li>
<li>å­—å¹•ç¼–è¾‘</li>
<li>&hellip;</li>
</ul>
<h2 id="è®¡ç®—ç®€å•çš„è´¨é‡æŒ‡æ ‡">è®¡ç®—ç®€å•çš„è´¨é‡æŒ‡æ ‡</h2>
<h3 id="psnr-peak-signal-to-noise-ratio">PSNR (Peak Signal To Noise Ratio)</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ffmpeg -i &lt;degraded&gt; -i &lt;reference&gt; -filter_complex psnr -f null /dev/null
</span></span><span class="line"><span class="cl"><span class="o">[</span>Parsed_psnr_0 @ 0x7fdb187045c0<span class="o">]</span> PSNR y:33.437789 u:39.814416 v:39.319141 average:34.698320 min:29.305186 max:inf
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯‘è€…æŒ‰ï¼šPSNR ä¸­æ–‡æ ‡å‡†è¯‘åä¸ºâ€œå³°å€¼ä¿¡å™ªæ¯”â€ï¼Œæ˜¯ä¸€ä¸ªæ¯”è¾ƒæˆç†Ÿçš„è¡¡é‡å‹ç¼©å½±åƒä¿¡å™ªæ¯”çš„æŒ‡æ ‡ï¼Œè¯¦æƒ…å¯ä»¥å‚è€ƒ <a href="https://zh.wikipedia.org/zh-cn/%E5%B3%B0%E5%80%BC%E4%BF%A1%E5%99%AA%E6%AF%94" target="_blank" rel="noopener noreffer ">ä¸­æ–‡ç»´åŸºç™¾ç§‘ï¼šå³°å€¼ä¿¡å™ªæ¯”</a></p>
<h3 id="ssim-structural-similarityhttpsenwikipediaorgwikissim">SSIM (<a href="https://en.wikipedia.org/wiki/SSIM" target="_blank" rel="noopener noreffer ">Structural Similarity</a>)</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ffmpeg -i &lt;degraded&gt; -i &lt;reference&gt; -filter_complex ssim -f null /dev/null
</span></span><span class="line"><span class="cl"><span class="o">[</span>Parsed_ssim_0 @ 0x7fbf0500b660<span class="o">]</span> SSIM Y:0.925477 <span class="o">(</span>11.277116<span class="o">)</span> U:0.948906 <span class="o">(</span>12.916325<span class="o">)</span> V:0.946795 <span class="o">(</span>12.740513<span class="o">)</span> All:0.932935 <span class="o">(</span>11.735054<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯‘è€…æŒ‰ï¼šSSIM ä¸­æ–‡ä¸€èˆ¬è¯‘ä¸ºâ€œç»“æ„ç›¸ä¼¼æ€§â€ï¼Œæ˜¯è¡¡é‡ä¸¤å¹…å›¾åƒç›¸ä¼¼åº¦çš„æŒ‡æ ‡ï¼Œå…¶è¯¦ç»†çš„ç§‘æ™®å’Œä½¿ç”¨å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š<a href="https://www.bilibili.com/read/cv7974104/" target="_blank" rel="noopener noreffer ">ä½¿ç”¨SSIMé‡åŒ–è¯„ä»·è§†é¢‘ç¼–ç è´¨é‡</a></p>
<p>è¯‘è€…æŒ‰ï¼šé™¤äº†åŸä½œè€…åˆ—å‡ºçš„ PSNR å’Œ SSIM ä¸¤ä¸ªæŒ‡æ ‡å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ª Netflix å’Œ å—åŠ å·å¤§å­¦è”åˆå¼€å‘çš„ <a href="https://en.wikipedia.org/wiki/Video_Multimethod_Assessment_Fusion" target="_blank" rel="noopener noreffer ">VMAF</a> ï¼ˆVideo Multimethod Assessment Fusionï¼‰æ˜¯ç›®å‰ Netflix ä¸»è¦ä½¿ç”¨çš„æŒ‡æ ‡ï¼Œè¯¦æƒ…è¿˜æ˜¯å¯ä»¥å‚è€ƒå‰æ–‡æåˆ°çš„è¿™ç¯‡æ–‡ç« ï¼š<a href="https://sspai.com/post/66001" target="_blank" rel="noopener noreffer ">ä»€ä¹ˆå†³å®šäº†ä½ çœ‹åˆ°çš„ç”»è´¨</a></p>
<h1 id="ä½¿ç”¨-ffprobe-è·å–åª’ä½“ä¿¡æ¯">ä½¿ç”¨ ffprobe è·å–åª’ä½“ä¿¡æ¯</h1>
<h2 id="åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ</h2>
<p>åŸºç¡€è¯­æ³•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffprobe &lt;input&gt;
</span></span><span class="line"><span class="cl">    <span class="o">[</span>-select_streams &lt;selection&gt;<span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="o">[</span>-show_streams<span class="p">|</span>-show_format<span class="p">|</span>-show_frames<span class="p">|</span>-show_packets<span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="o">[</span>-show_entries &lt;entries&gt;<span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="o">[</span>-of &lt;output-format&gt;<span class="o">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è§£é‡Šï¼š</p>
<ul>
<li>select_streams ç”¨äºæŒ‡å®šé€‰æ‹©è§†é¢‘æˆ–è€…éŸ³é¢‘</li>
<li>show_ ç”¨äºé€‰æ‹©æ˜¾ç¤ºå“ªç§ç±»å‹çš„ä¿¡æ¯</li>
<li>show_entries ç”¨äºé€‰æ‹©æ˜¾ç¤ºæ›´å°‘çš„ä¿¡æ¯</li>
<li>of ç”¨äºè®¾ç½®è¾“å‡ºæ ¼å¼</li>
</ul>
<p>æ›´å¤šä¿¡æ¯ï¼Œå‚è€ƒï¼š</p>
<ul>
<li><a href="https://ffmpeg.org/ffprobe.html" target="_blank" rel="noopener noreffer ">https://ffmpeg.org/ffprobe.html</a></li>
<li><a href="http://trac.ffmpeg.org/wiki/FFprobeTips" target="_blank" rel="noopener noreffer ">http://trac.ffmpeg.org/wiki/FFprobeTips</a></li>
</ul>
<h2 id="å®é™…-ffpobe-æ¡ˆä¾‹-part-1">å®é™… ffpobe æ¡ˆä¾‹ Part 1</h2>
<p>æ˜¾ç¤ºæ‰€æœ‰çš„æµï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffprobe &lt;input&gt; -show_streams
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ˜¾ç¤ºè§†é¢‘æµä¿¡æ¯ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffprobe &lt;input&gt; -select_streams v -show_format
</span></span></code></pre></td></tr></table>
</div>
</div><p>Show presentation timestamp and frame type of every frame, in CSV format (p=0 disables CSV section headers):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffprobe &lt;input&gt; -select_streams v -show_frames <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>-show_entries <span class="nv">frame</span><span class="o">=</span>pkt_pts_time,pict_type -of <span class="nv">csv</span><span class="o">=</span><span class="nv">p</span><span class="o">=</span><span class="m">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯‘è€…æŒ‰ï¼šç¬¬ä¸‰ä¸ªæ¡ˆä¾‹ä¸å¤ªæ‡‚ï¼Œæˆ‘è‡ªå·±è¯•äº†è¯•ï¼Œæ•ˆæœä¹Ÿæœ‰ç‚¹å¥‡æ€ªï¼Œå…ˆæ”¾ç€å§ ğŸ˜‚</p>
<h2 id="å®é™…-ffpobe-æ¡ˆä¾‹-part-2">å®é™… ffpobe æ¡ˆä¾‹ Part 2</h2>
<p>æ›´æ”¹è¾“å‡ºä¸º JSON æ ¼å¼ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffprobe &lt;input&gt; -select_streams v -show_packets -of json
</span></span></code></pre></td></tr></table>
</div>
</div><p>è·å–æ–‡ä»¶ä¸­æµçš„ç¼–å·ï¼ˆnk = 1 ç¦ç”¨ keysï¼‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffprobe &lt;input&gt; -show_format -show_entries <span class="nv">format</span><span class="o">=</span>nb_streams -of <span class="nv">compact</span><span class="o">=</span><span class="nv">nk</span><span class="o">=</span>1:p<span class="o">=</span><span class="m">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»¥ç§’æˆ– HH:MM:SS.ms ä¸ºå•ä½è·å–è§†é¢‘é•¿åº¦</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffprobe &lt;input&gt; -show_format -show_entries <span class="nv">format</span><span class="o">=</span>duration -of <span class="nv">compact</span><span class="o">=</span><span class="nv">nk</span><span class="o">=</span>1:p<span class="o">=</span><span class="m">0</span>
</span></span><span class="line"><span class="cl">ffprobe -sexagesimal &lt;input&gt; -show_format -show_entries <span class="nv">format</span><span class="o">=</span>duration -of <span class="nv">compact</span><span class="o">=</span><span class="nv">nk</span><span class="o">=</span>1:p<span class="o">=</span><span class="m">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»¥ Bit/s ä¸ºå•ä½è·å–éŸ³é¢‘æµ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffprobe &lt;input&gt; -select_streams a -show_entries <span class="nv">stream</span><span class="o">=</span>bit_rate -of <span class="nv">compact</span><span class="o">=</span><span class="nv">nk</span><span class="o">=</span>1:p<span class="o">=</span><span class="m">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯‘è€…æŒ‰ï¼šå…¶å®è¿™ä¸€ç« èŠ‚çš„æ¡ˆä¾‹æˆ‘ä¸ªäººè§‰å¾—æ²¡æœ‰å¾ˆå¤§ä½œç”¨ï¼Œå¹³æ—¶æŸ¥çœ‹åª’ä½“æ–‡ä»¶çš„ä¿¡æ¯åŸºæœ¬ä¸Šä½¿ç”¨ <code>ffprobe &lt;input&gt; -hide_banner</code> å°±å¤Ÿäº†ã€‚</p>
<h1 id="æ£€æŸ¥è§†é¢‘ç¼–è§£ç å™¨">æ£€æŸ¥è§†é¢‘ç¼–è§£ç å™¨</h1>
<h2 id="è°ƒè¯•è¿åŠ¨å‘é‡">è°ƒè¯•è¿åŠ¨å‘é‡</h2>
<p>åœ¨ FFmpeg ä¸­ä½¿ç”¨ H.264 ç¼–è§£ç å™¨å¯è§†åŒ–è¿åŠ¨å‘é‡çš„ç®€å•æ–¹æ³•ï¼ˆä¸é€‚ç”¨äºå…¶ä»–ç¼–è§£ç å™¨ï¼‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffplay -flags2 +export_mvs input.mp4 -vf <span class="nv">codecview</span><span class="o">=</span><span class="nv">mv</span><span class="o">=</span>pf+bf+bb
</span></span><span class="line"><span class="cl">ffmpeg -flags2 +export_mvs -i input.mp4 -vf <span class="nv">codecview</span><span class="o">=</span><span class="nv">mv</span><span class="o">=</span>pf+bf+bb &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>pf â€“ P å¸§çš„å‘å‰é¢„æµ‹è¿åŠ¨å‘é‡</li>
<li>bf â€“ B å¸§çš„å‘å‰é¢„æµ‹è¿åŠ¨å‘é‡</li>
<li>bb â€“ B å¸§çš„å‘åé¢„æµ‹è¿åŠ¨å‘é‡</li>
</ul>
<p></p>
<p>è·Ÿå¤šå‚è€ƒï¼š<a href="http://trac.ffmpeg.org/wiki/Debug/MacroblocksAndMotionVectors" target="_blank" rel="noopener noreffer ">http://trac.ffmpeg.org/wiki/Debug/MacroblocksAndMotionVectors</a></p>
<p>è¯‘è€…æŒ‰ï¼šè¿åŠ¨å‘é‡è¿™æ–¹é¢çš„çŸ¥è¯†ç‚¹æˆ‘ä¹Ÿä¸æ‡‚ï¼Œæ¥æ—¥å†è¡¥å……å§ ğŸ˜‚</p>
<h2 id="è§†é¢‘æµåˆ†æ">è§†é¢‘æµåˆ†æ</h2>
<p>å›¾å½¢åŒ–æ–¹å¼åˆ†æè§†é¢‘æµçš„å…¶ä»–è½¯ä»¶ï¼š</p>
<ul>
<li><a href="https://www.elecard.com/products/video-analysis/stream-analyzer" target="_blank" rel="noopener noreffer ">Elecard Stream Analyzer</a> (å•†ä¸š)</li>
<li><a href="http://www.codecian.com/" target="_blank" rel="noopener noreffer ">CodecVisa</a> (å•†ä¸š)</li>
<li><a href="https://software.intel.com/en-us/intel-video-pro-analyzer" target="_blank" rel="noopener noreffer ">Intel Video Pro Analyzer</a> (å•†ä¸š)</li>
<li><a href="https://people.xiph.org/~mbebenita/analyzer/" target="_blank" rel="noopener noreffer ">AOMAnalyzer</a> (å…è´¹ï¼Œé’ˆå¯¹ AV1/VP9 ç¼–ç çš„è§†é¢‘)</li>
</ul>
<h1 id="æ€»ç»“">æ€»ç»“</h1>
<p>é€šè¿‡è¿™èŠ‚è¯¾ç¨‹ï¼Œä½ åº”è¯¥å­¦åˆ°äº†ä»¥ä¸‹çŸ¥è¯†ç‚¹ï¼š</p>
<ul>
<li>ç†è§£ FFmpeg åº“ï¼Œç¼–è§£ç å™¨ï¼Œå®¹å™¨ï¼Œç¼–ç å™¨&hellip;</li>
<li>ç¼–ç è§†é¢‘å’ŒéŸ³é¢‘</li>
<li>ä½¿ç”¨åŸºç¡€çš„è¿‡æ»¤å™¨</li>
<li>è¯»å–æµä¿¡æ¯å’Œå…ƒæ•°æ®</li>
<li>å¦‚æœä½ é‡åˆ°äº†å›°éš¾ï¼Œä¼šå¯»æ‰¾å¸®åŠ©</li>
</ul>
]]></description></item></channel></rss>