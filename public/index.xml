<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>Asimov&#39;s Blog</title>
        <link>https://asimov.top/</link>
        <description>Asimov&#39;s Blog</description>
        <generator>Hugo -- gohugo.io</generator><managingEditor>1224513626@qq.com (asimov)</managingEditor>
            <webMaster>1224513626@qq.com (asimov)</webMaster><lastBuildDate>Sat, 12 Jun 2021 21:23:46 &#43;0800</lastBuildDate>
            <atom:link href="https://asimov.top/index.xml" rel="self" type="application/rss+xml" />
        <item>
    <title>FFmpeg ç¼–ç å’Œç¼–è¾‘å…¥é—¨</title>
    <link>https://asimov.top/ffmpeg-encoding-and-editing-course/</link>
    <pubDate>Sat, 12 Jun 2021 21:23:46 &#43;0800</pubDate>
    <author>asimov</author>
    <guid>https://asimov.top/ffmpeg-encoding-and-editing-course/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="https://ahmadawais.com/wp-content/uploads/2021/05/FFmpeg.jpg" referrerpolicy="no-referrer">
            </div><p>æœ¬æ–‡ä¸»è¦å†…å®¹ç¿»è¯‘è‡ªä¸€ç¯‡ä»‹ç» FFmpeg å…¥é—¨çŸ¥è¯†çš„è‹±æ–‡ Web å¹»ç¯ç‰‡ï¼ŒåŠ å…¥äº†ä¸€äº›ä¸ªäººç†è§£ä¸å­¦ä¹ æ³¨é‡Šã€‚</p>
<p>æˆ‘ç¿»è¯‘è¿™ç¯‡æ–‡ç« çš„ç›®çš„ï¼Œä¸€æ˜¯å­¦ä¹  FFmpeg ç›¸å…³çš„çŸ¥è¯†ï¼ŒäºŒæ˜¯ç»ƒä¹ è‹±æ–‡ç¿»è¯‘èƒ½åŠ›ã€‚ä½†æ˜¯å—é™äºä¸ªäººæ°´å¹³ï¼Œæœ‰äº›è‹±æ–‡ä¸“ä¸šåè¯ç¿»è¯‘æˆä¸­æ–‡æœ‰äº›æ€ªå¼‚ï¼Œç¢°åˆ°è§‰å¾—ç¿»è¯‘ä¸å¥½çš„åœ°æ–¹ï¼Œæ–‡ä¸­ä¼šé™„ä¸ŠåŸæ–‡è¯è¯­ï¼Œå»ºè®®ç»“åˆåŸæ–‡æ›´å¥½ç†è§£ã€‚</p>
<p>åŸæ–‡ä½œè€…æ˜¯ä¸€åè§†é¢‘è´¨é‡ä¸ä½“éªŒè´¨é‡ç ”ç©¶å‘˜ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ UniversitÃ¤t Ilmenau çš„ä¸€ååšå£«ç”Ÿå’ŒåŠ©ç†ç ”ç©¶å‘˜ã€‚åŸæ–‡å†™å¾—éå¸¸æ£’ï¼Œæ–‡æœ¬è´¨é‡å’Œæ’ç‰ˆéƒ½æ¯”æˆ‘çš„è¯‘æ–‡æ›´å¥½ï¼Œå»ºè®®æœ‰è‹±æ–‡åŸºç¡€çš„æœ‹å‹ç›´æ¥é˜…è¯»åŸæ–‡ï¼Œé“¾æ¥ï¼š<a href="https://slhck.info/ffmpeg-encoding-course" target="_blank" rel="noopener noreffer ">FFMPEG ENCODING AND EDITING COURSE</a></p>
<h2 id="è¯¾ç¨‹ç›®æ ‡">è¯¾ç¨‹ç›®æ ‡</h2>
<ul>
<li>åŸºæœ¬æ¦‚å¿µ</li>
<li>å®‰è£… ffmpeg å’Œç›¸å…³å·¥å…·</li>
<li>ç¼–ç è§†é¢‘</li>
<li>ä½¿ç”¨è¿‡æ»¤å™¨ï¼ˆæ»¤é•œï¼‰</li>
<li>åˆ†æè§†é¢‘</li>
</ul>
<h2 id="å‰ç½®è¦æ±‚">å‰ç½®è¦æ±‚</h2>
<ul>
<li>è¿™ä»½å¹»ç¯ç‰‡ï¼ˆåŸæ–‡æ˜¯ web å¹»ç¯ç‰‡çš„å½¢å¼ï¼‰</li>
<li>å·²å®‰è£… ffmpegã€ffprobeã€ffplay</li>
<li>ä¸€äº›æ ·ä¾‹è§†é¢‘ï¼Œæ¯”å¦‚ï¼š<a href="http://distribution.bbb3d.renderfarming.net/video/mp4/bbb_sunflower_1080p_60fps_normal.mp4" target="_blank" rel="noopener noreffer ">Big Buck Bunny</a></li>
</ul>
<h2 id="èµ„æº">èµ„æº</h2>
<p>å¦‚æœä½ éœ€è¦ä¸€äº›æ ·ä¾‹è§†é¢‘ç”¨åšæµ‹è¯•ï¼Œå¯ä»¥å‚è€ƒ VQEG (Video Quality Experts Group) çš„è¯´æ˜ï¼šhttps://www.its.bldrdoc.gov/vqeg/video-datasets-and-organizations.aspx</p>
<h1 id="ffmpeg-ç®€ä»‹">FFMPEG ç®€ä»‹</h1>
<h2 id="å…³äº">å…³äº</h2>
<ul>
<li>ç”¨äºå¤šåª’ä½“ç¼–è¾‘ã€è½¬æ¢&hellip; çš„å…è´¹å¼€æºè½¯ä»¶</li>
<li>å¼€å§‹äº 2000 å¹´</li>
<li>æŒç»­ç»´æŠ¤å’Œå¼€å‘è‡³ä»Š</li>
</ul>
<p>ç±»ä¼¼æˆ–ç›¸å…³ï¼ˆä¸”æœ‰ç”¨ï¼‰çš„æ¡†æ¶ï¼š</p>
<ul>
<li><a href="https://www.imagemagick.org/" target="_blank" rel="noopener noreffer ">ImageMagick</a></li>
<li><a href="https://www.mltframework.org/" target="_blank" rel="noopener noreffer ">MLT Framework</a></li>
</ul>
<h2 id="å·¥å…·">å·¥å…·</h2>
<p>FFmpeg æ˜¯ä¸€ç³»åˆ—è½¯ä»¶åŒ…å’Œç±»åº“çš„ç»„åˆï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>å‘½ä»¤è¡Œå·¥å…·ï¼šffmpegã€ffprobeã€ffplay</li>
<li>ç±»åº“ï¼šlibavformat, libavcodec, libavfilter, â€¦</li>
</ul>
<p>å…¶ä¸­ç±»åº“è¢«è®¸å¤šé¡¹ç›®ä½¿ç”¨ï¼ˆæ¯”å¦‚ VLCã€MLT Framework ç­‰ï¼‰å¹¶ä¸”å¯ä»¥åœ¨ C/C++ ä»£ç ä¸­ä½¿ç”¨</p>
<h2 id="ç±»åº“">ç±»åº“</h2>
<ul>
<li>libavformatï¼šè¯»å–å’Œå†™å…¥å®¹å™¨æ ¼å¼ï¼ˆAVI, MKV, MP4, â€¦ï¼‰</li>
<li>libavcodecï¼šè¯»å–å’Œå†™å…¥ç¼–è§£ç å™¨ï¼ˆH.264, H.265, VP9, â€¦ï¼‰</li>
<li>libavfilterï¼šå„ç§ä¸ªæ ·çš„è§†é¢‘å’ŒéŸ³é¢‘è¿‡æ»¤å™¨</li>
<li>ä»¥åŠå…¶ä»–&hellip;</li>
</ul>
<p>å…³äºå¦‚ä½•ä»¥ç¼–ç¨‹çš„æ–¹å¼ä½¿ç”¨ç±»åº“çš„æ ·ä¾‹ï¼š
<a href="http://leixiaohua1020.github.io/#ffmpeg-development-examples" target="_blank" rel="noopener noreffer ">http://leixiaohua1020.github.io/#ffmpeg-development-examples</a></p>
<p>ä»¥åŠä¸€äº›å…¶ä»–æœ‰ç”¨çš„ï¼ˆé FFmpeg çš„ï¼‰ç±»åº“ï¼š</p>
<ul>
<li>OpenCV: é¢å‘æ›´å¤šç±»å‹çš„ä¿¡å·å¤„ç†</li>
<li>Python: MoviePy, pyav, scikit-video</li>
</ul>
<h2 id="æ¶æ„">æ¶æ„</h2>
<p>ç®€åŒ–çš„ FFmpeg æ•´ä½“æ¶æ„</p>
<p></p>
<h2 id="å®‰è£…--ç¼–è¯‘">å®‰è£… / ç¼–è¯‘</h2>
<table>
<thead>
<tr>
<th>å®‰è£…æ–¹å¼</th>
<th>ä¼˜åŠ¿</th>
<th>åŠ£åŠ¿</th>
</tr>
</thead>
<tbody>
<tr>
<td>ä»æºç ç¼–è¯‘</td>
<td>å¯ä»¥è‡ªå®šä¹‰æ‰€æœ‰é…ç½®ï¼Œå·¥å…·ï¼Œç¼–è§£ç å™¨</td>
<td>è´¹æ—¶é—´ï¼Œå‡çº§å›°éš¾</td>
</tr>
<tr>
<td>ä¸‹è½½é¢„ç¼–è¯‘ç‰ˆæœ¬</td>
<td>ç®€å•ä¸”å¿«é€Ÿ</td>
<td>ä¸æä¾›æ‰€æœ‰ç¼–è§£ç å™¨ï¼Œéœ€è¦æ‰‹åŠ¨å‡çº§</td>
</tr>
<tr>
<td>åŒ…ç®¡ç†å™¨å®‰è£…</td>
<td>ç®€å•ä¸”å¿«é€Ÿ</td>
<td>å¯èƒ½ä¸æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼Œä¹Ÿä¸æä¾›æ‰€æœ‰ç¼–è§£ç å™¨</td>
</tr>
</tbody>
</table>
<ul>
<li>è·å–æºä»£ç å’Œé¢„ç¼–è¯‘ç‰ˆæœ¬ï¼šhttp://ffmpeg.org/download.html</li>
<li>Windows é¢„ç¼–è¯‘ç‰ˆæœ¬ï¼šhttps://ffmpeg.org/download.html#build-windows</li>
</ul>
<h2 id="è·å–å¸®åŠ©">è·å–å¸®åŠ©</h2>
<ul>
<li>å®˜æ–¹æ–‡æ¡£ï¼šhttps://ffmpeg.org/ffmpeg-all.html</li>
<li>Wiki çŸ¥è¯†åº“ï¼šhttp://trac.ffmpeg.org/wiki</li>
<li>IRC èŠå¤©å®¤ï¼š#ffmpeg</li>
<li>é‚®ä»¶åˆ—è¡¨ï¼šhttps://lists.ffmpeg.org/mailman/listinfo/ffmpeg-user/</li>
<li>Stack Overflow: <a href="https://stackoverflow.com/" target="_blank" rel="noopener noreffer ">https://stackoverflow.com/</a> and use #ffmpeg</li>
<li>Super User: <a href="http://superuser.com/" target="_blank" rel="noopener noreffer ">http://superuser.com/</a> and use #ffmpeg</li>
<li>â€¦ æˆ–è€…é—®æˆ‘</li>
</ul>
<h1 id="åŸºç¡€è§†é¢‘ç¼–ç æ¦‚å¿µ">åŸºç¡€è§†é¢‘ç¼–ç æ¦‚å¿µ</h1>
<h2 id="å®¹å™¨æ ¼å¼container-formats">å®¹å™¨æ ¼å¼ï¼ˆContainer Formatsï¼‰</h2>
<p>å®¹å™¨åŒ…å«åª’ä½“æ•°æ®ã€‚æ¯”å¦‚ï¼š</p>
<ul>
<li>MP4: MPEG-4 Part 14 å®¹å™¨ï¼Œç”¨äº H.264, H.264, AAC éŸ³é¢‘, â€¦</li>
<li>MKV: å¯ä»¥åŒ…å«å‡ ä¹æ‰€æœ‰åª’ä½“ç¼–ç æ ¼å¼çš„ä¸‡èƒ½å®¹å™¨</li>
<li>WebM: MKV å®¹å™¨çš„å­é›†ï¼Œä¸»è¦ç”¨äºç½‘ç»œåª’ä½“æµ</li>
<li>AVI: ä¼ ç»Ÿå®¹å™¨</li>
</ul>
<p>åœ¨ FFmpeg ä¸­æŸ¥çœ‹æ”¯æŒçš„å®¹å™¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ffmpeg -formats
</span></span><span class="line"><span class="cl">File formats:
</span></span><span class="line"><span class="cl"> D. <span class="o">=</span> Demuxing supported
</span></span><span class="line"><span class="cl"> .E <span class="o">=</span> Muxing supported
</span></span><span class="line"><span class="cl"> --
</span></span><span class="line"><span class="cl"> D  3dostr          3DO STR
</span></span><span class="line"><span class="cl">  E 3g2             3GP2 <span class="o">(</span>3GPP2 file format<span class="o">)</span>
</span></span><span class="line"><span class="cl">  E 3gp             3GP <span class="o">(</span>3GPP file format<span class="o">)</span>
</span></span><span class="line"><span class="cl"> D  4xm             4X Technologies
</span></span><span class="line"><span class="cl">  E a64             a64 - video <span class="k">for</span> Commodore <span class="m">64</span>
</span></span><span class="line"><span class="cl"> D  aa              Audible AA format files
</span></span><span class="line"><span class="cl"> ...
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ç¼–è§£ç å™¨codecs">ç¼–è§£ç å™¨ï¼ˆCodecsï¼‰</h2>
<ul>
<li>ç¼–è§£ç å™¨ = ç¼–ç å™¨ / è§£ç å™¨</li>
<li>å¦‚ä½•ç¼–ç å’Œè§£ç è§†é¢‘ã€éŸ³é¢‘&hellip;çš„è§„èŒƒ</li>
<li>é€šå¸¸ä¸æ˜¯å¦‚ä½•ç¼–ç  / å‹ç¼©æ•°æ®çš„è§„èŒƒ</li>
<li>æœ‰æ—¶å€™ â€œç¼–è§£ç å™¨â€ è¢«ç”¨äºç›´æ¥æŒ‡ä»£ ç¼–ç  / è§£ç çš„è½¯ä»¶</li>
</ul>
<p>è¯‘è€…æŒ‰ï¼šCodec å¯ä»¥ç†è§£ä¸ºç¼–ç åè®®ï¼Œä¸åŒçš„åè®®å¤„ç†æ•°æ®ï¼ˆéŸ³è§†é¢‘ï¼‰çš„è§„åˆ™ä¸ä¸€æ ·ï¼Œåè®®æœ‰å…è´¹å¼€æºçš„ï¼Œè‡ªç„¶ä¹Ÿæœ‰å•†ç”¨ç§æœ‰çš„ã€‚</p>
<p>æŸ¥çœ‹ FFmpeg æ”¯æŒçš„ç¼–è§£ç å™¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ffmpeg -codecs
</span></span><span class="line"><span class="cl">Codecs:
</span></span><span class="line"><span class="cl"> D..... <span class="o">=</span> Decoding supported
</span></span><span class="line"><span class="cl"> .E.... <span class="o">=</span> Encoding supported
</span></span><span class="line"><span class="cl"> ..V... <span class="o">=</span> Video codec
</span></span><span class="line"><span class="cl"> ..A... <span class="o">=</span> Audio codec
</span></span><span class="line"><span class="cl"> ..S... <span class="o">=</span> Subtitle codec
</span></span><span class="line"><span class="cl"> ...I.. <span class="o">=</span> Intra frame-only codec
</span></span><span class="line"><span class="cl"> ....L. <span class="o">=</span> Lossy compression
</span></span><span class="line"><span class="cl"> .....S <span class="o">=</span> Lossless compression
</span></span><span class="line"><span class="cl"> -------
</span></span><span class="line"><span class="cl"> D.VI.. 012v                 Uncompressed 4:2:2 10-bit
</span></span><span class="line"><span class="cl"> D.V.L. 4xm                  4X Movie
</span></span><span class="line"><span class="cl"> D.VI.S 8bps                 QuickTime 8BPS video
</span></span><span class="line"><span class="cl"> .EVIL. a64_multi            Multicolor charset <span class="k">for</span> Commodore <span class="m">64</span> <span class="o">(</span>encoders: a64multi <span class="o">)</span>
</span></span><span class="line"><span class="cl"> .EVIL. a64_multi5           Multicolor charset <span class="k">for</span> Commodore 64, extended with 5th color <span class="o">(</span>colram<span class="o">)</span> <span class="o">(</span>encoders: a64multi5 <span class="o">)</span>
</span></span><span class="line"><span class="cl"> D.V..S aasc                 Autodesk RLE
</span></span><span class="line"><span class="cl"> D.VIL. aic                  Apple Intermediate Codec
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="æœ€é‡è¦çš„æœ‰æŸç¼–è§£ç å™¨lossy-codecs">æœ€é‡è¦çš„æœ‰æŸç¼–è§£ç å™¨ï¼ˆLossy Codecsï¼‰</h2>
<p>ç›®å‰ä¸»è¦ä½¿ç”¨çš„ï¼Œç”± ITU / ISO æ ‡å‡†åŒ–ï¼š</p>
<ul>
<li>ğŸ¥ H.262 / MPEG-2 Part H: ä¸»è¦æ˜¯å¹¿æ’­ã€ç”µè§†ä½¿ç”¨ï¼Œç”¨äºå‘åå…¼å®¹</li>
<li>ğŸ¥ H.264 / MPEG-4 Part 10: å½“ä»Šè§†é¢‘ç¼–ç å™¨çš„äº‹å®æ ‡å‡†ï¼ˆ2018å¹´ï¼‰</li>
<li>ğŸ¥ H.265 / HEVC / MPEG-H: H.264 çš„ç»§ä»»è€…ï¼Œè§†é¢‘è´¨é‡æå‡ 50%</li>
<li>ğŸ”Š MP3 / MPEG-2 Audio Layer III: æ›¾ç»æ˜¯éŸ³é¢‘ç¼–ç çš„äº‹å®æ ‡å‡†</li>
<li>ğŸ”Š AAC / ISO/IEC 14496-3:2009: é«˜çº§éŸ³é¢‘ç¼–ç æ ‡å‡†</li>
</ul>
<p>å…æˆæƒè´¹ï¼ˆå…ç‰ˆæƒçš„ï¼‰ä¸»è¦ç«äº‰è€…ï¼š</p>
<ul>
<li>ğŸ¥ VP8: ç”± Google æå‡ºçš„å¼€æºå…è´¹ç¼–è§£ç å™¨ï¼ˆå¦‚ä»Šä½¿ç”¨å¹¶ä¸å¤šï¼‰</li>
<li>ğŸ¥ VP9: VP8 çš„ç»§ä»»è€…ï¼Œå‡ ä¹å’Œ H.265 ä¸€æ ·å¥½</li>
<li>ğŸ¥ AV1: VP9 çš„ç»§ä»»è€…ï¼Œå£°ç§°æ¯” H.265 æ›´å¥½</li>
</ul>
<h2 id="æœ€é‡è¦çš„æ— æŸç¼–è§£ç å™¨lossless-codecs">æœ€é‡è¦çš„æ— æŸç¼–è§£ç å™¨ï¼ˆLossless Codecsï¼‰</h2>
<p>æ— æŸç¼–è§£ç å™¨åœ¨å­˜æ¡£ã€ç¼–è¾‘&hellip;é¢†åŸŸéå¸¸æœ‰ç”¨
æ— æŸç¼–ç  = åœ¨è¾ƒå°çš„æ–‡ä»¶ä½“ç§¯ä¸‹æ²¡æœ‰å‹ç¼©æŸå¤±</p>
<ul>
<li>ğŸ¥ Raw YUV, HuffYUV, FFV1, ffvhuff â€¦</li>
<li>ğŸ”Š Raw PCM, FLAC, ALAC, â€¦</li>
</ul>
<p>å½“ç„¶ï¼Œè¿˜æœ‰ â€œè§†è§‰æ— æŸâ€ ç¼–è§£ç å™¨ï¼š</p>
<ul>
<li>ğŸ¥ Apple ProRes, Avid DNxHD, JPEG2000, high-quality H.264/H.265, &hellip;</li>
<li>High bitrate and usually only I-framesï¼ˆé«˜ç ç‡å¸§å†…å‹ç¼©ï¼‰</li>
</ul>
<h2 id="ç¼–ç å™¨encoders">ç¼–ç å™¨ï¼ˆEncodersï¼‰</h2>
<ul>
<li>ç¼–ç å™¨æ˜¯è¾“å‡ºç¼–ç åå­—èŠ‚æµçš„å®é™…è½¯ä»¶</li>
<li>ç¼–ç å™¨ä¼šå½±å“è§†é¢‘çš„è´¨é‡å’Œæ€§èƒ½ï¼Œä¸€äº›ç¼–ç å™¨ä¼šå¥½äºå¦ä¸€äº›ï¼ˆæœ‰äº›å…è´¹ï¼Œæœ‰äº›ä¸å…è´¹ï¼‰</li>
</ul>
<p>è¯‘è€…æŒ‰ï¼šEncoder å¯ä»¥ç†è§£ä¸º Codecï¼ˆç¼–ç åè®®ï¼‰çš„å…·ä½“å®ç°æ–¹å¼ï¼Œä¸åŒçš„å®ç°æ–¹å¼å„æœ‰ä¼˜åŠ£ï¼Œæœ‰å…è´¹å¼€æºçš„å®ç°ï¼Œä¹Ÿæœ‰å•†ç”¨ç§æœ‰çš„å®ç°ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li>ğŸ¥ libx264: æœ€å—æ¬¢è¿çš„ H.264 ç¼–ç å™¨</li>
<li>ğŸ¥ NVENC: NVIDIA GPU ä¸“ç”¨çš„ H.264 ç¼–ç å™¨</li>
<li>ğŸ¥ libx265: å…è´¹å¼€æºçš„ HEVCï¼ˆH.265ï¼‰ç¼–ç å™¨</li>
<li>ğŸ¥ libvpx: Google æ¨å‡ºçš„ VP8 å’Œ VP9 ç¼–ç å™¨</li>
<li>ğŸ¥ libaom: AV1 ç¼–ç å™¨</li>
<li>ğŸ”Š libfdk-aac: AAC ç¼–ç å™¨</li>
<li>ğŸ”Š aac: åŸç”Ÿï¼ˆé»˜è®¤ï¼‰ FFmpeg AAC ç¼–ç å™¨</li>
<li>â€¦</li>
</ul>
<p>æ€»çš„æ¥è¯´ï¼Œç¼–ç å™¨æ–¹é¢æœ‰å¾ˆå¤šç«äº‰ã€‚</p>
<p>æŸ¥çœ‹ FFmpeg æ”¯æŒçš„ç¼–ç å™¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ffmpeg -encoders
</span></span><span class="line"><span class="cl">Encoders:
</span></span><span class="line"><span class="cl"> V..... <span class="o">=</span> Video
</span></span><span class="line"><span class="cl"> A..... <span class="o">=</span> Audio
</span></span><span class="line"><span class="cl"> S..... <span class="o">=</span> Subtitle
</span></span><span class="line"><span class="cl"> .F.... <span class="o">=</span> Frame-level multithreading
</span></span><span class="line"><span class="cl"> ..S... <span class="o">=</span> Slice-level multithreading
</span></span><span class="line"><span class="cl"> ...X.. <span class="o">=</span> Codec is experimental
</span></span><span class="line"><span class="cl"> ....B. <span class="o">=</span> Supports draw_horiz_band
</span></span><span class="line"><span class="cl"> .....D <span class="o">=</span> Supports direct rendering method <span class="m">1</span>
</span></span><span class="line"><span class="cl"> ------
</span></span><span class="line"><span class="cl"> V..... a64multi             Multicolor charset <span class="k">for</span> Commodore <span class="m">64</span> <span class="o">(</span>codec a64_multi<span class="o">)</span>
</span></span><span class="line"><span class="cl"> V..... a64multi5            Multicolor charset <span class="k">for</span> Commodore 64, extended with 5th color <span class="o">(</span>colram<span class="o">)</span> <span class="o">(</span>codec a64_multi5<span class="o">)</span>
</span></span><span class="line"><span class="cl"> V..... alias_pix            Alias/Wavefront PIX image
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="åƒç´ æ ¼å¼pixel-formats">åƒç´ æ ¼å¼ï¼ˆPixel Formatsï¼‰</h2>
<ul>
<li>è§†é¢‘æµä¸­åŸå§‹åƒç´ çš„è¡¨ç¤º</li>
<li>æŒ‡å®šäº®åº¦ / è‰²å½©å’Œé¥±å’Œåº¦çš„é‡‡æ ·é¡ºåº</li>
</ul>
<p></p>
<p>æŸ¥çœ‹ FFmpeg æ”¯æŒçš„åƒç´ æ ¼å¼ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">âœ  ~ ffmpeg -pix_fmts --hide_banner
</span></span><span class="line"><span class="cl">Pixel formats:
</span></span><span class="line"><span class="cl">I.... <span class="o">=</span> Supported Input  format <span class="k">for</span> conversion
</span></span><span class="line"><span class="cl">.O... <span class="o">=</span> Supported Output format <span class="k">for</span> conversion
</span></span><span class="line"><span class="cl">..H.. <span class="o">=</span> Hardware accelerated format
</span></span><span class="line"><span class="cl">...P. <span class="o">=</span> Paletted format
</span></span><span class="line"><span class="cl">....B <span class="o">=</span> Bitstream format
</span></span><span class="line"><span class="cl">FLAGS NAME            NB_COMPONENTS BITS_PER_PIXEL BIT_DEPTHS
</span></span><span class="line"><span class="cl">-----
</span></span><span class="line"><span class="cl">IO... yuv420p                <span class="m">3</span>             <span class="m">12</span>      8-8-8
</span></span><span class="line"><span class="cl">IO... yuyv422                <span class="m">3</span>             <span class="m">16</span>      8-8-8
</span></span><span class="line"><span class="cl">IO... rgb24                  <span class="m">3</span>             <span class="m">24</span>      8-8-8
</span></span><span class="line"><span class="cl">IO... bgr24                  <span class="m">3</span>             <span class="m">24</span>      8-8-8
</span></span><span class="line"><span class="cl">IO... yuv422p                <span class="m">3</span>             <span class="m">16</span>      8-8-8
</span></span><span class="line"><span class="cl">IO... yuv444p                <span class="m">3</span>             <span class="m">24</span>      8-8-8
</span></span><span class="line"><span class="cl">IO... yuv410p                <span class="m">3</span>              <span class="m">9</span>      8-8-8
</span></span><span class="line"><span class="cl">IO... yuv411p                <span class="m">3</span>             <span class="m">12</span>      8-8-8
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯‘è€…æŒ‰ï¼šè¿™å—æˆ‘ä¹Ÿæ²¡çœ‹æ˜ç™½ï¼Œå…ˆæ”¾ç€å§ ğŸ˜‚ï¼Œæˆ‘æ¯”è¾ƒå…³å¿ƒè§†é¢‘ç¼–ç ï¼ˆæ•°æ®å‹ç¼©ï¼‰çš„éƒ¨åˆ†</p>
<h1 id="ç”¨-ffmpeg-å‘½ä»¤è¡Œå·¥å…·ç¼–ç ">ç”¨ FFmpeg å‘½ä»¤è¡Œå·¥å…·ç¼–ç </h1>
<h2 id="åŸºæœ¬è¯­æ³•">åŸºæœ¬è¯­æ³•</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg &lt;global-options&gt; &lt;input-options&gt; -i &lt;input&gt; &lt;output-options&gt; &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å…¨å±€å‚æ•°ï¼ˆglobal-optionsï¼‰ç”¨äºæ—¥å¿—è¾“å‡ºï¼Œè¦†ç›–æ–‡ä»¶ç­‰</li>
<li>è¾“å…¥å‚æ•°ï¼ˆinput-optionsï¼‰ç”¨äºè¯»å–æ–‡ä»¶</li>
<li>è¾“å‡ºå‚æ•°ï¼ˆoutput-optionsï¼‰ç”¨äºï¼š
<ul>
<li>è½¬æ¢ï¼ˆç¼–ç æ ¼å¼ï¼Œè§†é¢‘è´¨é‡ç­‰ï¼‰</li>
<li>è¿‡æ»¤å™¨ï¼ˆfilteringï¼‰</li>
<li>æµæ˜ å°„ï¼ˆstream mappingï¼‰</li>
<li>&hellip;</li>
</ul>
</li>
</ul>
<p>å®Œæ•´çš„å¸®åŠ© / å‚è€ƒæ–‡æ¡£ï¼š<code>ffmpeg -h full</code> æˆ–è€… <code>man ffmpeg</code> ä½†æ˜¯å†…å®¹éå¸¸éå¸¸å¤šï¼</p>
<h2 id="è½¬ç å’Œè½¬æ¢transcoding-and-transmuxing">è½¬ç å’Œè½¬æ¢ï¼ˆTRANSCODING AND TRANSMUXINGï¼‰</h2>
<p>ä»ä¸€ç§ç¼–ç æ ¼å¼è½¬ç åˆ°å¦ä¸€ç§ç¼–ç æ ¼å¼ï¼ˆTranscodingï¼‰ï¼Œæ¯”å¦‚ç”¨ libx264 ç¼–ç å™¨è½¬ä¸º H.264 ç¼–ç æ ¼å¼</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -c:v libx264 output.mp4
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»ä¸€ç§è§†é¢‘å®¹å™¨è½¬æ¢ä¸ºå¦ä¸€ç§è§†é¢‘å®¹å™¨ï¼Œä¸ç”¨é‡æ–°ç¼–ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i input.mp4 -c copy output.mkv
</span></span></code></pre></td></tr></table>
</div>
</div><p>ffmpeng ä¼šä»è¾“å…¥ä¸­è·å–ä¸€ä¸ªè§†é¢‘ã€éŸ³é¢‘å’Œå­—å¹•æµå¹¶å°†å…¶æ˜ å°„åˆ°è¾“å‡ºæ–‡ä»¶ä¸­ã€‚</p>
<p>æ³¨é‡Šï¼š</p>
<ul>
<li>-c è®¾ç½®ç¼–ç å™¨ï¼ˆå‚è€ƒ ffmpeg -encoders)</li>
<li>-c å¤åˆ¶æ¯”ç‰¹æµï¼ˆcopy only copies bitstreamï¼‰</li>
<li>-c:v è®¾ç½®è§†é¢‘ç¼–ç å™¨</li>
<li>-c:a è®¾ç½®éŸ³é¢‘ç¼–ç å™¨</li>
<li>-an å’Œ -vn åˆ†åˆ«æ˜¯ç¦ç”¨éŸ³é¢‘å’Œè§†é¢‘æµ</li>
</ul>
<h3 id="è½¬ç çš„èƒŒåtranscoding-background">è½¬ç çš„èƒŒåï¼ˆTRANSCODING BACKGROUNDï¼‰</h3>
<p>èŠ‚é€‰è‡ª <a href="http://ffmpeg.org/ffmpeg-all.html" target="_blank" rel="noopener noreffer ">http://ffmpeg.org/ffmpeg-all.html</a>ï¼š</p>
<blockquote>
<p>ffmpeg [â€¦] read[s] input files and get packets containing encoded data from them. When there are multiple input files, ffmpeg tries to keep them synchronized [â€¦].
Encoded packets are then passed to the decoder. [â€¦] The decoder produces uncompressed frames [â€¦] which can be processed further by filtering [â€¦]. After filtering, the frames are passed to the encoder, which encodes them and outputs encoded packets. Finally those are passed to the muxer, which writes the encoded packets to the output file.</p>
</blockquote>
<p>è¯‘è€…æŒ‰ï¼šè¿™æ®µä¸“ä¸šåè¯å¤ªå¤šï¼Œå°è¯•ç¿»è¯‘äº†å‡ æ¬¡éƒ½æ„Ÿè§‰å¤ªåƒµç¡¬å¤ªå¥‡æ€ªäº†ã€‚å…¶å®å°±æ˜¯å‰é¢é‚£ä¸ªæ¶æ„å›¾çš„æ–‡å­—æè¿°ã€‚</p>
<p>å¤§æ¦‚æ„æ€æ˜¯ï¼šffmpeg ä»æ–‡ä»¶ä¸­è¯»å–ç¼–ç è¿‡çš„æ•°æ®åŒ…ï¼Œå¦‚æœæœ‰å¤šä¸ªæ–‡ä»¶ï¼Œffmpeg ä¼šå°è¯•åŒæ­¥å¤šä¸ªæ–‡ä»¶ã€‚ç„¶åè¿™äº›ç¼–ç è¿‡çš„æ•°æ®åŒ…ï¼ˆencoded packetsï¼‰ä¼šè¢«å‘é€åˆ°è§£ç å™¨ï¼ˆdecoderï¼‰ï¼Œè§£ç å™¨å°†è¿™äº›æ•°æ®åŒ…è§£ç ä¸ºåŸå§‹è§†é¢‘å¸§ï¼ˆuncompressed framesï¼‰ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨å„ç§è¿‡æ»¤å™¨ï¼ˆfiltersï¼‰æ¥å¤„ç†è¿™äº›è§†é¢‘å¸§ï¼ˆframesï¼‰ï¼Œç„¶åè¿™äº›å¤„ç†è¿‡åçš„è§†é¢‘å¸§ç‡ä¼šè¢«å‘é€åˆ°ç¼–ç å™¨ï¼ˆencoderï¼‰ï¼Œç¼–ç å™¨ä¼šå°†ä»–ä»¬ç¼–ç ä¸ºæ•°æ®åŒ…ï¼ˆencoded packetsï¼‰ï¼Œæœ€åè¿™äº›æ•°æ®åŒ…ä¼šè¢«å‘é€åˆ°æ··æµå™¨ï¼ˆmuxerï¼‰ï¼Œæœ€ç»ˆæ··æµå™¨å°†è¿™äº›æ•°æ®åŒ…è¾“å‡ºä¸ºæ–‡ä»¶ã€‚</p>
<h2 id="æŸ¥æ‰¾å’Œå‰ªåˆ‡seeking-and-cutting">æŸ¥æ‰¾å’Œå‰ªåˆ‡ï¼ˆSEEKING AND CUTTINGï¼‰</h2>
<p>ä» &lt;èµ·å§‹ç‚¹ï¼ˆstartï¼‰&gt; ç”¨ &lt;æŒç»­æ—¶é—´ï¼ˆdurationï¼‰&gt; æˆ–è€… &lt;ç»“æŸç‚¹ï¼ˆendï¼‰&gt; æ¥å‰ªåˆ‡è§†é¢‘</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -ss &lt;start&gt; -i &lt;input&gt; -t &lt;duration&gt; -c copy &lt;output&gt;
</span></span><span class="line"><span class="cl">ffmpeg -ss &lt;start&gt; -i &lt;input&gt; -to &lt;end&gt; -c copy &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¾‹å¦‚ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -ss 00:01:50 -i &lt;input&gt; -t 10.5 -c copy &lt;output&gt;
</span></span><span class="line"><span class="cl">ffmpeg -ss 2.5 -i &lt;input&gt; -to <span class="m">10</span> -c copy &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ä½¿ç”¨-seekng-æ³¨æ„äº‹é¡¹">ä½¿ç”¨ SEEKNG æ³¨æ„äº‹é¡¹</h3>
<ul>
<li>é‡æ–°ç¼–ç è§†é¢‘æ—¶ï¼Œseeking æ€»æ˜¯å¯ä»¥ç²¾ç¡®åˆ°æ—¶é—´æˆ³</li>
<li>å½“æ‹·è´è§†é¢‘æµè€Œæ²¡æœ‰ç»è¿‡é‡æ–°ç¼–ç æ—¶ï¼ˆ-c copyï¼‰ï¼Œffmpeg å¯èƒ½ä¼šåŒ…å«æœªæ˜¾ç¤ºä½†æ˜¯å¿…è¦çš„å¸§</li>
<li>ä½¿ç”¨ <code>-c copy</code> å‰ªåˆ‡è§†é¢‘æ—¶ï¼Œå¯èƒ½ä¼šäº§ç”Ÿé»‘å¸§å¼€å¤´çš„è§†é¢‘ï¼ˆåœ¨æŸäº›æ’­æ”¾å™¨ä¸Šï¼‰</li>
<li>è¯¦æƒ…å¯ä»¥æŸ¥çœ‹ï¼š
<ul>
<li><a href="http://trac.ffmpeg.org/wiki/Seeking" target="_blank" rel="noopener noreffer ">http://trac.ffmpeg.org/wiki/Seeking</a></li>
<li><a href="https://superuser.com/questions/138331/using-ffmpeg-to-cut-up-video" target="_blank" rel="noopener noreffer ">https://superuser.com/questions/138331/using-ffmpeg-to-cut-up-video</a></li>
</ul>
</li>
</ul>
<p>è¯‘è€…æŒ‰ï¼šä¹‹æ‰€ä»¥åœ¨å‰ªåˆ‡è§†é¢‘æ—¶ï¼Œè½¬ç äºä¸è½¬ç å­˜åœ¨æ—¶é—´å‡†ç¡®æ€§ä¸Šçš„å·®åˆ«ï¼Œæ˜¯å› ä¸ºè½¬ç æ—¶ï¼ŒåŸè§†é¢‘çš„æ¯ä¸€å¸§éƒ½ä¼šè¢« ffmpeg è¯»å–å‡ºæ¥ï¼ˆä¹Ÿå°±æ˜¯ decodeï¼‰ï¼Œå› æ­¤å¯ä»¥å‡†ç¡®çš„å®šä½åˆ°æ—¶é—´ç‚¹ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰è½¬ç ï¼Œç›´æ¥å¤åˆ¶è§†é¢‘æµçš„æ—¶å€™ï¼Œffmpeg å¹¶ä¸ä¼šé€å¸§åˆ†æè§†é¢‘ï¼Œè€Œæ˜¯é‡‡ç”¨â€œå…³é”®å¸§â€æ¥å®šä½æ—¶é—´ï¼Œå½“è®¾å®šçš„æ—¶é—´ç‚¹ä¸Šæ²¡æœ‰å…³é”®å¸§æ—¶ï¼Œå°±ä¼šå‡ºç°ä¸€äº›æ—¶é—´åå·®ã€‚</p>
<h2 id="è®¾ç½®è´¨é‡">è®¾ç½®è´¨é‡</h2>
<ul>
<li>è¾“å‡ºæ–‡ä»¶çš„è´¨é‡å–å†³äºç¼–ç å™¨é»˜è®¤è®¾ç½®äºåŸææ–™ï¼ˆä¹Ÿå°±æ˜¯åŸè§†é¢‘ï¼‰çš„è´¨é‡</li>
<li>ä¸è¦åœ¨æœªè®¾ç½®ä»»ä½•è´¨é‡æ°´å¹³çš„æƒ…å†µä¸‹è¿›è¡Œç¼–ç </li>
<li>é€šå¸¸æƒ…å†µä¸‹ï¼Œä½ éœ€è¦é€‰æ‹©ä¸€ä¸ªç›®æ ‡æ¯”ç‰¹ç‡æˆ–è€…è´¨é‡æ°´å¹³</li>
<li>ç›®æ ‡æ¯”ç‰¹ç‡å–å†³äºè§†é¢‘çš„ç±»å‹ï¼Œå¤§å°å’Œå¸§ç‡</li>
</ul>
<h3 id="è®¾ç½®è´¨é‡çš„å‚æ•°">è®¾ç½®è´¨é‡çš„å‚æ•°</h3>
<p>å¯èƒ½ä¼šä½¿ç”¨åˆ°çš„å‚æ•°ï¼ˆä»…ç¤ºä¾‹ï¼‰</p>
<ul>
<li>-b:v æˆ–è€… -b:a è®¾ç½®æ¯”ç‰¹ç‡
<ul>
<li>æ¯”å¦‚ï¼š-b:v 1000K = 1000kbit/s, -b:v 8M = 8Mbit/s</li>
</ul>
</li>
<li>q:v æˆ–è€… -q:a è®¾ç½®å›ºå®šè´¨é‡å‚æ•°
<ul>
<li>æ¯”å¦‚ï¼š-q:a 2 è®¾ç½®ä¸ºåŸç”Ÿ AAC ç¼–ç å™¨</li>
</ul>
</li>
</ul>
<p>ä¸€äº›ç¼–ç æ–¹å¼çš„ç¤ºä¾‹ï¼š</p>
<ul>
<li>-crf ç”¨æ¥è®¾ç½® libx264/libx265 çš„ æ’å®šç ç‡å› å­ï¼ˆ<a href="http://slhck.info/video/2017/02/24/crf-guide.html" target="_blank" rel="noopener noreffer ">Constant Rate Factor</a>ï¼‰</li>
<li>vbr ä¸º FDK-AAC ç¼–ç å™¨è®¾ç½®å›ºå®šè´¨é‡</li>
<li>è¿˜æœ‰å¾ˆå¤šå…¶ä»–å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨ <code>ffmpeg -h encoder=libx264 for examples</code> æŸ¥çœ‹ï¼Œå¦‚ä¸‹</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">âœ  ~ ffmpeg -h <span class="nv">encoder</span><span class="o">=</span>libx264 <span class="k">for</span> examples -hide_banner
</span></span><span class="line"><span class="cl">Encoder libx264 <span class="o">[</span>libx264 H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10<span class="o">]</span>:
</span></span><span class="line"><span class="cl">    General capabilities: dr1 delay threads 
</span></span><span class="line"><span class="cl">    Threading capabilities: other
</span></span><span class="line"><span class="cl">    Supported pixel formats: yuv420p yuvj420p yuv422p yuvj422p yuv444p yuvj444p nv12 nv16 nv21 yuv420p10le yuv422p10le yuv444p10le nv20le gray gray10le
</span></span><span class="line"><span class="cl">libx264 AVOptions:
</span></span><span class="line"><span class="cl">  -preset            &lt;string&gt;     E..V....... Set the encoding preset <span class="o">(</span>cf. x264 --fullhelp<span class="o">)</span> <span class="o">(</span>default <span class="s2">&#34;medium&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  -tune              &lt;string&gt;     E..V....... Tune the encoding params <span class="o">(</span>cf. x264 --fullhelp<span class="o">)</span>
</span></span><span class="line"><span class="cl">  -profile           &lt;string&gt;     E..V....... Set profile restrictions <span class="o">(</span>cf. x264 --fullhelp<span class="o">)</span> 
</span></span><span class="line"><span class="cl">  -fastfirstpass     &lt;boolean&gt;    E..V....... Use fast settings when encoding first pass <span class="o">(</span>default <span class="nb">true</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  -level             &lt;string&gt;     E..V....... Specify level <span class="o">(</span>as defined by Annex A<span class="o">)</span>
</span></span><span class="line"><span class="cl">  -passlogfile       &lt;string&gt;     E..V....... Filename <span class="k">for</span> <span class="m">2</span> pass stats
</span></span><span class="line"><span class="cl">  -wpredp            &lt;string&gt;     E..V....... Weighted prediction <span class="k">for</span> P-frames
</span></span><span class="line"><span class="cl">  -a53cc             &lt;boolean&gt;    E..V....... Use A53 Closed Captions <span class="o">(</span><span class="k">if</span> available<span class="o">)</span> <span class="o">(</span>default <span class="nb">true</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  -x264opts          &lt;string&gt;     E..V....... x264 options
</span></span><span class="line"><span class="cl">  -crf               &lt;float&gt;      E..V....... Select the quality <span class="k">for</span> constant quality mode <span class="o">(</span>from -1 to FLT_MAX<span class="o">)</span> <span class="o">(</span>default -1<span class="o">)</span>
</span></span><span class="line"><span class="cl">  -crf_max           &lt;float&gt;      E..V....... In CRF mode, prevents VBV from lowering quality beyond this point. <span class="o">(</span>from -1 to FLT_MAX<span class="o">)</span> <span class="o">(</span>default -1<span class="o">)</span>
</span></span><span class="line"><span class="cl">  -qp                &lt;int&gt;        E..V....... Constant quantization parameter rate control method <span class="o">(</span>from -1 to INT_MAX<span class="o">)</span> <span class="o">(</span>default -1<span class="o">)</span>
</span></span><span class="line"><span class="cl">  -aq-mode           &lt;int&gt;        E..V....... AQ method <span class="o">(</span>from -1 to INT_MAX<span class="o">)</span> <span class="o">(</span>default -1<span class="o">)</span>
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ä»€ä¹ˆæ˜¯-crf">ä»€ä¹ˆæ˜¯ CRFï¼Ÿ</h3>
<ul>
<li>CRF = <a href="http://slhck.info/video/2017/02/24/crf-guide.html" target="_blank" rel="noopener noreffer ">Constant Rate Factor</a></li>
<li>åœ¨æ•´ä¸ªç¼–ç è¿‡ç¨‹ä¸­ï¼Œä¿æŒæ’å®šçš„è´¨é‡</li>
<li>åœ¨ä¸å¤ªæ³¨é‡æ–‡ä»¶å¤§å°çš„æƒ…å†µä¸‹ï¼Œé€‚åˆä»¥å›ºå®šçš„è´¨é‡å­˜å‚¨è§†é¢‘</li>
</ul>
<h3 id="ç¤ºä¾‹è½¬ç ä¸º-h264part-1">ç¤ºä¾‹ï¼šè½¬ç ä¸º H.264ï¼ŒPart 1</h3>
<p>ä»¥å›ºå®šè´¨é‡ï¼ˆCRFï¼‰ç¼–ç ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -c:v libx264 -crf <span class="m">23</span> -c:a aac -b:a 128k output.mkv
</span></span></code></pre></td></tr></table>
</div>
</div><p>é’ˆå¯¹ H.264 ç¼–ç ï¼ŒCRF åœ¨ 18 åˆ° 28 ä¹‹é—´çœ‹èµ·æ¥â€œæ¯”è¾ƒå¥½â€ï¼ŒCRF å€¼è¶Šä½è§†é¢‘è´¨é‡è¶Šå¥½ã€‚ï¼ˆ HEVC å’Œ VP9 ç¼–ç çš„ CRF å€¼ä¸åŒï¼‰</p>
<h3 id="ç¤ºä¾‹è½¬ç ä¸º-h264part-2">ç¤ºä¾‹ï¼šè½¬ç ä¸º H.264ï¼ŒPart 2</h3>
<p>åŒé‡ç¼–ç ï¼ˆTwo-passï¼‰æ¨¡å¼ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -y -i &lt;input&gt; -c:v libx264 -b:v 8M -pass <span class="m">1</span> -c:a aac -b:a 128k -f mp4 /dev/null
</span></span><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -c:v libx264 -b:v 8M -pass <span class="m">2</span> -c:a aac -b:a 128k output.mp4
</span></span></code></pre></td></tr></table>
</div>
</div><p>Windows ç”¨æˆ·ï¼šç”¨ <code>nul</code> ä»£æ›¿ <code>/dev/null</code></p>
<p>æ›´å¤šç»†èŠ‚ï¼Œå‚è€ƒï¼š<a href="https://trac.ffmpeg.org/wiki/Encode/H.264" target="_blank" rel="noopener noreffer ">https://trac.ffmpeg.org/wiki/Encode/H.264</a></p>
<h2 id="ç ç‡æ§åˆ¶">ç ç‡æ§åˆ¶</h2>
<p>ä¸åŒçš„æ§åˆ¶æ–¹å¼ï¼š</p>
<ul>
<li>å›ºå®šç ç‡ï¼ˆConstant Bitrateï¼šCBRï¼‰</li>
<li>åŠ¨æ€ç ç‡ï¼ˆVariable Bitrateï¼šVBRï¼‰
<ul>
<li>å¹³å‡ç ç‡ï¼ˆAverage Bitrateï¼šABRï¼‰</li>
<li>æ’å®šè´¨é‡å‚æ•°ï¼ˆConstant quantization parameterï¼šCQPï¼‰</li>
<li>åŸºäºå¿ƒé‡Œè§†è§‰ç‰¹å¾çš„æ’å®šè´¨é‡ï¼Œæ¯”å¦‚ x264/x265/libvpx-vp9 ç¼–ç å™¨ä¸­ä½¿ç”¨ CRFï¼ˆConstant quality, based on psychovisual propertiesï¼‰</li>
<li>é™åˆ¶å‹ç ç‡ï¼ˆConstrained Bitrateï¼šVBVï¼‰</li>
</ul>
</li>
</ul>
<p>å…·ä½“åœ¨å“ªç§æƒ…å†µä¸‹ä½¿ç”¨å“ªç§ç ç‡æ¨¡å¼ï¼Œå‚è€ƒï¼š<a href="https://slhck.info/video/2017/03/01/rate-control.html" target="_blank" rel="noopener noreffer ">https://slhck.info/video/2017/03/01/rate-control.html</a></p>
<p><strong>é‡è¦è¯´æ˜ï¼šåˆé€‚çš„ç ç‡å–å†³äºå†…å®¹ç‰¹å¾ï¼</strong></p>
<p>è¯‘è€…æŒ‰ï¼šå¯¹è§†é¢‘æ¥è¯´ï¼Œç ç‡å¹¶éè¶Šé«˜è¶Šå¥½ï¼Œä¸åŒå†…å®¹ç‰¹å¾çš„è§†é¢‘å¯¹ç ç‡çš„è¦æ±‚å¹¶ä¸ä¸€æ ·ï¼Œå…·ä½“å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š<a href="https://sspai.com/post/66001" target="_blank" rel="noopener noreffer ">ä»€ä¹ˆå†³å®šäº†ä½ çœ‹åˆ°çš„ç”»è´¨</a></p>
<h3 id="ç ç‡æ§åˆ¶ç¤ºä¾‹">ç ç‡æ§åˆ¶ç¤ºä¾‹</h3>
<p></p>
<ul>
<li>ä¸åŒç ç‡æ§åˆ¶æ¨¡å¼ä¸‹ï¼Œå¸§å¤§å°éšæ—¶é—´å˜åŒ–å›¾ï¼ˆå·²å¹³æ»‘åŒ–å¤„ç†ï¼‰</li>
<li>æ³¨æ„ ABR æ¨¡å¼ä¸‹ï¼Œåœ¨ä¸€å¼€å§‹å¯¹ç ç‡çš„é”™è¯¯ä¼°è®¡</li>
</ul>
<h3 id="é€Ÿåº¦-vs-è´¨é‡-vs-æ–‡ä»¶å¤§å°speed-vs-quality-vs-file-size">é€Ÿåº¦ VS è´¨é‡ VS æ–‡ä»¶å¤§å°ï¼ˆSPEED VS. QUALITY VS. FILE SIZEï¼‰</h3>
<p>æœ‰æŸç¼–ç æ¨¡å¼æ€»æ˜¯åœ¨è¿™ä¸‰è€…ä¹‹é—´é€‰æ‹©</p>
<p></p>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li>ä½ å¯ä»¥è®©è§†é¢‘è´¨é‡åˆå¥½ï¼Œç¼–ç åˆå¿«ï¼Œä½†æ˜¯è¾“å‡ºæ–‡ä»¶ä¼šå¾ˆå¤§</li>
<li>ä½ å¯ä»¥è®©è§†é¢‘è´¨é‡åˆå¥½ï¼Œæ–‡ä»¶åˆå°ï¼Œä½†æ˜¯ç¼–ç é€Ÿåº¦ä¼šå¾ˆæ…¢</li>
<li>ä½ å¯ä»¥è®©æ–‡ä»¶åˆå°ï¼Œç¼–ç åˆå¿«ï¼Œä½†æ˜¯è§†é¢‘è´¨é‡å°±ä¼šæ¯”è¾ƒå·®</li>
</ul>
<p>ç¼–è€…æŒ‰ï¼šå‡¡äº‹éœ€è¦åšæŠ‰æ‹©çš„åœ°æ–¹ï¼Œä¸å¯èƒ½ä¸‰è§’æ€»åœ¨é‚£å„¿ç­‰ç€ä½ ã€‚è§†é¢‘ç¼–ç æ—¶å¦‚ä½•å¹³è¡¡é€Ÿåº¦ã€è´¨é‡å’Œæ–‡ä»¶å¤§å°ï¼Œæ˜¯æœ€é‡è¦ä¹Ÿæ˜¯æœ€å¤æ‚çš„è¯¾é¢˜ä¹‹ä¸€ï¼Œåé¢ä¼šå­¦ä¹ /æ’°å†™/ç¿»è¯‘æ›´å¤šçš„æ–‡ç« æ¥ä»‹ç»ã€‚</p>
<h3 id="x264-ç¼–ç å™¨ä¸­çš„é€Ÿåº¦è´¨é‡é¢„è®¾">X264 ç¼–ç å™¨ä¸­çš„é€Ÿåº¦/è´¨é‡é¢„è®¾</h3>
<p>ä½¿ç”¨é¢„è®¾æ¥é€‰æ‹© libx264 çš„ç¼–ç é€Ÿåº¦</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -c:v libx264 -crf <span class="m">23</span> -preset ultrafast -an output.mkv
</span></span><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -c:v libx264 -crf <span class="m">23</span> -preset medium -an output.mkv
</span></span><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -c:v libx264 -crf <span class="m">23</span> -preset veryslow -an output.mkv
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰€æœ‰é¢„è®¾ï¼šultrafast, superfast, veryfast, faster, fast, medium, slow, slower, veryslow</p>
<p>åŒç­‰è´¨é‡ä¸‹ï¼Œä¸€äº›ç¼–ç é€Ÿåº¦äºæ–‡ä»¶ä½“ç§¯çš„å¯¹æ¯”æ ·ä¾‹ï¼š</p>
<table>
<thead>
<tr>
<th>Preset</th>
<th>Encoding Time</th>
<th>File Size</th>
</tr>
</thead>
<tbody>
<tr>
<td>ultrafast</td>
<td>4.85s</td>
<td>15M</td>
</tr>
<tr>
<td>medium</td>
<td>24.13s</td>
<td>5.2M</td>
</tr>
<tr>
<td>veryslow</td>
<td>112.23s</td>
<td>4.9M</td>
</tr>
</tbody>
</table>
<h2 id="æ”¹å˜å¸§ç‡">æ”¹å˜å¸§ç‡</h2>
<p>ç®€å•çš„é€šè¿‡ä¸¢å¼ƒå¸§å’Œå¤åˆ¶å¸§çš„æ–¹å¼æ¥æ”¹å˜å¸§ç‡ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -r <span class="m">24</span> &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ›´å¤æ‚çš„æ–¹æ³•æ¶‰åŠåˆ°è¿‡æ»¤å™¨ï¼ˆfilterï¼‰å‚è€ƒ fps, mpdecimate, minterpolate filters:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -filter:v <span class="nv">fps</span><span class="o">=</span><span class="m">24</span> &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="è½¨é“æ˜ å°„stream-mapping">è½¨é“æ˜ å°„ï¼ˆSTREAM MAPPINGï¼‰</h2>
<p>æ¯ä¸€ä¸ªæ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ IDï¼Œä» 0 å¼€å§‹</p>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li><code>0:0</code> æ˜¯ç¬¬ä¸€ä¸ªè¾“å…¥æ–‡ä»¶çš„ç¬¬ä¸€æ¡è½¨é“ï¼ˆSteamï¼‰</li>
<li><code>0:1</code> æ˜¯ç¬¬ä¸€ä¸ªè¾“å…¥æ–‡ä»¶çš„ç¬¬äºŒæ¡è½¨é“</li>
<li><code>2:a:0</code> æ˜¯ç¬¬ä¸‰ä¸ªè¾“å…¥æ–‡ä»¶çš„ç¬¬ä¸€æ¡éŸ³è½¨</li>
<li>&hellip;</li>
</ul>
<p>ä½ å¯ä»¥å°†è¾“å…¥æ–‡ä»¶çš„è½¨é“æ˜ å°„åˆ°è¾“å‡ºæ–‡ä»¶ä¸­ï¼ˆmap input streams to outputï¼‰ä¾‹å¦‚ï¼šå°†éŸ³é¢‘æ·»åŠ åˆ°è§†é¢‘ä¸­ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i input.mp4 -i input.m4a -c copy -map 0:v:0 -map 1:a:0 output.mp4
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ›´å¤šç»†èŠ‚è¯·å‚è€ƒï¼š<a href="http://trac.ffmpeg.org/wiki/Map" target="_blank" rel="noopener noreffer ">http://trac.ffmpeg.org/wiki/Map</a></p>
<h2 id="ç®€å•è¿‡æ»¤å™¨simple-filtering">ç®€å•è¿‡æ»¤å™¨ï¼ˆSIMPLE FILTERINGï¼‰</h2>
<p>FFmpeg æœ‰å¾ˆå¤šè§†é¢‘ã€éŸ³é¢‘ã€å­—å¹•çš„è¿‡æ»¤å™¨ï¼ˆfilterï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -filter:v <span class="s2">&#34;&lt;filter1&gt;,&lt;filter2&gt;,&lt;filter3&gt;&#34;</span> &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸€ä¸ªè¿‡æ»¤å™¨ï¼ˆæ»¤é•œï¼‰æœ‰ä¸€ä¸ªåç§°ï¼Œä¸€äº›å¯é€‰é¡¹ï¼Œä»¥åŠä¸€äº›é¢„è®¾å‚æ•°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">-filter:v &lt;name&gt;<span class="o">=</span>&lt;option1&gt;<span class="o">=</span>&lt;value1&gt;:&lt;option2&gt;<span class="o">=</span>&lt;value2&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ç¼©æ”¾scaling">ç¼©æ”¾ï¼ˆSCALINGï¼‰</h3>
<p>ç¼©æ”¾åˆ° 320 x 240</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -vf <span class="s2">&#34;scale=w=320:h=240&#34;</span> &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¼©æ”¾åˆ°é«˜åº¦ 240 ä¸”ä¿æŒçºµæ¨ªæ¯”å¯è¢« 2 æ•´é™¤</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -vf <span class="nv">scale</span><span class="o">=</span><span class="nv">w</span><span class="o">=</span>-2:h<span class="o">=</span><span class="m">240</span> &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¼©æ”¾åˆ° 1280 x 720ï¼Œå¦‚æœéœ€è¦çš„è¯ç¼©æ”¾åˆ°æ›´å°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -vf <span class="s2">&#34;scale=1280:720:force_original_aspect_ratio=decrease&#34;</span> &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ›´å¤šå…³äºç¼©æ”¾çš„æŠ€å·§ï¼š</p>
<ul>
<li><a href="http://trac.ffmpeg.org/wiki/Scaling%20%28resizing%29%20with%20ffmpeg" target="_blank" rel="noopener noreffer ">http://trac.ffmpeg.org/wiki/Scaling%20(resizing)%20with%20ffmpeg</a></li>
<li><a href="https://superuser.com/questions/547296/" target="_blank" rel="noopener noreffer ">https://superuser.com/questions/547296/</a></li>
</ul>
<h3 id="å¡«å……padding">å¡«å……ï¼ˆPADDINGï¼‰</h3>
<p>å¡«å……é»‘è¾¹åˆ°æ–‡ä»¶ä¸­ï¼Œä¾‹å¦‚å°† 1920 x 800 çš„è§†é¢‘å¡«å……åˆ° 1920 x 1080ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -vf <span class="s2">&#34;pad=1920:1080:(ow-iw)/2:(oh-ih)/2&#34;</span> &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p></p>
<p>ä½¿ç”¨å¤‡æ³¨ï¼š</p>
<ul>
<li>å¯ä»¥ä½¿ç”¨æ•°å­¦è¡¨è¾¾å¼</li>
<li>ow å’Œ oh æ˜¯è¾“å‡ºæ–‡ä»¶çš„å®½å’Œé«˜</li>
<li>iw å’Œ ih æ˜¯è¾“å…¥æ–‡ä»¶çš„å®½å’Œé«˜</li>
</ul>
<h3 id="æ·¡å…¥æ·¡å‡ºfading">æ·¡å…¥æ·¡å‡ºï¼ˆFADINGï¼‰</h3>
<p>åœ¨ç‰¹å®šçš„æ—¶é—´ç‚¹ä½¿ç”¨æŒ‡å®šæŒç»­æ—¶é—´çš„ç®€å•æ·¡å…¥æ·¡å‡ºæ•ˆæœï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -filter:v <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="s2">&#34;fade=t=in:st=0:d=5,fade=t=out:st=30:d=5&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯‘è€…æŒ‰ï¼šä½¿ç”¨ FFmpeg å‘½ä»¤è¡Œæ—¶ï¼Œæœ‰æ—¶ä¸€è¡Œä»£ç å¤ªé•¿ä¸æ–¹ä¾¿ç¼–å†™å’ŒæŸ¥çœ‹ï¼Œå°±å¯ä»¥ä½¿ç”¨æ¢è¡Œç¬¦åˆ†è¡Œç¼–å†™ï¼Œä¸åŒçš„ Shell æœ‰ä¸åŒçš„æ¢è¡Œç¬¦ï¼Œä¾‹å¦‚ â€œ\â€ æ˜¯ Bash çš„æ¢è¡Œç¬¦ï¼ŒWindows ä¸‹ CMD çš„æ¢è¡Œç¬¦æ˜¯ â€œ^â€ï¼Œè¯·æ³¨æ„æ›¿æ¢ã€‚</p>
<h3 id="æ–‡æœ¬ç»˜å›¾--æ–‡å­—æ°´å°drawing-text">æ–‡æœ¬ç»˜å›¾ / æ–‡å­—æ°´å°ï¼ˆDRAWING TEXTï¼‰</h3>
<p>ç”¨äºåœ¨è§†é¢‘ä¸ŠåŠ ä¸Šæ–‡æœ¬çš„å¤æ‚ç³»ç»Ÿï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input&gt; -vf <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span><span class="nv">drawtext</span><span class="o">=</span><span class="s2">&#34;text=&#39;Test Text&#39;:x=100:y=50:\
</span></span></span><span class="line"><span class="cl"><span class="s2">fontsize=24:fontcolor=yellow:box=1:boxcolor=red&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>&lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å­—ä½“ã€å¤§å°ã€ä½ç½®ã€é¢œè‰²&hellip;éƒ½æœ‰éƒ½æœ‰å„ç§ç›¸å…³çš„å‚æ•°</li>
<li>æ–‡å­—çƒ§å½•åŠŸèƒ½å¯ä»¥æ‹“å±•ï¼Œä¾‹å¦‚æŒ‰å¸§æ•°æˆ–è€…æ—¶é—´ç çƒ§å½•</li>
</ul>
<p>æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œå‚è€ƒï¼š<a href="http://ffmpeg.org/ffmpeg-all.html#drawtext-1" target="_blank" rel="noopener noreffer ">http://ffmpeg.org/ffmpeg-all.html#drawtext-1</a></p>
<h2 id="å¤æ‚è¿‡æ»¤å™¨complex-filtering">å¤æ‚è¿‡æ»¤å™¨ï¼ˆCOMPLEX FILTERINGï¼‰</h2>
<p>å¤æ‚è¿‡æ»¤å™¨ä¸æ­¢ä¸€ä¸ªè¾“å…¥æˆ–è€…è¾“å‡ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input1&gt; -i &lt;input2&gt; -filter_complex <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="s2">&#34;[0:v:0][1:v:0]overlay[outv]&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -map <span class="s2">&#34;[outv]&#34;</span> &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿‡ç¨‹æ‹†è§£ï¼š</p>
<ul>
<li>æŒ‡å®šè¾“å…¥åˆ°è¿‡æ»¤é“¾ï¼ˆfilterchainï¼‰ï¼ˆä¾‹å¦‚ [0:v:0][1:v:0]ï¼‰</li>
<li>æŒ‡å®šè¿‡æ»¤é“¾ä¸­çš„æ»¤é•œï¼ˆä¾‹å¦‚ï¼šoverlayï¼‰</li>
<li>æŒ‡å®šè¿‡æ»¤é“¾çš„è¾“å‡ºæ ‡ç­¾ï¼ˆä¾‹å¦‚ï¼š[outv]ï¼‰</li>
<li>æ˜ å°„è¾“å‡ºæ ‡ç­¾åˆ°è¾“å‡ºæ–‡ä»¶</li>
<li>ä½¿ç”¨ ; ä¸€æ¬¡å¯ä»¥åŒæ—¶ä½¿ç”¨å¤šä¸ªè¿‡æ»¤é“¾</li>
</ul>
<p>æ›´å¤šè¯¦ç»†å†…å®¹ï¼Œå‚è€ƒï¼š<a href="http://ffmpeg.org/ffmpeg-all.html#Filtergraph-syntax-1" target="_blank" rel="noopener noreffer ">http://ffmpeg.org/ffmpeg-all.html#Filtergraph-syntax-1</a></p>
<h3 id="æ‹¼æ¥è½¨é“concatenating-streams">æ‹¼æ¥è½¨é“ï¼ˆCONCATENATING STREAMSï¼‰</h3>
<p>è§£ç ä¸‰ä¸ªè§†é¢‘/éŸ³é¢‘è½¨é“å¹¶æ‹¼æ¥åˆ°å¦ä¸€ä¸ªä¸­ï¼š</p>
<p></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;input1&gt; -i &lt;input2&gt; -i &lt;input3&gt; -filter_complex <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="s2">&#34;[0:0][0:1][1:0][1:1][2:0][2:1]concat=n=3:v=1:a=1[outv][outa]&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -map <span class="s2">&#34;[outv]&#34;</span> -map <span class="s2">&#34;[outa]&#34;</span> &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ›´å¤šä¿¡æ¯ï¼Œå‚è€ƒï¼š<a href="http://trac.ffmpeg.org/wiki/Concatenate" target="_blank" rel="noopener noreffer ">http://trac.ffmpeg.org/wiki/Concatenate</a>ï¼ˆä¹Ÿé€‚ç”¨äºå…¶ä»–æ–¹æ³•ï¼‰</p>
<h3 id="æ—¶é—´çº¿ç¼–è¾‘timeline-editing">æ—¶é—´çº¿ç¼–è¾‘ï¼ˆTIMELINE EDITINGï¼‰</h3>
<p>ä»…åœ¨ç‰¹å®šæ—¶é—´ç‚¹å¯ç”¨è¿‡æ»¤å™¨</p>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li>åœ¨å·¦ä¸Šè§’æ˜¾ç¤ºæ°´å°</li>
<li>ä»…åœ¨ç¬¬ 1 å’Œç¬¬ 2 ç§’æ˜¾ç¤º</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i &lt;video&gt; -i &lt;watermark&gt; -filter_complex <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="s2">&#34;[0:v][1:v]overlay=10:10:enable=&#39;between(t,1,2)&#39;[outv]&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -map <span class="s2">&#34;[outv]&#34;</span> &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ›´å¤šç”¨æ³•ï¼Œè¯·å‚è€ƒï¼š<a href="http://ffmpeg.org/ffmpeg-all.html#Timeline-editing" target="_blank" rel="noopener noreffer ">http://ffmpeg.org/ffmpeg-all.html#Timeline-editing</a></p>
<h2 id="å…¶ä»–è¿‡æ»¤å™¨">å…¶ä»–è¿‡æ»¤å™¨</h2>
<p>é™¤äº†å‰é¢ä»‹ç»çš„é‚£äº›è¿‡æ»¤å™¨ï¼Œffmpeg ç”Ÿæ€ä¸­è¿˜æœ‰å¾ˆå¤šå¾ˆå¤šå…¶ä»–çš„è¿‡æ»¤å™¨ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li>ä½¿ç”¨é€‰æ‹©è¿‡æ»¤å™¨æ£€æµ‹åœºæ™¯å˜åŒ–</li>
<li>å»é™¤æ°´å°ï¼ˆdelogoï¼‰</li>
<li>æ¨¡ç³Šã€è¾¹ç¼˜æ£€æµ‹å’Œå·ç§¯æ»¤æ³¢å™¨</li>
<li>è§†é¢‘ç¨³å®š</li>
<li>çŸ¢é‡ç¤ºæ³¢å™¨ã€ç›´æ–¹å›¾å’Œå…¶ä»–ä¿¡æ¯</li>
<li>è‰²åº¦å’Œ alpha æ§åˆ¶</li>
<li>å­—å¹•ç¼–è¾‘</li>
<li>&hellip;</li>
</ul>
<h2 id="è®¡ç®—ç®€å•çš„è´¨é‡æŒ‡æ ‡">è®¡ç®—ç®€å•çš„è´¨é‡æŒ‡æ ‡</h2>
<h3 id="psnr-peak-signal-to-noise-ratio">PSNR (Peak Signal To Noise Ratio)</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ffmpeg -i &lt;degraded&gt; -i &lt;reference&gt; -filter_complex psnr -f null /dev/null
</span></span><span class="line"><span class="cl"><span class="o">[</span>Parsed_psnr_0 @ 0x7fdb187045c0<span class="o">]</span> PSNR y:33.437789 u:39.814416 v:39.319141 average:34.698320 min:29.305186 max:inf
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯‘è€…æŒ‰ï¼šPSNR ä¸­æ–‡æ ‡å‡†è¯‘åä¸ºâ€œå³°å€¼ä¿¡å™ªæ¯”â€ï¼Œæ˜¯ä¸€ä¸ªæ¯”è¾ƒæˆç†Ÿçš„è¡¡é‡å‹ç¼©å½±åƒä¿¡å™ªæ¯”çš„æŒ‡æ ‡ï¼Œè¯¦æƒ…å¯ä»¥å‚è€ƒ <a href="https://zh.wikipedia.org/zh-cn/%E5%B3%B0%E5%80%BC%E4%BF%A1%E5%99%AA%E6%AF%94" target="_blank" rel="noopener noreffer ">ä¸­æ–‡ç»´åŸºç™¾ç§‘ï¼šå³°å€¼ä¿¡å™ªæ¯”</a></p>
<h3 id="ssim-structural-similarityhttpsenwikipediaorgwikissim">SSIM (<a href="https://en.wikipedia.org/wiki/SSIM" target="_blank" rel="noopener noreffer ">Structural Similarity</a>)</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ffmpeg -i &lt;degraded&gt; -i &lt;reference&gt; -filter_complex ssim -f null /dev/null
</span></span><span class="line"><span class="cl"><span class="o">[</span>Parsed_ssim_0 @ 0x7fbf0500b660<span class="o">]</span> SSIM Y:0.925477 <span class="o">(</span>11.277116<span class="o">)</span> U:0.948906 <span class="o">(</span>12.916325<span class="o">)</span> V:0.946795 <span class="o">(</span>12.740513<span class="o">)</span> All:0.932935 <span class="o">(</span>11.735054<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯‘è€…æŒ‰ï¼šSSIM ä¸­æ–‡ä¸€èˆ¬è¯‘ä¸ºâ€œç»“æ„ç›¸ä¼¼æ€§â€ï¼Œæ˜¯è¡¡é‡ä¸¤å¹…å›¾åƒç›¸ä¼¼åº¦çš„æŒ‡æ ‡ï¼Œå…¶è¯¦ç»†çš„ç§‘æ™®å’Œä½¿ç”¨å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š<a href="https://www.bilibili.com/read/cv7974104/" target="_blank" rel="noopener noreffer ">ä½¿ç”¨SSIMé‡åŒ–è¯„ä»·è§†é¢‘ç¼–ç è´¨é‡</a></p>
<p>è¯‘è€…æŒ‰ï¼šé™¤äº†åŸä½œè€…åˆ—å‡ºçš„ PSNR å’Œ SSIM ä¸¤ä¸ªæŒ‡æ ‡å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ª Netflix å’Œ å—åŠ å·å¤§å­¦è”åˆå¼€å‘çš„ <a href="https://en.wikipedia.org/wiki/Video_Multimethod_Assessment_Fusion" target="_blank" rel="noopener noreffer ">VMAF</a> ï¼ˆVideo Multimethod Assessment Fusionï¼‰æ˜¯ç›®å‰ Netflix ä¸»è¦ä½¿ç”¨çš„æŒ‡æ ‡ï¼Œè¯¦æƒ…è¿˜æ˜¯å¯ä»¥å‚è€ƒå‰æ–‡æåˆ°çš„è¿™ç¯‡æ–‡ç« ï¼š<a href="https://sspai.com/post/66001" target="_blank" rel="noopener noreffer ">ä»€ä¹ˆå†³å®šäº†ä½ çœ‹åˆ°çš„ç”»è´¨</a></p>
<h1 id="ä½¿ç”¨-ffprobe-è·å–åª’ä½“ä¿¡æ¯">ä½¿ç”¨ ffprobe è·å–åª’ä½“ä¿¡æ¯</h1>
<h2 id="åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ</h2>
<p>åŸºç¡€è¯­æ³•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffprobe &lt;input&gt;
</span></span><span class="line"><span class="cl">    <span class="o">[</span>-select_streams &lt;selection&gt;<span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="o">[</span>-show_streams<span class="p">|</span>-show_format<span class="p">|</span>-show_frames<span class="p">|</span>-show_packets<span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="o">[</span>-show_entries &lt;entries&gt;<span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="o">[</span>-of &lt;output-format&gt;<span class="o">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è§£é‡Šï¼š</p>
<ul>
<li>select_streams ç”¨äºæŒ‡å®šé€‰æ‹©è§†é¢‘æˆ–è€…éŸ³é¢‘</li>
<li>show_ ç”¨äºé€‰æ‹©æ˜¾ç¤ºå“ªç§ç±»å‹çš„ä¿¡æ¯</li>
<li>show_entries ç”¨äºé€‰æ‹©æ˜¾ç¤ºæ›´å°‘çš„ä¿¡æ¯</li>
<li>of ç”¨äºè®¾ç½®è¾“å‡ºæ ¼å¼</li>
</ul>
<p>æ›´å¤šä¿¡æ¯ï¼Œå‚è€ƒï¼š</p>
<ul>
<li><a href="https://ffmpeg.org/ffprobe.html" target="_blank" rel="noopener noreffer ">https://ffmpeg.org/ffprobe.html</a></li>
<li><a href="http://trac.ffmpeg.org/wiki/FFprobeTips" target="_blank" rel="noopener noreffer ">http://trac.ffmpeg.org/wiki/FFprobeTips</a></li>
</ul>
<h2 id="å®é™…-ffpobe-æ¡ˆä¾‹-part-1">å®é™… ffpobe æ¡ˆä¾‹ Part 1</h2>
<p>æ˜¾ç¤ºæ‰€æœ‰çš„æµï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffprobe &lt;input&gt; -show_streams
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ˜¾ç¤ºè§†é¢‘æµä¿¡æ¯ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffprobe &lt;input&gt; -select_streams v -show_format
</span></span></code></pre></td></tr></table>
</div>
</div><p>Show presentation timestamp and frame type of every frame, in CSV format (p=0 disables CSV section headers):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffprobe &lt;input&gt; -select_streams v -show_frames <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>-show_entries <span class="nv">frame</span><span class="o">=</span>pkt_pts_time,pict_type -of <span class="nv">csv</span><span class="o">=</span><span class="nv">p</span><span class="o">=</span><span class="m">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯‘è€…æŒ‰ï¼šç¬¬ä¸‰ä¸ªæ¡ˆä¾‹ä¸å¤ªæ‡‚ï¼Œæˆ‘è‡ªå·±è¯•äº†è¯•ï¼Œæ•ˆæœä¹Ÿæœ‰ç‚¹å¥‡æ€ªï¼Œå…ˆæ”¾ç€å§ ğŸ˜‚</p>
<h2 id="å®é™…-ffpobe-æ¡ˆä¾‹-part-2">å®é™… ffpobe æ¡ˆä¾‹ Part 2</h2>
<p>æ›´æ”¹è¾“å‡ºä¸º JSON æ ¼å¼ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffprobe &lt;input&gt; -select_streams v -show_packets -of json
</span></span></code></pre></td></tr></table>
</div>
</div><p>è·å–æ–‡ä»¶ä¸­æµçš„ç¼–å·ï¼ˆnk = 1 ç¦ç”¨ keysï¼‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffprobe &lt;input&gt; -show_format -show_entries <span class="nv">format</span><span class="o">=</span>nb_streams -of <span class="nv">compact</span><span class="o">=</span><span class="nv">nk</span><span class="o">=</span>1:p<span class="o">=</span><span class="m">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»¥ç§’æˆ– HH:MM:SS.ms ä¸ºå•ä½è·å–è§†é¢‘é•¿åº¦</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffprobe &lt;input&gt; -show_format -show_entries <span class="nv">format</span><span class="o">=</span>duration -of <span class="nv">compact</span><span class="o">=</span><span class="nv">nk</span><span class="o">=</span>1:p<span class="o">=</span><span class="m">0</span>
</span></span><span class="line"><span class="cl">ffprobe -sexagesimal &lt;input&gt; -show_format -show_entries <span class="nv">format</span><span class="o">=</span>duration -of <span class="nv">compact</span><span class="o">=</span><span class="nv">nk</span><span class="o">=</span>1:p<span class="o">=</span><span class="m">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»¥ Bit/s ä¸ºå•ä½è·å–éŸ³é¢‘æµ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffprobe &lt;input&gt; -select_streams a -show_entries <span class="nv">stream</span><span class="o">=</span>bit_rate -of <span class="nv">compact</span><span class="o">=</span><span class="nv">nk</span><span class="o">=</span>1:p<span class="o">=</span><span class="m">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯‘è€…æŒ‰ï¼šå…¶å®è¿™ä¸€ç« èŠ‚çš„æ¡ˆä¾‹æˆ‘ä¸ªäººè§‰å¾—æ²¡æœ‰å¾ˆå¤§ä½œç”¨ï¼Œå¹³æ—¶æŸ¥çœ‹åª’ä½“æ–‡ä»¶çš„ä¿¡æ¯åŸºæœ¬ä¸Šä½¿ç”¨ <code>ffprobe &lt;input&gt; -hide_banner</code> å°±å¤Ÿäº†ã€‚</p>
<h1 id="æ£€æŸ¥è§†é¢‘ç¼–è§£ç å™¨">æ£€æŸ¥è§†é¢‘ç¼–è§£ç å™¨</h1>
<h2 id="è°ƒè¯•è¿åŠ¨å‘é‡">è°ƒè¯•è¿åŠ¨å‘é‡</h2>
<p>åœ¨ FFmpeg ä¸­ä½¿ç”¨ H.264 ç¼–è§£ç å™¨å¯è§†åŒ–è¿åŠ¨å‘é‡çš„ç®€å•æ–¹æ³•ï¼ˆä¸é€‚ç”¨äºå…¶ä»–ç¼–è§£ç å™¨ï¼‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffplay -flags2 +export_mvs input.mp4 -vf <span class="nv">codecview</span><span class="o">=</span><span class="nv">mv</span><span class="o">=</span>pf+bf+bb
</span></span><span class="line"><span class="cl">ffmpeg -flags2 +export_mvs -i input.mp4 -vf <span class="nv">codecview</span><span class="o">=</span><span class="nv">mv</span><span class="o">=</span>pf+bf+bb &lt;output&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>pf â€“ P å¸§çš„å‘å‰é¢„æµ‹è¿åŠ¨å‘é‡</li>
<li>bf â€“ B å¸§çš„å‘å‰é¢„æµ‹è¿åŠ¨å‘é‡</li>
<li>bb â€“ B å¸§çš„å‘åé¢„æµ‹è¿åŠ¨å‘é‡</li>
</ul>
<p></p>
<p>è·Ÿå¤šå‚è€ƒï¼š<a href="http://trac.ffmpeg.org/wiki/Debug/MacroblocksAndMotionVectors" target="_blank" rel="noopener noreffer ">http://trac.ffmpeg.org/wiki/Debug/MacroblocksAndMotionVectors</a></p>
<p>è¯‘è€…æŒ‰ï¼šè¿åŠ¨å‘é‡è¿™æ–¹é¢çš„çŸ¥è¯†ç‚¹æˆ‘ä¹Ÿä¸æ‡‚ï¼Œæ¥æ—¥å†è¡¥å……å§ ğŸ˜‚</p>
<h2 id="è§†é¢‘æµåˆ†æ">è§†é¢‘æµåˆ†æ</h2>
<p>å›¾å½¢åŒ–æ–¹å¼åˆ†æè§†é¢‘æµçš„å…¶ä»–è½¯ä»¶ï¼š</p>
<ul>
<li><a href="https://www.elecard.com/products/video-analysis/stream-analyzer" target="_blank" rel="noopener noreffer ">Elecard Stream Analyzer</a> (å•†ä¸š)</li>
<li><a href="http://www.codecian.com/" target="_blank" rel="noopener noreffer ">CodecVisa</a> (å•†ä¸š)</li>
<li><a href="https://software.intel.com/en-us/intel-video-pro-analyzer" target="_blank" rel="noopener noreffer ">Intel Video Pro Analyzer</a> (å•†ä¸š)</li>
<li><a href="https://people.xiph.org/~mbebenita/analyzer/" target="_blank" rel="noopener noreffer ">AOMAnalyzer</a> (å…è´¹ï¼Œé’ˆå¯¹ AV1/VP9 ç¼–ç çš„è§†é¢‘)</li>
</ul>
<h1 id="æ€»ç»“">æ€»ç»“</h1>
<p>é€šè¿‡è¿™èŠ‚è¯¾ç¨‹ï¼Œä½ åº”è¯¥å­¦åˆ°äº†ä»¥ä¸‹çŸ¥è¯†ç‚¹ï¼š</p>
<ul>
<li>ç†è§£ FFmpeg åº“ï¼Œç¼–è§£ç å™¨ï¼Œå®¹å™¨ï¼Œç¼–ç å™¨&hellip;</li>
<li>ç¼–ç è§†é¢‘å’ŒéŸ³é¢‘</li>
<li>ä½¿ç”¨åŸºç¡€çš„è¿‡æ»¤å™¨</li>
<li>è¯»å–æµä¿¡æ¯å’Œå…ƒæ•°æ®</li>
<li>å¦‚æœä½ é‡åˆ°äº†å›°éš¾ï¼Œä¼šå¯»æ‰¾å¸®åŠ©</li>
</ul>
]]></description>
</item>
<item>
    <title>Java é›†åˆæ¡†æ¶ä¸€æ–‡é€š</title>
    <link>https://asimov.top/the-java-collections-framework/</link>
    <pubDate>Sun, 02 May 2021 22:46:28 &#43;0800</pubDate>
    <author>asimov</author>
    <guid>https://asimov.top/the-java-collections-framework/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="https://www.softwaretestingmaterial.com/wp-content/uploads/2018/08/Collections-Framework-In-Java.png" referrerpolicy="no-referrer">
            </div><h2 id="overview">Overview</h2>
<p>å®¹å™¨ï¼Œå°±æ˜¯å¯ä»¥å®¹çº³å…¶å®ƒå¯¹è±¡çš„å¯¹è±¡ï¼Œä» JDK 1.2 å¼€å§‹ï¼ŒJava æä¾›äº† <strong>Java Collection Frameworkï¼ˆJCFï¼‰</strong> ç»™å¼€å‘è€…æä¾›äº†ä¸€ä¸ªé€šç”¨çš„å®¹å™¨æ¡†æ¶ã€‚</p>
<p>å®¹å™¨ä¸­åªèƒ½æ”¾å¯¹è±¡ï¼Œå¯¹äºåŸºæœ¬ç±»å‹ï¼ˆintã€longã€float ç­‰ï¼‰éœ€è¦åŒ…è£…æˆå¯¹åº”çš„å¯¹è±¡ï¼ˆIntegerã€Longã€Floatï¼‰æ‰èƒ½æ”¾å…¥å®¹å™¨ã€‚å¤§å¤šæ•°æ—¶å€™è£…ç®±å’Œæ‹†ç®±éƒ½æ˜¯è‡ªåŠ¨å®Œæˆçš„ï¼Œè¿™ä¼šé€ æˆä¸€å®šç¨‹åº¦ä¸Šçš„æ€§èƒ½å’Œç©ºé—´å¼€é”€ï¼Œä½†æ˜¯ç®€åŒ–äº†è®¾è®¡å’Œç¼–ç ï¼Œæé«˜äº†å¼€å‘æ•ˆç‡ã€‚ä½¿ç”¨å®¹å™¨å¤§æ¦‚æœ‰å¦‚ä¸‹ä¼˜ç‚¹ï¼š</p>
<ul>
<li>é™ä½å­¦ä¹ éš¾åº¦</li>
<li>é™ä½ç¼–ç¨‹éš¾åº¦</li>
<li>é™ä½è®¾è®¡å’Œå®ç°ç›¸å…³ API çš„éš¾åº¦</li>
<li>æé«˜ç¨‹åºå¯å¤ç”¨æ€§</li>
<li>æé«˜ API ä¹‹é—´çš„äº’æ“ä½œæ€§</li>
<li>æé«˜ç¨‹åºæ€§èƒ½ï¼ˆå®¹å™¨çš„åº•å±‚æ•°æ®ç»“æ„å’Œç®—æ³•é€šå¸¸è¿‡äº†å¤§è§„æ¨¡çš„åŠŸèƒ½å’Œæ€§èƒ½éªŒè¯ï¼Œå¤§éƒ¨åˆ†åœºæ™¯ä¸‹æ€§èƒ½ä¼šæ¯”æˆ‘ä»¬è‡ªå·±å†™çš„å¥½ï¼‰</li>
</ul>
<p>Java é›†åˆæ¡†æ¶åˆ†ä¸º Collection å’Œ Map ä¸¤å¤§ç±»ï¼ŒCollection æ˜¯å­˜å‚¨å•å…ƒç´ çš„å®¹å™¨ï¼ŒMap æ˜¯å­˜å‚¨é”®å€¼å¯¹ï¼ˆä¸¤ä¸ªå¯¹è±¡ï¼‰çš„å®¹å™¨ã€‚</p>
<p>è¯¦æƒ…çš„ JCF ç±»å›¾å¦‚ä¸‹ï¼ŒåŒ…å«å¹¶å‘å’Œéå¹¶å‘å®ç°ï¼Œä»¥åŠåº•å±‚æ•°æ®ç»“æ„ï¼š</p>
<p></p>
<p>åœ¨ <code>J.U.C(java.util.concurrent)</code> æä¾›å¹¶å‘å®¹å™¨ä¹‹å‰ï¼Œæ‰€æœ‰å®¹å™¨éƒ½åœ¨ <code>java.util</code> åŒ…ä¸‹ï¼Œå…¶ä¸­å¤§éƒ¨åˆ†éƒ½æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œè¿™æ„å‘³ç€å¤šä¸ªçº¿ç¨‹å¹¶å‘è¯»å†™æ—¶å¯èƒ½ä¼šå‡ºç°æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µã€‚</p>
<p>å³ä½¿æä¾›äº†çº¿ç¨‹å®‰å…¨çš„å®ç°ï¼Œä¹Ÿæ˜¯æ¯”è¾ƒç®€å•ç²—æš´çš„ä½¿ç”¨ <code>Synchronized</code> å…³é”®å­—å¯¹æ“ä½œåŠ é”ï¼Œæ¯”å¦‚çº¿ç¨‹å®‰å…¨çš„ Map å®¹å™¨ï¼šHashTableï¼Œå’Œçº¿ç¨‹å®‰å…¨çš„ Collection å®¹å™¨ï¼šVectorï¼Œå®é™…ä¸Šè¿™äº›å®¹å™¨åœ¨å¹¶å‘è¯»å†™çš„éœ€æ±‚ä¸‹ï¼Œåªèƒ½ä¿è¯å®‰å…¨ï¼Œä¸èƒ½ä¿è¯é«˜æ•ˆï¼Œå› æ­¤åŸºæœ¬éƒ½å·²ç»ä¸æ¨èä½¿ç”¨äº†ã€‚</p>
<h2 id="non-concurrent-collections">Non Concurrent Collections</h2>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹å®é™…å¼€å‘ä¸­ä½¿ç”¨å¾—æœ€å¤šçš„ <strong>â€œå•çº¿ç¨‹å®¹å™¨â€</strong>ï¼Œå…¶ç±»å›¾ç»“æ„å¤§æ¦‚å¦‚ä¸‹å›¾ï¼š</p>
<p></p>
<h3 id="collection">Collection</h3>
<p>Collection æ¥å£æ˜¯ JDK ä¸­æ‰€æœ‰<strong>å•å…ƒç´ å®¹å™¨</strong>çš„ç¥–å…ˆæ¥å£ï¼Œå…¶ä¸‹ä¸»è¦æœ‰ä¸‰ä¸ªæ¥å£ï¼Œåˆ†åˆ«æ˜¯<strong>å¯é‡å¤é›†åˆå®¹å™¨æ¥å£ List</strong>ï¼Œ<strong>ä¸å¯é‡å¤é›†åˆå®¹å™¨æ¥å£ Set</strong>ï¼Œå’Œ<strong>é˜Ÿåˆ—å®¹å™¨æ¥å£ Queue</strong>ï¼Œåˆ†åˆ«é€‚ç”¨äºä¸åŒåœºæ™¯ã€‚</p>
<h4 id="list">List</h4>
<p>List æ˜¯ä¸€ä¸ª<strong>å…ƒç´ æœ‰åºã€å¯é‡å¤ã€å¯ä¸ºç©º</strong>çš„é›†åˆæ¥å£ï¼Œé›†åˆä¸­æ¯ä¸ªå…ƒç´ éƒ½æœ‰å¯¹åº”çš„é¡ºåºç´¢å¼•ï¼Œé»˜è®¤æŒ‰ç…§å…ƒç´ çš„æ·»åŠ é¡ºåºè®¾ç½®ä¸‹æ ‡ï¼Œå¯ä»¥é€šè¿‡ä¸‹æ ‡è®¿é—®æŒ‡å®šä½ç½®çš„å…ƒç´ ï¼Œä½†æ˜¯ç”±äºä¸åŒå®ç°ç±»ä¸­åº•å±‚ä½¿ç”¨çš„æ•°æ®ç»“æ„ä¸åŒï¼Œæ·»åŠ ã€åˆ é™¤å’Œéšæœºè®¿é—®çš„æ—¶é—´å¤æ‚åº¦å„ä¸ç›¸åŒã€‚</p>
<h5 id="arraylist">ArrayList</h5>
<p>ArrayList æ˜¯<strong>åŸºäºæ•°ç»„å®ç°</strong>çš„å®¹å™¨ç±»ï¼Œæ¯ä¸ª ArrayList éƒ½æœ‰ä¸€ä¸ªå®¹é‡ï¼ˆcapacityï¼‰è¡¨ç¤ºåº•å±‚æ•°ç»„çš„å¤§å°ï¼Œå½“å®¹é‡ä¸è¶³æ—¶ï¼ŒArrayList ä¼šè‡ªåŠ¨æ‰©å®¹ï¼Œ<strong>é»˜è®¤æ‰©å®¹æ­¥é•¿æ˜¯å½“å‰å®¹é‡çš„ 1.5 å€</strong>ã€‚</p>
<p>ç”±äº ArrayList çš„åº•å±‚æ•°æ®ç»“æ„æ˜¯æ•°ç»„ï¼Œéœ€è¦è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œæ‰€ä»¥è‡ªåŠ¨æ‰©å®¹å®é™…ä¸Šæ˜¯ç”³è¯·ä¸€ä¸ªåŸæ¥å¤§å° 1.5 å€çš„æ–°æ•°ç»„ï¼Œç„¶åå°†åŸæ•°ç»„ä¸­çš„æ•°æ®æ‹·è´åˆ°æ–°æ•°ç»„ä¸­ï¼Œè¿™ä¸ªæ“ä½œæ˜¯æ¯”è¾ƒè€—æ—¶çš„ã€‚</p>
<p>å› æ­¤åœ¨ä½¿ç”¨ ArrayList æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä¸¤ä¸ªæŠ€å·§ï¼Œå°½é‡é¿å…æˆ–å‡å°‘æ‰©å®¹æ“ä½œï¼Œæé«˜æ•ˆç‡ï¼š</p>
<ul>
<li>åœ¨åˆå§‹åŒ–æ—¶ï¼Œå°½é‡è®¾ç½®ä¸€ä¸ªåˆç†çš„åˆå§‹å¤§å°ï¼Œå‡å°‘æ‰©å®¹é¢‘ç‡ã€‚</li>
<li>åœ¨æ·»åŠ å¤§é‡å…ƒç´ ä¹‹å‰ï¼Œå¯ä»¥æ‰‹åŠ¨è°ƒç”¨ <code>ensureCapacity(int minCapacity)</code> å¢å¤§å®¹é‡ï¼Œå‡å°‘é€’å¢å¼æ‰©å®¹çš„æ¬¡æ•°ã€‚</li>
</ul>
<p>åŸºäºæ•°ç»„çš„æ•°æ®ç»“æ„ï¼Œ<strong>ArrayList éšæœºè®¿é—®çš„çš„æ•ˆç‡éå¸¸é«˜</strong>ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ $O(1)$ï¼Œè€Œ<strong>æ’å…¥å’Œåˆ é™¤çš„æ•ˆç‡ç¨ä½</strong>ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ $O(n)$</p>
<p>ArrayList è¯¦ç»†çš„æºç è§£æå‚è€ƒ<a href="https://pdai.tech/md/java/collection/java-collection-ArrayList.html" target="_blank" rel="noopener noreffer ">è¿™é‡Œ</a></p>
<h5 id="linkedlist">LinkedList</h5>
<p>LinkedList æ˜¯<strong>åŸºäºé“¾è¡¨å®ç°</strong>çš„å®¹å™¨ç±»ï¼ŒåŒæ—¶å®ç°äº† List æ¥å£å’Œ Queue æ¥å£çš„é›†åˆï¼Œè¿™æ„å‘³å®ƒæ—¢å¯ä»¥å½“åšé¡ºåºå®¹å™¨ï¼ˆListï¼‰ä½¿ç”¨ï¼Œåˆå¯ä»¥å½“åšé˜Ÿåˆ—ï¼ˆQueueï¼‰ä½¿ç”¨ï¼Œè¿˜å¯ä»¥å½“åšæ ˆï¼ˆStackï¼‰æ¥ä½¿ç”¨ã€‚</p>
<p>å®é™…ä¸Šï¼Œå½“æˆ‘ä»¬éœ€è¦æ ˆæˆ–è€…é˜Ÿåˆ—æ—¶ï¼Œåº”è¯¥é¦–é€‰ ArrayDequeï¼Œåœ¨æ ˆå’Œé˜Ÿåˆ—çš„ä½¿ç”¨åœºæ™¯ä¸­ï¼ŒArrayDeque æ¯” LinkedList æ€§èƒ½æ›´å¥½ã€‚æ‰€ä»¥ LinkedList æ›´å¤šçš„æ—¶å€™è¿˜æ˜¯ç”¨æ¥å½“åšé¡ºåºé›†åˆï¼ˆListï¼‰æ¥ä½¿ç”¨ã€‚</p>
<p>åŸºäºé“¾è¡¨çš„æ•°æ®ç»“æ„ï¼Œ<strong>LinkedList æ’å…¥å’Œåˆ é™¤çš„æ•ˆç‡éå¸¸é«˜</strong>ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ $O(1)$ï¼Œè€Œ<strong>éšæœºè®¿é—®çš„æ•ˆç‡ç¨ä½</strong>ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ $O(n)$ï¼Œè€Œä¸”ä¸å­˜åœ¨æ‰©å®¹æ—¶çš„æ•°æ®æ‹·è´å¯¼è‡´çš„æ•ˆç‡é—®é¢˜ã€‚</p>
<p>LinkedList è¯¦ç»†çš„æºç è§£æï¼Œå‚è€ƒ<a href="https://pdai.tech/md/java/collection/java-collection-LinkedList.html" target="_blank" rel="noopener noreffer ">è¿™é‡Œ</a></p>
<h5 id="vector">Vector</h5>
<p>Vector åŸºæœ¬å’Œ ArrayList åŸºæœ¬ä¸€æ ·ï¼Œä½†æ˜¯å†…éƒ¨ä½¿ç”¨ <code>synchronized</code> å¯¹æ‰€æœ‰è¯»å†™æ“ä½œéƒ½åšäº†åŒæ­¥ï¼Œå› æ­¤æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†æ˜¯åº”ä¸º <code>synchronized</code> æœ¬èº«å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼æ•ˆç‡å¹¶ä¸é«˜ï¼Œæ‰€ä»¥åœ¨<strong>å¤šçº¿ç¨‹é«˜å¹¶å‘åœºæ™¯ä¸‹</strong>ï¼Œä½¿ç”¨ Vector å¯èƒ½ä¼šé€ æˆæ€§èƒ½é—®é¢˜ï¼Œ<strong>åº”è¯¥ä½¿ç”¨</strong> <code>JUC</code> ä¸­æä¾›çš„ <strong>CopyOnWriteArrayList</strong>ã€‚</p>
<h5 id="stack">Stack</h5>
<p>Stack ç»§æ‰¿è‡ª Vectorï¼Œæ˜¯ä¸€ä¸ªä½¿ç”¨æ•°ç»„å®ç°çš„æ ˆç»“æ„ï¼Œç”±äºåŠŸèƒ½å’Œæ€§èƒ½é™åˆ¶ï¼Œç°åœ¨å·²ç»<strong>ä¸æ¨èä½¿ç”¨</strong>äº†ï¼Œå¦‚æœéœ€è¦æ ˆç»“æ„ï¼Œåº”è¯¥ä½¿ç”¨ Queue æ¥å£ä¸‹çš„ ArrayDeque å®ç°ç±»ï¼Œå‚è€ƒä¸‹æ–‡ ArrayDeque çš„ä»‹ç»ã€‚</p>
<h4 id="set">Set</h4>
<p>Set æ¥å£ä¸­çš„æ–¹æ³•åŸºæœ¬å’Œ List ä¸€æ ·ï¼ŒåŒºåˆ«åœ¨äº Set é›†åˆä¸­<strong>ä¸å…è®¸é‡å¤å…ƒç´ </strong>ï¼Œå¦‚æœæ·»åŠ ç›¸åŒçš„å…ƒç´ åˆ° Set é›†åˆä¸­ï¼Œç¬¬äºŒæ¬¡æ·»åŠ æ—¶ <code>add()</code> æ–¹æ³•ä¼šè¿”å› <code>false</code>ï¼Œæ•°æ®ä¼šæ·»åŠ å¤±è´¥ï¼ŒSet æ¥å£ä¹Ÿ<strong>ä¸å¼ºåˆ¶ä¿è¯é›†åˆä¸­å…ƒç´ çš„é¡ºåº</strong>ï¼Œä¸åŒçš„å®ç°ç±»æ ¹æ®è‡ªèº«çš„å®ç°æ–¹å¼å†³å®šæ˜¯å¦ä¿æŒé¡ºåºï¼Œå¹¶ä¸”ä¹Ÿ<strong>ä¸é™åˆ¶å…ƒç´ æ˜¯å¦å¯ä¸ºç©º</strong>ï¼Œä¸åŒçš„å®ç°ç±»å¯å¦ä¸ºç©ºçš„ç‰¹ç‚¹ä¸åŒã€‚</p>
<p>Set æ¥å£çš„å®ç°å…¶å®å°±æ˜¯æŠŠå¯¹åº”çš„ Map æ¥å£çš„å®ç°è¿›è¡Œä¸€å±‚åŒ…è£…ï¼Œæ¯”å¦‚ HashSet æ˜¯å¯¹ HashMap çš„åŒ…è£…ï¼ŒTreeSet æ˜¯å¯¹ TreeMap çš„åŒ…è£…ï¼ŒLinkedHashSet æ˜¯å¯¹ LinkedHashMap çš„åŒ…è£…ã€‚</p>
<h5 id="hashset">HashSet</h5>
<p>HashSet å®é™…ä¸Šæ˜¯å¯¹ HashMap çš„ä¸€ä¸ªåŒ…è£…ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HashSet</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="o">......</span>
</span></span><span class="line"><span class="cl">	<span class="c1">//HashSeté‡Œé¢æœ‰ä¸€ä¸ªHashMap
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="kd">private</span> <span class="kd">transient</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">E</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">map</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Dummy value to associate with an Object in the backing Map
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Object</span> <span class="n">PRESENT</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="nf">HashSet</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">......</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">add</span><span class="o">(</span><span class="n">E</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	    <span class="c1">//ç®€å•çš„æ–¹æ³•è½¬æ¢
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">e</span><span class="o">,</span> <span class="n">PRESENT</span><span class="o">)==</span><span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">......</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰€ä»¥å…¶å®ç°åŸç†å’Œ HashMap ä¸€è‡´ï¼Œå‚è€ƒä¸‹æ–‡ HashMap çš„å®ç°ä¸ç‰¹ç‚¹ã€‚</p>
<h5 id="treeset">TreeSet</h5>
<p>TreeSet å®é™…ä¸Šä¹Ÿæ˜¯å¯¹ TreeMap çš„ä¸€ä¸ªåŒ…è£…ï¼Œå¦‚ä¸‹ä»£ç ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TreeSet</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">AbstractSet</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">NavigableSet</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;,</span> 
</span></span><span class="line"><span class="cl">		<span class="n">Cloneable</span><span class="o">,</span> <span class="n">java</span><span class="o">.</span><span class="na">io</span><span class="o">.</span><span class="na">Serializable</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">......</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">transient</span> <span class="n">NavigableMap</span><span class="o">&lt;</span><span class="n">E</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">m</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Dummy value to associate with an Object in the backing Map
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Object</span> <span class="n">PRESENT</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="nf">TreeSet</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	    <span class="c1">// TreeSeté‡Œé¢æœ‰ä¸€ä¸ªTreeMap
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">this</span><span class="o">.</span><span class="na">m</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TreeMap</span><span class="o">&lt;</span><span class="n">E</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">......</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">add</span><span class="o">(</span><span class="n">E</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	    <span class="c1">//ç®€å•çš„æ–¹æ³•è½¬æ¢
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">e</span><span class="o">,</span> <span class="n">PRESENT</span><span class="o">)==</span><span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">......</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰€ä»¥å…¶å®ç°åŸç†å’Œ TreeMap ä¸€è‡´ï¼Œå‚è€ƒä¸‹æ–‡ TreeMap çš„å®ç°ä¸ç‰¹ç‚¹ã€‚</p>
<h5 id="linkedhashset">LinkedHashSet</h5>
<p>LinkedHashSet å®é™…ä¸Šä¹Ÿæ˜¯å¯¹ LinkedHashMap çš„åŒ…è£…ï¼ŒåŸºæœ¬å°±æ˜¯è¿™æ ·ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LinkedHashSet</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">extends</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">implements</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;,</span> <span class="n">Cloneable</span><span class="o">,</span> <span class="n">java</span><span class="o">.</span><span class="na">io</span><span class="o">.</span><span class="na">Serializable</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">......</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// LinkedHashSeté‡Œé¢æœ‰ä¸€ä¸ªLinkedHashMap
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">public</span> <span class="nf">LinkedHashSet</span><span class="o">(</span><span class="kt">int</span> <span class="n">initialCapacity</span><span class="o">,</span> <span class="kt">float</span> <span class="n">loadFactor</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedHashMap</span><span class="o">&lt;&gt;(</span><span class="n">initialCapacity</span><span class="o">,</span> <span class="n">loadFactor</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">	<span class="o">......</span>
</span></span><span class="line"><span class="cl">	<span class="c1">//ç®€å•çš„æ–¹æ³•è½¬æ¢
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">add</span><span class="o">(</span><span class="n">E</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">e</span><span class="o">,</span> <span class="n">PRESENT</span><span class="o">)==</span><span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">......</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰€ä»¥å…¶å®ç°åŸç†å’Œ LinkedHashMap ä¸€è‡´ï¼Œå‚è€ƒä¸‹æ–‡ LinkedHashMap çš„å®ç°ä¸ç‰¹ç‚¹ã€‚</p>
<h4 id="queue">Queue</h4>
<p>Queue æ˜¯ JDK ä¸­é˜Ÿåˆ—ä¹Ÿç»§æ‰¿è‡ª Collection æ¥å£ï¼Œé™¤äº† Collection æ¥å£ä¸­çš„æ–¹æ³•ï¼Œè¿˜é¢å¤–æä¾›äº†ä¸¤ç»„å…± 6 ä¸ªæ–¹æ³•ï¼Œè§„èŒƒé˜Ÿåˆ—ç‰¹å¾çš„èƒ½åŠ›ï¼Œä¸€ç»„æ˜¯æŠ›å‡ºå¼‚å¸¸çš„å®ç°ï¼Œä¸€ç»„æ˜¯è¿”å›å€¼çš„å®ç°ï¼ˆæ²¡æœ‰åˆ™è¿”å› nullï¼‰</p>
<table>
<thead>
<tr>
<th></th>
<th style="text-align:center"><strong>hrows exception</strong></th>
<th style="text-align:center"><strong>Returns special value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Insert</td>
<td style="text-align:center">add(e)</td>
<td style="text-align:center">offer(e)</td>
</tr>
<tr>
<td>Remove</td>
<td style="text-align:center">remove(e)</td>
<td style="text-align:center">poll(e)</td>
</tr>
<tr>
<td>Examine</td>
<td style="text-align:center">element(e)</td>
<td style="text-align:center">peek(e)</td>
</tr>
</tbody>
</table>
<h5 id="deque--arraydeque">Deque &amp; ArrayDeque</h5>
<p>Deque æ˜¯ï¼ˆdouble ended queueï¼‰çš„ç®€ç§°ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯åŒç«¯é˜Ÿåˆ—ï¼Œæ˜¯ç»§æ‰¿è‡ª Queue æ¥å£çš„å­æ¥å£ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨æ•°æ®ç»“æ„ä¸­ï¼Œé˜Ÿåˆ—ï¼ˆQueueï¼‰å’Œæ ˆï¼ˆStackï¼‰çš„æ˜¯å¾ˆç›¸ä¼¼çš„ï¼Œ<strong>é˜Ÿåˆ—çš„å‡ºå…¥å£åˆ†åˆ«åœ¨ä¸¤ç«¯ï¼Œæ‰€ä»¥æ˜¯å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰</strong>ï¼Œè€Œ<strong>æ ˆçš„å‡ºå…¥å£åœ¨åŒä¸€ç«¯ï¼Œæ‰€ä»¥æ˜¯åè¿›å…ˆå‡ºï¼ˆLIFOï¼‰</strong>ã€‚è€ŒåŒç«¯é˜Ÿåˆ—çš„ä¸¤ç«¯åˆ†åˆ«éƒ½å¯ä»¥åšå‡ºå…¥å£ï¼Œå¦‚æœå°ä½å…¶ä¸­çš„ä¸€ç«¯ï¼Œé‚£å°±å˜æˆäº†æ ˆï¼Œæ‰€ä»¥åŒç«¯é˜Ÿåˆ—ä¹Ÿå¯ä»¥ç›´æ¥å½“åšæ ˆæ¥ç”¨ã€‚</p>
<p>å½“åšé˜Ÿåˆ—ä½¿ç”¨æ—¶ï¼Œä¸‹è¡¨åˆ—å‡ºäº† Deque ä¸ Queue ç›¸å¯¹åº”çš„æ¥å£ï¼š</p>
<table>
<thead>
<tr>
<th>Queue Method</th>
<th>Equivalent Deque Method</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>add(e)</code></td>
<td><code>addLast(e)</code></td>
<td>å‘é˜Ÿå°¾æ’å…¥å…ƒç´ ï¼Œå¤±è´¥åˆ™æŠ›å‡ºå¼‚å¸¸</td>
</tr>
<tr>
<td><code>offer(e)</code></td>
<td><code>offerLast(e)</code></td>
<td>å‘é˜Ÿå°¾æ’å…¥å…ƒç´ ï¼Œå¤±è´¥åˆ™è¿”å›<code>false</code></td>
</tr>
<tr>
<td><code>remove()</code></td>
<td><code>removeFirst()</code></td>
<td>è·å–å¹¶åˆ é™¤é˜Ÿé¦–å…ƒç´ ï¼Œå¤±è´¥åˆ™æŠ›å‡ºå¼‚å¸¸</td>
</tr>
<tr>
<td><code>poll()</code></td>
<td><code>pollFirst()</code></td>
<td>è·å–å¹¶åˆ é™¤é˜Ÿé¦–å…ƒç´ ï¼Œå¤±è´¥åˆ™è¿”å›<code>null</code></td>
</tr>
<tr>
<td><code>element()</code></td>
<td><code>getFirst()</code></td>
<td>è·å–ä½†ä¸åˆ é™¤é˜Ÿé¦–å…ƒç´ ï¼Œå¤±è´¥åˆ™æŠ›å‡ºå¼‚å¸¸</td>
</tr>
<tr>
<td><code>peek()</code></td>
<td><code>peekFirst()</code></td>
<td>è·å–ä½†ä¸åˆ é™¤é˜Ÿé¦–å…ƒç´ ï¼Œå¤±è´¥åˆ™è¿”å›<code>null</code></td>
</tr>
</tbody>
</table>
<p>å½“åšæ ˆä½¿ç”¨æ—¶ï¼Œä¸‹è¡¨åˆ—å‡ºäº† Deque å’Œ ä¸ Stackï¼ˆå·²é€€ä¼‘çš„æ ˆç»“æ„å®ç°ï¼‰å¯¹åº”çš„æ¥å£ï¼š</p>
<table>
<thead>
<tr>
<th>Stack Method</th>
<th>Equivalent Deque Method</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>push(e)</code></td>
<td><code>addFirst(e)</code></td>
<td>å‘æ ˆé¡¶æ’å…¥å…ƒç´ ï¼Œå¤±è´¥åˆ™æŠ›å‡ºå¼‚å¸¸</td>
</tr>
<tr>
<td>æ— </td>
<td><code>offerFirst(e)</code></td>
<td>å‘æ ˆé¡¶æ’å…¥å…ƒç´ ï¼Œå¤±è´¥åˆ™è¿”å›<code>false</code></td>
</tr>
<tr>
<td><code>pop()</code></td>
<td><code>removeFirst()</code></td>
<td>è·å–å¹¶åˆ é™¤æ ˆé¡¶å…ƒç´ ï¼Œå¤±è´¥åˆ™æŠ›å‡ºå¼‚å¸¸</td>
</tr>
<tr>
<td>æ— </td>
<td><code>pollFirst()</code></td>
<td>è·å–å¹¶åˆ é™¤æ ˆé¡¶å…ƒç´ ï¼Œå¤±è´¥åˆ™è¿”å›<code>null</code></td>
</tr>
<tr>
<td><code>peek()</code></td>
<td><code>peekFirst()</code></td>
<td>è·å–ä½†ä¸åˆ é™¤æ ˆé¡¶å…ƒç´ ï¼Œå¤±è´¥åˆ™æŠ›å‡ºå¼‚å¸¸</td>
</tr>
<tr>
<td>æ— </td>
<td><code>peekFirst()</code></td>
<td>è·å–ä½†ä¸åˆ é™¤æ ˆé¡¶å…ƒç´ ï¼Œå¤±è´¥åˆ™è¿”å›<code>null</code></td>
</tr>
</tbody>
</table>
<p>ä¸Šé¢ä¸¤ä¸ªè¡¨å…±å®šä¹‰äº† Deque çš„ 12 ä¸ªæ¥å£ã€‚æ·»åŠ ï¼Œåˆ é™¤ï¼Œå–å€¼éƒ½æœ‰ä¸¤å¥—æ¥å£ï¼Œå®ƒä»¬åŠŸèƒ½ç›¸åŒï¼ŒåŒºåˆ«æ˜¯å¯¹å¤±è´¥æƒ…å†µçš„å¤„ç†ä¸åŒã€‚<strong>ä¸€å¥—æ¥å£é‡åˆ°å¤±è´¥å°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¦ä¸€å¥—é‡åˆ°å¤±è´¥ä¼šè¿”å›ç‰¹æ®Šå€¼ï¼ˆ<code>false</code> æˆ– <code>null</code>ï¼‰</strong>ã€‚é™¤éæŸç§å®ç°å¯¹å®¹é‡æœ‰é™åˆ¶ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ·»åŠ æ“ä½œæ˜¯ä¸ä¼šå¤±è´¥çš„ã€‚<strong>è™½ç„¶ Deque çš„æ¥å£æœ‰12ä¸ªä¹‹å¤šï¼Œä½†æ— éå°±æ˜¯å¯¹å®¹å™¨çš„ä¸¤ç«¯è¿›è¡Œæ“ä½œï¼Œæˆ–æ·»åŠ ï¼Œæˆ–åˆ é™¤ï¼Œæˆ–æŸ¥çœ‹</strong>ã€‚æŒæ¡è¿™ä¸ªè§„å¾‹ï¼Œå…¶å®ç†è§£èµ·æ¥å°±ä¸éš¾äº†ã€‚</p>
<p>Deque æ¥å£æœ‰ä¸¤ä¸ªå®ç°ç±»ï¼šArrayDeque å’Œ ArrayListï¼Œè¿™ä¸¤ä¸ªå®ç°æ—¢å¯ä»¥å½“åšé˜Ÿåˆ—ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å½“åšæ ˆä½¿ç”¨ã€‚ä½†æ˜¯å®é™…ä¸Šï¼Œåœ¨é˜Ÿåˆ—å’Œæ ˆçš„åœºæ™¯ä¸­ï¼ŒArrayDeque çš„æ€§èƒ½æ˜¯è¦ä¼˜äº ArrayList çš„ï¼Œæ‰€ä»¥åœ¨è¿™äº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¼˜å…ˆä½¿ç”¨ ArrayDeque æ¯”è¾ƒå¥½ã€‚</p>
<p><em>PSï¼šæˆ‘ä¸ªäººæ²¡çœ‹å‡ºæ¥ ArrayList å®ç° Deque æ¥å£çš„ä½œç”¨ï¼Œå¯èƒ½æ˜¯å†å²åŸå› å§ã€‚</em></p>
<p>ä»åå­—ä¸Šå°±èƒ½çœ‹å¾—å‡ºæ¥ï¼ŒArrayDeque æ˜¯é€šè¿‡æ•°ç»„å®ç°çš„ï¼Œæ›´å…·ä½“æ¥è®²æ˜¯<strong>å¾ªç¯æ•°ç»„</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥æ•°ç»„ä¸Šä»»ä½•ä¸€ç‚¹éƒ½èƒ½çœ‹ä½œèµ·ç‚¹æˆ–è€…ç»ˆç‚¹ã€‚</p>
<p>åŒæ ·ï¼ŒArrayDeque ä¹Ÿæ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œå¦‚æœéœ€è¦å¹¶å‘å®‰å…¨ä¸”é«˜æ•ˆçš„é˜Ÿåˆ—ï¼Œè¿˜æ˜¯åº”è¯¥å» <code>J.U.C</code> ä¸­å»æ‰¾å¯¹åº”çš„å®ç°ã€‚å¦å¤–ï¼Œ<strong>ArrayDeque ä¸­ä¸å…è®¸æ”¾å…¥ <code>null</code>
å…ƒç´ </strong>ã€‚</p>
<p>ArrayDeque è¯¦ç»†çš„æºç è§£æï¼Œå‚è€ƒ<a href="https://github.com/CarpenterLee/JCFInternals/blob/master/markdown/4-Stack%20and%20Queue.md" target="_blank" rel="noopener noreffer ">è¿™é‡Œ</a></p>
<h5 id="priorityqueue">PriorityQueue</h5>
<p>PriorityQueue æ˜¯ Queue æ¥å£ä¸­ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„å®ç°ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯<strong>ä¼˜å…ˆé˜Ÿåˆ—</strong>ï¼Œå…¶ä½œç”¨æ˜¯èƒ½å¤Ÿä¿è¯<strong>æ¯æ¬¡å–å‡ºçš„å…ƒç´ éƒ½æ˜¯é˜Ÿåˆ—ä¸­æƒé‡å€¼æœ€å°çš„</strong>ï¼Œè¿™é‡Œç‰µæ¶‰åˆ°äº†å®¹å™¨ä¸­å…ƒç´ ä¸­çš„å¤§å°å…³ç³»ï¼Œé‚£ä¹ˆå°±éœ€è¦æ¯”è¾ƒï¼Œå…¶å¤§å°åˆ¤æ–­å¯ä»¥é€šè¿‡å…ƒç´ æœ¬èº«çš„<strong>è‡ªç„¶é¡ºåºï¼ˆnature orderingï¼‰</strong>ï¼Œä¹Ÿå¯ä»¥é€šè¿‡<strong>æ„é€ æ—¶ä¼ å…¥çš„æ¯”è¾ƒå™¨ï¼ˆComparatorï¼‰</strong>ï¼Œè¿™ä¸ªè®¾è®¡å’Œ TreeMap æ˜¯ä¸€è‡´çš„ã€‚</p>
<p>PriorityQueue ä¸­ä¸å…è®¸æ”¾å…¥ <code>null</code> å…ƒç´ ï¼Œå…¶é€šè¿‡<strong>å †ï¼ˆBinaryHeapï¼‰</strong> å®ç°ï¼Œæˆ–è€…è¯´æ˜¯é€šè¿‡å®Œå…¨äºŒå‰æ ‘ï¼ˆComplete binary treeï¼‰å®ç°çš„<strong>å°é¡¶å †</strong>ï¼ˆä»»æ„ä¸€ä¸ªéå¶å­èŠ‚ç‚¹çš„æƒå€¼ï¼Œéƒ½ä¸å¤§äºå…¶å·¦å³å­èŠ‚ç‚¹çš„æƒå€¼ï¼‰ã€‚å®é™…ä¸Šæ•°ç»„ä¹Ÿå¯ä»¥ç”¨æ¥ä½œä¸ºå®ç° PriorityQueue çš„åº•å±‚æ•°æ®ç»“æ„ã€‚</p>
<p>PriorityQueue çš„ <code>peek()</code>ã€<code>element()</code> æ“ä½œæ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ $O(1)$ï¼Œè€Œ <code>add()</code>ã€Â <code>offer()</code> å’Œæ— å‚æ•°çš„ <code>remove()</code> ä»¥åŠ <code>poll()</code> æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ $O(log\ n)$ï¼Œæ€»çš„æ¥è¯´ï¼Œæ•ˆç‡è¿˜æ˜¯éå¸¸é«˜çš„ã€‚</p>
<p>PriorityQueue è¯¦ç»†çš„æºç è§£æï¼Œå‚è€ƒ<a href="https://github.com/CarpenterLee/JCFInternals/blob/master/markdown/8-PriorityQueue.md" target="_blank" rel="noopener noreffer ">è¿™é‡Œ</a></p>
<h3 id="map">Map</h3>
<p>Map æ¥å£å¯ä»¥çœ‹ä½œæ˜¯å’Œ Collection å¹³çº§çš„å€Ÿå£ï¼Œæ˜¯ JDK ä¸­æ‰€æœ‰<strong>é”®å€¼å¯¹å®¹å™¨</strong>çš„ç¥–å…ˆæ¥å£ï¼ŒæŒ‰ç…§æ˜¯å¦ä¿æŒå®¹å™¨ä¸­å…ƒç´ çš„é¡ºåºï¼Œå¤§æ¦‚å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼š</p>
<ol>
<li>å®ç°äº† SortedMap æ¥å£çš„â€œæœ‰åº Mapâ€ï¼Œä»¥åŠä¸€ä¸ªç‰¹æ®Šçš„ EnumMap</li>
<li>æ²¡æœ‰å®ç° SortedMap æ¥å£çš„ â€œæ— åº Mapâ€</li>
</ol>
<h4 id="hashmap">HashMap</h4>
<p>HashMap æ˜¯ Map æ¥å£æœ€é‡è¦çš„å®ç°ç±»ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯æ—¥å¸¸ Java å¼€å‘ä¸­æœ€å¸¸ç”¨çš„é”®å€¼å¯¹æ•°æ®ç»“æ„ä¹‹ä¸€ã€‚å¯ä»¥æ”¾å…¥ key ä¸º null çš„å…ƒç´ ï¼Œä¹Ÿå¯ä»¥æ”¾å…¥ value ä¸º null çš„å…ƒç´ ã€‚</p>
<p>HashMap æ˜¯åŸºäº <strong>æ•£åˆ—è¡¨ï¼ˆHash Tableï¼‰</strong> æ•°æ®ç»“æ„çš„å®¹å™¨ï¼Œä½†æ˜¯æ•£åˆ—è¡¨å¿…é¡»è¦è§£å†³æ•£åˆ—å†²çªçš„é—®é¢˜ï¼Œæ•£åˆ—å†²çªç›®å‰ä¸»è¦æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼šå¼€æ”¾å¯»å€æ³•ï¼ˆopen addressingï¼‰å’Œé“¾è¡¨æ³•ï¼ˆchainingï¼‰ï¼ŒHashMap <strong>ä½¿ç”¨é“¾è¡¨æ³•è§£å†³æ•£åˆ—å†²çªé—®é¢˜</strong>ã€‚</p>
<p>ç†è®ºä¸Š HashMap çš„è¯»ã€å†™ã€åˆ é™¤çš„æ•ˆç‡éƒ½æ˜¯ $O(1)$ï¼Œéå¸¸é«˜æ•ˆï¼Œä½†æ˜¯ç”±äºæ•£åˆ—å†²çªé—®é¢˜çš„å­˜åœ¨ï¼ŒHashMap å®é™…æ€§èƒ½è¡¨ç°å¯èƒ½ä¸å¤ªç¨³å®šï¼Œè€Œä¸”ä¸ä¸€å®šèƒ½è¾¾åˆ°ç†è®ºæ•ˆç‡ã€‚</p>
<p>å½±å“ HashMap æ€§èƒ½çš„ä¸¤ä¸ªæœ€é‡è¦çš„å‚æ•°æ˜¯ï¼šåˆå§‹å®¹é‡ï¼ˆinitial capacityï¼‰å’Œè´Ÿè½½ç³»æ•°ï¼ˆload factoryï¼‰</p>
<p>åˆå§‹å®¹é‡æŒ‡å®šäº†åˆå§‹ table çš„å¤§å°ï¼Œå¤æ‚ç³»æ•°æŒ‡å®šäº† bucket è‡ªåŠ¨æ‰©å®¹çš„ä¸´ç•Œå€¼ã€‚å½“ entry çš„ä¸ªæ•°è¶…è¿‡ <code>capacity * load_factory</code> æ—¶ï¼Œå®¹å™¨å°†è‡ªåŠ¨æ‰©å®¹å¹¶é‡æ–°æ•£åˆ—ã€‚å¯¹äºæ’å…¥å…ƒç´ è¾ƒå¤šçš„ HashMapï¼Œå°†åˆå§‹å®¹é‡è®¾ç½®å¾—å¤§ä¸€äº›å¯ä»¥å‡å°‘è‡ªåŠ¨æ‰©å®¹ï¼ˆåŒ ArrayList çš„åŸç†ï¼‰å’Œé‡æ–°æ•£åˆ—çš„æ¬¡æ•°ã€‚</p>
<p>ä¸ºäº†ä¼˜åŒ– HashMap çš„å®é™…æ€§èƒ½ï¼Œå…¶å…·ä½“å®ç°åœ¨ JDK 8 å‰åæœ‰ä¸€äº›å·®åˆ«ã€‚</p>
<p>HashMap è¯¦ç»†çš„æºç è§£æï¼Œå‚è€ƒ<a href="https://pdai.tech/md/java/collection/java-map-HashMap&amp;HashSet.html" target="_blank" rel="noopener noreffer ">è¿™é‡Œ</a></p>
<h5 id="before-jdk-8">Before JDK 8</h5>
<p>åœ¨ JDK 8 ä¹‹å‰ï¼ŒHashMap åº•å±‚ç”¨æ•°æ®ç»“æ„æ˜¯<strong>æ•°ç»„+é“¾è¡¨</strong>ï¼Œç”¨æ•°ç»„åš bucketsï¼Œå®é™…æ•°æ®å­˜å‚¨åœ¨æ¯ä¸ª bucket åçš„é“¾è¡¨ä¸­ï¼Œå…¶å¤§è‡´ç»“æ„å¦‚ä¸‹ï¼š</p>
<p></p>
<p>è¿™æ˜¯éå¸¸ç»å…¸çš„æ•£åˆ—å†²çªè§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯åœ¨æ•°æ®é‡å¾ˆå¤§æˆ–è€…æ•£åˆ—ä¸å¤Ÿå‡åŒ€çš„æ—¶å€™ï¼Œå®¹æ˜“å¯¼è‡´æ•°æ®èŠ‚ç‚¹é“¾è¡¨è¿‡é•¿ï¼Œä¼šé™ä½æ•£åˆ—è¡¨çš„è¯»å–æ€§èƒ½ï¼Œè¾¾ä¸åˆ°ç†æƒ³çŠ¶æ€ä¸‹çš„ $O(1)$ æ—¶é—´å¤æ‚åº¦ï¼Œç”šè‡³æ˜¯è¾¾åˆ° $O(n)$ çº§åˆ«ã€‚</p>
<h5 id="after-jdk-8">After JDK 8</h5>
<p>åœ¨ JDK 8ï¼ˆå«ï¼‰ä¹‹åï¼ŒHashMap æœ€å¤§çš„å˜åŒ–å°±åœ¨åº•å±‚æ•°æ®ç»“æ„ä¸Šå¼•å…¥äº†<strong>çº¢é»‘æ ‘</strong>ï¼Œä¸ºäº†é™ä½æ•°æ®èŠ‚ç‚¹çš„æŸ¥è¯¢å¼€é”€ï¼Œåœ¨èŠ‚ç‚¹æ•°æ®è¾¾åˆ° 8 ä¸ªçš„æ—¶å€™ï¼Œä¼šå°†é“¾è¡¨è½¬ä¸ºçº¢é»‘æ ‘ï¼Œè¿™æ ·åœ¨èŠ‚ç‚¹æ•°æ®æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼Œæ—¶é—´å¤æ‚åº¦å¯ä»¥é™åˆ° $O(log_n)$</p>
<p>å…¶ç»“æ„ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p>
<p>
çº¢é»‘æ ‘æ˜¯ä¸€ä¸ªæ€§èƒ½éå¸¸ç¨³å®šçš„è¿‘ä¼¼å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘ï¼ˆbinary seach treeï¼‰ç»“æ„ï¼Œå½“ä¸€ä¸ªèŠ‚ç‚¹çš„æ•°æ®ç¡®å®æ¯”è¾ƒå¤šï¼ˆå¯èƒ½æ˜¯å› ä¸ºæ•£åˆ—å‡½æ•°è®¾è®¡å¾—ä¸å¥½ï¼Œä¹Ÿå¯èƒ½æ˜¯æ•°æ®é‡å®åœ¨å¤ªå¤§ï¼‰çš„æ—¶å€™ï¼Œè½¬æˆçº¢é»‘æ ‘ç»“æ„æ˜¯ä¸€ä¸ªéå¸¸é è°±çš„æå‡ HashMap æ•´ä½“æ€§èƒ½çš„æ–¹æ³•ã€‚</p>
<p>è™½ç„¶çº¢é»‘æ ‘å®ç°èµ·æ¥æ¯”é“¾è¡¨å¤æ‚çš„å¤šï¼Œä½†æ˜¯å¥½åœ¨ JDK çš„å·¥ç¨‹å¸ˆä»¬å·²ç»å¸®æˆ‘ä»¬æœ€å¥½äº†è¿™éƒ¨åˆ†çš„å·¥ä½œï¼Œæˆ‘ä»¬åªéœ€è¦å‡çº§åˆ° JDK 8ï¼Œå°±å¯ä»¥ä¸æ”¹ä¸€å¤„ä»£ç ï¼Œäº«å— HashMap çš„æ€§èƒ½æå‡ã€‚</p>
<h4 id="hashtable">HashTable</h4>
<p>HashTable åŸºæœ¬å’Œ HashMap å·®ä¸å¤šï¼Œåªæ˜¯å†…éƒ¨å„ä¸ªæ–¹æ³•ç”¨ <code>Synchronized</code> å®ç°äº†åŒæ­¥ï¼Œåœ¨å¤šçº¿ç¨‹è¯»å†™çš„æƒ…å†µä¸‹ï¼Œä¸ä¼šå‡ºç°æ•°æ®ä¸ä¸€è‡´ã€‚</p>
<p>ä½†æ˜¯ HashTable å¤šçº¿ç¨‹è¯»å†™çš„æ€§èƒ½å¹¶ä¸å¥½ï¼Œæ‰€ä»¥ï¼Œå¦‚æœç¡®å®éœ€è¦å¤šçº¿ç¨‹è¯»å†™å®‰å…¨çš„ Map å®¹å™¨ï¼Œåº”è¯¥ä½¿ç”¨ <code>J.U.C</code> æä¾›çš„ ConcurrentMap æ¥å£çš„å®ç°ç±»ï¼Œæ¯”å¦‚ ConcurrentHashMapï¼Œè€Œä¸åº”è¯¥ä½¿ç”¨ HashTableï¼ŒHashTable è¯¥é€€ä¼‘äº†ã€‚</p>
<h4 id="linkedhashmap">LinkedHashMap</h4>
<p>LinkedHashMap æ˜¯ HashMap çš„ç›´æ¥å­ç±»ï¼Œæ‰€ä»¥ key å’Œ value åŒæ ·å¯ä»¥ä¸ºç©ºã€‚çœ‹è¿™ä¸ªåå­—å¤§æ¦‚å°±èƒ½çŒœåˆ°ï¼Œè¿™æ˜¯ LinkedList å’Œ HashMap çš„ç»“åˆï¼Œ<strong>å¯ä»¥å°† LinkedHashMap çœ‹ä½œæ˜¯ç”¨ LinkedList å¼ºåŒ–è¿‡çš„ HashMap</strong>ã€‚å¦‚ä¸‹æ˜¯ LinkedHashMap çš„ç»“æ„å›¾ï¼š</p>
<p></p>
<p>ä»å›¾ä¸Šèƒ½çœ‹å‡ºæ¥ï¼ŒLinkedHashMap å’Œ HashMap ä¸»ä½“ç»“æ„ä¸Šå®Œå…¨ä¸€è‡´ï¼ŒåŒºåˆ«åœ¨äº <strong>LinkedHashMap ä½¿ç”¨åŒå‘é“¾è¡¨å®ç°äº†å†²çªé“¾è¡¨ï¼Œå¹¶ä¸”è¿™ä¸ªåŒå‘é“¾è¡¨å°†æ‰€æœ‰çš„ entry éƒ½è¿äº†èµ·æ¥</strong>ï¼Œè¿™æ ·åšç›¸æ¯” HashMap æœ‰ä¸¤ä¸ªé¢å¤–çš„å¥½å¤„ï¼š</p>
<ol>
<li>å¯ä»¥ä¿è¯å…ƒç´ çš„è¿­ä»£é¡ºåºå’Œæ’å…¥é¡ºåºç›¸åŒã€‚</li>
<li>è¿­ä»£æ•´ä¸ª Map çš„æ—¶å€™ï¼Œä¸éœ€è¦åƒ HashMap é‚£æ ·è¿­ä»£æ•´ä¸ª tableï¼Œè€Œæ˜¯åªéœ€è¦éå† header æŒ‡å‘çš„åŒå‘é“¾è¡¨å³å¯ï¼Œä¹Ÿå°±æ˜¯ LinkedHashMap çš„è¿­ä»£æ—¶é—´å’Œ Table çš„å¤§å°æ— å…³ï¼Œè€Œæ˜¯åªä¸å®é™…ä¸Š entry çš„æ•°é‡æœ‰å…³ã€‚</li>
</ol>
<p>ç”±äºä¸»ä½“ç»“æ„å’Œ HashMap ä¸€æ ·ï¼Œæ‰€ä»¥å½±å“ LinkedHashMap æ€§èƒ½çš„ä¹Ÿæ˜¯åˆå§‹å®¹é‡ï¼ˆinitial capacityï¼‰å’Œè´Ÿè½½ç³»æ•°ï¼ŒåŸå› ä¹Ÿå’Œ HashMap ä¸€æ ·ã€‚</p>
<p>LinkedHashMap é™¤äº†ä¿è¯è¿­ä»£é¡ºåºä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ç”¨æ³•ï¼š<strong>è½»æ¾å®ç°ä¸€ä¸ªå…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰ç­–ç•¥çš„ç¼“å­˜ç»“æ„</strong>ï¼Œæ³¨æ„ï¼Œæ˜¯ç¼“å­˜ï¼Œä¸æ˜¯é˜Ÿåˆ—ã€‚</p>
<p>LinkedHashMap æœ‰ä¸€ä¸ª HashMap ä¸­æ²¡æœ‰çš„å­ç±»æ–¹æ³•ï¼š<code>boolean removeEldestEntry(Map.Entry&lt;K,V&gt; eldest)</code>ï¼Œè¯¥æ–¹æ³•çš„ä½œç”¨æ˜¯å‘Šè¯‰ Map æ˜¯å¦è¦åˆ é™¤â€œæœ€è€â€çš„ Entryï¼Œæ‰€è°“æœ€è€å°±æ˜¯å½“å‰ Map ä¸­æœ€æ—©æ’å…¥çš„ Entryï¼Œå¦‚æœè¯¥æ–¹æ³•è¿”å› <code>true</code>ï¼Œæœ€è€çš„é‚£ä¸ªå…ƒç´ å°±ä¼šè¢«åˆ é™¤ã€‚è€Œä¸”åœ¨æ¯æ¬¡æ’å…¥æ–°å…ƒç´ çš„ä¹‹åLinkedHashMap ä¼šè‡ªåŠ¨è¯¢é—® <code>removeEldestEntry()</code> æ˜¯å¦è¦åˆ é™¤æœ€è€çš„å…ƒç´ ã€‚è¿™æ ·åªéœ€è¦åœ¨å­ç±»ä¸­é‡è½½è¯¥æ–¹æ³•ï¼Œå½“å…ƒç´ ä¸ªæ•°è¶…è¿‡ä¸€å®šæ•°é‡æ—¶è®©<code>removeEldestEntry()</code> è¿”å› trueï¼Œå°±èƒ½å¤Ÿå®ç°ä¸€ä¸ªå›ºå®šå¤§å°çš„FIFOç­–ç•¥çš„ç¼“å­˜ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/** ä¸€ä¸ªå›ºå®šå¤§å°çš„ FIFO æ›¿æ¢ç­–ç•¥çš„ç¼“å­˜ */</span>
</span></span><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">FIFOCache</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span> <span class="n">V</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">LinkedHashMap</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span> <span class="n">V</span><span class="o">&gt;{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">cacheSize</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="nf">FIFOCache</span><span class="o">(</span><span class="kt">int</span> <span class="n">cacheSize</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">.</span><span class="na">cacheSize</span> <span class="o">=</span> <span class="n">cacheSize</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// å½“ Entry ä¸ªæ•°è¶…è¿‡ cacheSize æ—¶ï¼Œåˆ é™¤æœ€è€çš„ Entry
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kt">boolean</span> <span class="nf">removeEldestEntry</span><span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">eldest</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="n">size</span><span class="o">()</span> <span class="o">&gt;</span> <span class="n">cacheSize</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>LinkedHashMap æ›´åŠ è¯¦ç»†çš„æºç è§£æï¼Œå‚è€ƒ <a href="https://github.com/CarpenterLee/JCFInternals/blob/master/markdown/7-LinkedHashSet%20and%20LinkedHashMap.md" target="_blank" rel="noopener noreffer ">è¿™é‡Œ</a></p>
<h4 id="treemap">TreeMap</h4>
<p>TreeMap å®ç°äº† SortedMap æ¥å£ï¼Œæ„å‘³ç€å®¹å™¨å†…éƒ¨ä¼šæŒ‰ç…§ key çš„å¤§å°å¯¹ Map ä¸­çš„å…ƒç´ è¿›è¡Œæ’åºï¼Œè€Œ key å¤§å°çš„åˆ¤æ–­ï¼Œæ—¢å¯ä»¥é€šè¿‡å…¶è‡ªèº«çš„è‡ªç„¶é¡ºåºï¼ˆnatural orderingï¼‰ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ„é€ æ—¶ä¼ å…¥çš„æ¯”è¾ƒå™¨ Comparatorã€‚</p>
<p><strong>TreeMap åº•å±‚ä½¿ç”¨çº¢é»‘æ ‘ï¼ˆRed-Black Treeï¼‰å®ç°</strong>ï¼Œè¿™æ„å‘³ç€å…¶è¯»å–ã€æ’å…¥å’Œåˆ é™¤çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ $O(log_n)$ï¼Œè€Œä¸”å¾—ç›Šäºçº¢é»‘æ ‘ç‹¬ç‰¹çš„ç»“æ„ï¼ŒTreeMap çš„æ€§èƒ½ç¨³å®šæ€§ä¹Ÿå¾ˆå¥½ã€‚å…¶ç»“æ„å¤§è‡´å¦‚ä¸‹å›¾ï¼š</p>
<p></p>
<p>å‡ºäºæ€§èƒ½åŸå› ï¼ŒTreeMap æ˜¯éåŒæ­¥çš„ï¼Œè¿™æ„å‘³ç€å®ƒä¸èƒ½åœ¨å¤šçº¿ç¨‹è¯»å†™æƒ…å†µä¸‹ä½¿ç”¨ï¼Œå¦‚æœéœ€è¦â€œå¤šçº¿ç¨‹å®‰å…¨çš„ TreeMapâ€ï¼Œå¯ä»¥ç”¨ <code>Collections.synchronizedSortedMap</code> åšå¦‚ä¸‹åŒ…è£…ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">SortedMap</span> <span class="n">m</span> <span class="o">=</span> <span class="n">Collections</span><span class="o">.</span><span class="na">synchronizedSortedMap</span><span class="o">(</span><span class="k">new</span> <span class="n">TreeMap</span><span class="o">(...));</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åŒæ ·è¿˜æ˜¯ç”±äº <code>Synchronized</code> æœ¬èº«æ€§èƒ½å¼€é”€è¾ƒå¤§ï¼Œä¸å»ºè®®ä½¿ç”¨è¿™ç§æ–¹å¼ã€‚æ‰€ä»¥ï¼Œå¦‚æœæœ‰è¿™æ ·çš„éœ€æ±‚ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ <code>J.U.C</code> åŒ…ä¸­æä¾›çš„ <code>ConcurrentSkipListMap</code> å®ç°ã€‚</p>
<p>å¦‚ä¸Š HashMap ä¸­æ‰€è¿°ï¼Œçº¢é»‘æ ‘æœ¬èº«çš„å®ç°å’Œæ“ä½œæ¯”è¾ƒå¤æ‚ï¼Œæ¶‰åŠåˆ°å„ç§å·¦æ—‹å³æ—‹å’Œé¢œè‰²è°ƒæ•´ï¼Œè¯¦ç»†æºç åˆ†æå‚è€ƒ<a href="https://pdai.tech/md/java/collection/java-map-TreeMap&amp;TreeSet.html" target="_blank" rel="noopener noreffer ">è¿™é‡Œ</a></p>
<h4 id="enummap">EnumMap</h4>
<p>EnumMap æ˜¯ä¸€ä¸ªæœ‰ç‚¹ç‰¹åˆ«çš„ Map æ¥å£å®ç°ç±»ï¼Œä»–æ˜¯ä¸€ä¸ªé’ˆå¯¹æšä¸¾ï¼ˆenumï¼‰ç±»å‹ key ä¼˜åŒ–è¿‡çš„ Mapï¼Œåœ¨è¦å­˜å‚¨çš„é”®å€¼å¯¹æ‰€æœ‰çš„ key éƒ½æ˜¯ enum ç±»å‹çš„æ—¶å€™ï¼Œä½¿ç”¨ EnumMap ä¼šæ¯” HashMap æ›´é«˜æ•ˆã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ HashMap æ˜¯é€šè¿‡æ•£åˆ—å‡½æ•°è®¡ç®— key çš„å€¼ï¼Œç„¶åå‚¨å­˜åˆ°æ•°ç»„ä¸­ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­å°±ä¼šäº§ç”Ÿä¸¤ä¸ªå¯èƒ½ä¼šå½±å“æ€§èƒ½çš„ç‚¹ï¼šæ•£åˆ—å‡½æ•°æ€§èƒ½å’Œæ•£åˆ—å†²çªçš„è§£å†³ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬è¦å­˜å‚¨çš„æ•°æ®çš„ key éƒ½æ˜¯ enum ç±»å‹çš„è¯ï¼Œç¼–è¯‘å™¨ä¼šä¸ºæ¯ä¸ªæšä¸¾ç±»å‹ç”Ÿæˆçš„å¸¸é‡åºåˆ—å·ï¼Œä¹Ÿå°±æ˜¯ <code>ordinal</code>ï¼Œè¿™ä¸ªå€¼æ˜¯ä¸ä¼šå†²çªçš„ï¼Œé‚£ä¹ˆå°±åªéœ€è¦å°†è¿™ä¸ªå€¼è®¾ç½®ä¸ºæ•°ç»„çš„ä¸‹æ ‡å°±å¯ä»¥äº†ï¼Œè¿™æ ·ä¸€æ¥å°±å¯ä»¥ç›´æ¥é¿å…ä½¿ç”¨æ•£åˆ—å‡½æ•°ï¼Œå°±å¯ä»¥å¤§å¹…æé«˜è¯»å†™æ€§èƒ½ï¼Œè¯»ã€å†™ã€åˆ é™¤çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ $O(1)$</p>
<p>æ‰€ä»¥ï¼Œå¦‚æœè¦å­˜å‚¨åˆ° Map ä¸­çš„çš„æ•°æ® key éƒ½æ˜¯ enum ç±»å‹ï¼Œå»ºè®®ä½¿ç”¨ EnumMap ä»£æ›¿ HashMapï¼Œå¯ä»¥æœ‰æ•ˆæé«˜ç»¼åˆæ€§èƒ½ã€‚</p>
<h4 id="weakhashmap">WeakHashMap</h4>
<p>å¦‚æœè¯´ EnumMap æ˜¯ä¸ªæœ‰ç‚¹ç‰¹åˆ«çš„ Mapï¼Œé‚£ä¹ˆ WeekHashMap å°±æ˜¯ååˆ†ç‰¹åˆ«çš„ Mapã€‚å®ƒçš„ç‰¹åˆ«ä¹‹å¤„åœ¨äº WeekHashMap ä¸­çš„å…ƒç´ ï¼ˆentryï¼‰å¯èƒ½éšæ—¶è¢« GC è‡ªåŠ¨åˆ é™¤ï¼Œå³ä¾¿æˆ‘ä»¬æ²¡æœ‰æ‰‹åŠ¨çš„è°ƒç”¨ <code>remove()</code> æˆ–è€… <code>clear()</code> å‡½æ•°ã€‚</p>
<p>æ›´ç›´è§‚çš„æ¥è¯´ï¼Œå³ä¾¿æˆ‘ä»¬æ²¡æœ‰æ˜¾ç¤ºçš„åˆ é™¤å…¶ä¸­çš„å…ƒç´ ï¼Œä¹Ÿæœ‰å¯èƒ½éšæ—¶å‘ç”Ÿå¦‚ä¸‹çš„æƒ…å†µï¼š</p>
<ul>
<li>è°ƒç”¨ä¸¤æ¬¡<code>size()</code>æ–¹æ³•è¿”å›ä¸åŒçš„å€¼ï¼›</li>
<li>ä¸¤æ¬¡è°ƒç”¨<code>isEmpty()</code>æ–¹æ³•ï¼Œç¬¬ä¸€æ¬¡è¿”å›<code>false</code>ï¼Œç¬¬äºŒæ¬¡è¿”å›<code>true</code>ï¼›</li>
<li>ä¸¤æ¬¡è°ƒç”¨<code>containsKey()</code>æ–¹æ³•ï¼Œç¬¬ä¸€æ¬¡è¿”å›<code>true</code>ï¼Œç¬¬äºŒæ¬¡è¿”å›<code>false</code>ï¼Œå°½ç®¡ä¸¤æ¬¡ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ª<code>key</code>ï¼›</li>
<li>ä¸¤æ¬¡è°ƒç”¨<code>get()</code>æ–¹æ³•ï¼Œç¬¬ä¸€æ¬¡è¿”å›ä¸€ä¸ª<code>value</code>ï¼Œç¬¬äºŒæ¬¡è¿”å›<code>null</code>ï¼Œå°½ç®¡ä¸¤æ¬¡ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚</li>
</ul>
<p>ç¨‹åºå‘˜æœ€æ€•çš„å°±æ˜¯ä¸å¯æ§ï¼Œè€Œè¿™ä¸ª WeekHashMap ä¼¼ä¹éå¸¸ç–¯ç‹‚ï¼Œç®€ç›´ä¸çŸ¥é“æŠŠæ•°æ®å­˜è¿›å»ä¹‹åä¼šå‘ç”Ÿä»€ä¹ˆï¼</p>
<p>å…¶å®è¿™ä¸ªç‰¹ç‚¹éå¸¸é€‚åˆä¸€ç§åœºæ™¯ï¼š<strong>ç¼“å­˜</strong>ã€‚</p>
<p>åœ¨ç¼“å­˜çš„åœºæ™¯ä¸‹ï¼Œå¯æ§ç¼“å­˜ä½¿ç”¨çš„å†…å­˜æ˜¯æœ‰é™çš„ï¼Œä¸å¯èƒ½ç¼“å­˜æ‰€æœ‰æ•°æ®ï¼›ç¼“å­˜å‘½ä¸­äº†å¯ä»¥æé«˜ç³»ç»Ÿæ•ˆç‡ï¼›ä½†æ˜¯ä¸å‘½ä¸­ä¹Ÿä¸ä¼šé€ æˆé”™è¯¯ï¼Œæ‰€ä»¥ WeekHashMap å…¶å®æ˜¯ä¸€ä¸ªå¤©ç„¶çš„æœ€å°‘ä½¿ç”¨ç­–ç•¥ LUFï¼ˆLeast Frequently Usedï¼‰çš„ç¼“å­˜å®¹å™¨ã€‚</p>
<p>è¦æ˜ç™½ WeekHashMap çš„å·¥ä½œåŸç†ï¼Œå…ˆè¦äº†è§£<strong>å¼±å¼•ç”¨</strong>è¿™ä¸ªæ¦‚å¿µã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ Java ç¨‹åºä¸­çš„å†…å­˜æ˜¯é€šè¿‡ GC è‡ªåŠ¨ç®¡ç†çš„ï¼ŒGC åœ¨ç¨‹åºè¿è¡Œçš„è¿‡ç¨‹ä¸­ä¼šé€šè¿‡ä¸€ç³»åˆ—éå¸¸å¤æ‚çš„æœºåˆ¶è‡ªåŠ¨åˆ¤æ–­å“ªäº›å¯¹è±¡éœ€è¦è¢«å›æ”¶ï¼Œå¹¶é‡Šæ”¾å¯¹åº”çš„å†…å­˜ç©ºé—´ã€‚è€Œ GC åˆ¤æ–­æŸä¸ªå¯¹è±¡æ˜¯å¦åº”è¯¥è¢«å›æ”¶çš„ä¸€ä¸ªä¾æ®æ˜¯ï¼š<strong>æ˜¯å¦æœ‰æœ‰æ•ˆçš„å¼•ç”¨æŒ‡å‘è¯¥å¯¹è±¡</strong>ï¼Œå› ä¸º Java ä¸­æ˜¯é€šè¿‡å¼•ç”¨è®¿é—®æ‰€æœ‰å¯¹è±¡çš„ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡æ²¡æœ‰å¯¹åº”æŸä¸ªæœ‰æ•ˆçš„å¼•ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡å°±æ— æ³•è¢«ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±åº”è¯¥è¢«å›æ”¶ã€‚è¿™é‡Œçš„<strong>æœ‰æ•ˆå¼•ç”¨</strong>ä¸åŒ…æ‹¬<strong>å¼±å¼•ç”¨</strong>ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¼±å¼•ç”¨ç¡®å®å¯ä»¥ç”¨æ¥è®¿é—®å¯¹è±¡ï¼Œä½†æ˜¯ä»…æœ‰å¼±å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡åœ¨åƒåœ¾å›æ”¶æ—¶å¹¶ä¸ä¼šè¢« GC è€ƒè™‘åœ¨å†…ã€‚å¥½æ¯”è¯´ï¼Œä½ æŠŠä¸œè¥¿æ”¾åœ¨å°åŒºçš„åƒåœ¾æ¡¶é‡Œï¼Œä½ ç¡®å®å¯ä»¥åœ¨åƒåœ¾æ¡¶é‡Œæ‰¾åˆ°ä½ æ”¾è¿›å»çš„ä¸œè¥¿ï¼Œä½†æ˜¯åƒåœ¾è½¦æ¥æ”¶åƒåœ¾çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šè€ƒè™‘ä½ æ”¾åœ¨åƒåœ¾æ¡¶é‡Œçš„ä¸œè¥¿ï¼Œä»–ä¼šè¿åŒåƒåœ¾ä¸€å¹¶æ”¶èµ°ã€‚</p>
<p>WeekHashMap å†…éƒ¨å°±æ˜¯é€šè¿‡å¼±å¼•ç”¨æ¥ç®¡ç† entry çš„ï¼Œè¿™æ„å‘³ç€å°†ä¸€å¯¹ key-value å¯¹è±¡æ”¾è¿› WeekHashMap ä¹‹åï¼Œä»–å°±æœ‰å¯èƒ½éšæ—¶è¢« GC å›æ”¶ï¼Œé™¤éè¯¥å¯¹è±¡åœ¨ WeekHashMap ä¹‹å¤–è¿˜æœ‰å¼ºå¼•ç”¨ã€‚</p>
<p>å…³äºå¼ºå¼•ç”¨ã€å¼±å¼•ç”¨ä»¥åŠå…¶ä»–çš„ Java å¼•ç”¨ç±»å‹ï¼Œå¯ä»¥å‚è€ƒ <a href="https://pdai.tech/md/java/jvm/java-jvm-gc.html#%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B" target="_blank" rel="noopener noreffer ">è¿™é‡Œ</a></p>
<p>é™¤äº†è¿™ä¸ªç‰¹æ®Šçš„ç®¡ç† entry çš„æ–¹å¼ï¼Œå…¶ä»–æ–¹é¢ WeekHashMap å’Œ HashMap æ²¡æœ‰ä»€ä¹ˆå¤§çš„åŒºåˆ«ï¼Œå…¶å…·ä½“å®ç°å¯ä»¥å‚è€ƒå‰æ–‡çš„ HashMapã€‚</p>
<h2 id="concurrent-collections">Concurrent Collections</h2>
<p><code>J.U.C</code> åŒ…çš„å‡ºç°ç»™ Java å¹¶å‘ç¼–ç¨‹æ•ˆç‡å¸¦æ¥äº†å·¨å¤§çš„æå‡ï¼Œå…¶ä¸­å°±æä¾›äº†ä¸å°‘åœ¨å¹¶å‘æƒ…å†µä¸‹æ—¢ä¿è¯æ•°æ®å®‰å…¨ï¼Œåˆä¿è¯æ•ˆç‡çš„é›†åˆï¼Œè®©å¤è€çš„ <code>Vector</code> å’Œ <code>HashTable</code> ç›´æ¥é€€ä¼‘ï¼</p>
<p>å®¹æˆ‘å…ˆå­¦å­¦å†æ¥æ›´æ–° :)</p>
<blockquote>
<p>æœ¬æ–‡ä¸»è¦å‚è€ƒ <a href="https://pdai.tech/md/java/collection/java-collection-all.html" target="_blank" rel="noopener noreffer ">Java å…¨æ ˆçŸ¥è¯†ä½“ç³» - Javaé›†åˆæ¡†æ¶</a> å’Œ <a href="https://docs.oracle.com/javase/8/docs/technotes/guides/collections/overview.html" target="_blank" rel="noopener noreffer ">Oracle Java Docs - Collections Framework Overview</a></p>
</blockquote>
]]></description>
</item>
<item>
    <title>Clickhouse äº¿çº§æ•°æ®æ€§èƒ½æµ‹è¯•</title>
    <link>https://asimov.top/clickhouse-billion-level-data-performance-test/</link>
    <pubDate>Tue, 16 Mar 2021 21:35:39 &#43;0800</pubDate>
    <author>asimov</author>
    <guid>https://asimov.top/clickhouse-billion-level-data-performance-test/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="https://img.lifelog.cool/Using%20ClickHouse%20with%20MetricFire_waifu2x_art_noise3_scale.webp" referrerpolicy="no-referrer">
            </div><p>Clickhouse åœ¨ç¦»çº¿æ•°æ®åˆ†ææŠ€æœ¯é¢†åŸŸæ—©å·²å£°åè¿œæ‰¬ï¼Œå¦‚æœè¿˜ä¸çŸ¥é“å¯ä»¥ <a href="https://clickhouse.tech/docs/zh/" target="_blank" rel="noopener noreffer ">ç‚¹è¿™é‡Œ</a> äº†è§£ä¸‹ã€‚</p>
<p>æœ€è¿‘ç”±äºé¡¹ç›®éœ€æ±‚ä½¿ç”¨åˆ°äº† clickhouse åšåˆ†ææ•°æ®åº“ï¼Œäºæ˜¯ç”¨æµ‹è¯•ç¯å¢ƒåšäº†ä¸€ä¸ªå•è¡¨ 6 äº¿æ•°æ®é‡çš„æ€§èƒ½æµ‹è¯•ï¼Œè®°å½•ä¸€ä¸‹æµ‹è¯•ç»“æœï¼Œæœ‰åšè¶…å¤§æ•°æ®é‡åˆ†ææŠ€æœ¯é€‰å‹éœ€æ±‚çš„æœ‹å‹å¯ä»¥å‚è€ƒä¸‹ã€‚</p>
<h2 id="æœåŠ¡å™¨ä¿¡æ¯">æœåŠ¡å™¨ä¿¡æ¯</h2>
<ul>
<li>CPUï¼šIntel Xeon Gold 6240 @ 8x 2.594GHz</li>
<li>å†…å­˜ï¼š32G</li>
<li>ç³»ç»Ÿï¼šCentOS 7.6</li>
<li>Linuxå†…æ ¸ç‰ˆæœ¬ï¼š3.10.0</li>
<li>ç£ç›˜ç±»å‹ï¼šæœºæ¢°ç¡¬ç›˜</li>
<li>æ–‡ä»¶ç³»ç»Ÿï¼šext4</li>
</ul>
<h2 id="clickhouse-ä¿¡æ¯">Clickhouse ä¿¡æ¯</h2>
<ul>
<li>éƒ¨ç½²æ–¹å¼ï¼šå•æœºéƒ¨ç½²</li>
<li>ç‰ˆæœ¬ï¼š20.8.11.17</li>
</ul>
<h2 id="æµ‹è¯•æƒ…å†µ">æµ‹è¯•æƒ…å†µ</h2>
<blockquote>
<p>æµ‹è¯•æ•°æ®å’Œæµ‹è¯•æ–¹æ³•æ¥è‡ª clickshouse å®˜æ–¹çš„ <a href="https://clickhouse.tech/docs/en/getting-started/example-datasets/star-schema/" target="_blank" rel="noopener noreffer ">Star Schema Benchmark</a></p>
</blockquote>
<p>æŒ‰ç…§å®˜æ–¹æŒ‡å¯¼é€ å‡ºäº†æµ‹è¯•æ•°æ®ä¹‹åï¼Œå…ˆçœ‹ä¸€ä¸‹æ•°æ®é‡å’Œç©ºé—´å ç”¨æƒ…å†µã€‚</p>
<h3 id="æ•°æ®é‡å’Œç©ºé—´å ç”¨">æ•°æ®é‡å’Œç©ºé—´å ç”¨</h3>
<table>
<thead>
<tr>
<th>è¡¨å</th>
<th>åˆ—æ•°</th>
<th>æ•°æ®è¡Œæ•°</th>
<th>åŸå§‹å¤§å°</th>
<th>å‹ç¼©å¤§å°</th>
<th>å‹ç¼©ç‡</th>
</tr>
</thead>
<tbody>
<tr>
<td>supplier</td>
<td>6</td>
<td>200,000</td>
<td>11.07 MiB</td>
<td>7.53 MiB</td>
<td>68</td>
</tr>
<tr>
<td>customer</td>
<td>7</td>
<td>3,000,000</td>
<td>168.83 MiB</td>
<td>114.72 MiB</td>
<td>68</td>
</tr>
<tr>
<td>part</td>
<td>8</td>
<td>1,400,000</td>
<td>34.29 MiB</td>
<td>24.08 MiB</td>
<td>70</td>
</tr>
<tr>
<td>lineorder</td>
<td>16</td>
<td>600,037,902</td>
<td>24.03 GiB</td>
<td>16.67 GiB</td>
<td>69</td>
</tr>
<tr>
<td>lineorder_flat</td>
<td>37</td>
<td>688,552,212</td>
<td>111.38 GiB</td>
<td>61.05 GiB</td>
<td>55</td>
</tr>
</tbody>
</table>
<p>å¯ä»¥çœ‹åˆ° clickhouse çš„å‹ç¼©ç‡å¾ˆé«˜ï¼Œå‹ç¼©ç‡éƒ½åœ¨ 50 ä»¥ä¸Šï¼ŒåŸºæœ¬å¯ä»¥è¾¾åˆ° 70 å·¦å³ã€‚<strong>æ•°æ®ä½“ç§¯çš„å‡å°å¯ä»¥éå¸¸æœ‰æ•ˆçš„å‡å°‘ç£ç›˜ç©ºé—´å ç”¨ã€æé«˜ I/O æ€§èƒ½ï¼Œè¿™å¯¹æ•´ä½“æŸ¥è¯¢æ€§èƒ½çš„æå‡éå¸¸æœ‰æ•ˆã€‚</strong></p>
<p>supplierã€customerã€partã€lineorder ä¸ºä¸€ä¸ªç®€å•çš„ã€Œä¾›åº”å•†-å®¢æˆ·-è®¢å•-åœ°åŒºã€çš„æ˜Ÿå‹æ¨¡å‹ï¼Œlineorder_flat ä¸ºæ ¹æ®è¿™ä¸ªæ˜Ÿå‹æ¨¡å‹æ•°æ®å…³ç³»åˆå¹¶çš„å¤§å®½è¡¨ï¼Œæ‰€æœ‰åˆ†æéƒ½ç›´æ¥åœ¨è¿™å¼ å¤§å®½è¡¨ä¸­æ‰§è¡Œï¼Œå‡å°‘ä¸å¿…è¦çš„è¡¨å…³è”ï¼Œç¬¦åˆæˆ‘ä»¬å®é™…å·¥ä½œä¸­çš„åˆ†æå»ºè¡¨é€»è¾‘ã€‚</p>
<p>ä»¥ä¸‹æ€§èƒ½æµ‹è¯•çš„æ‰€æœ‰åˆ†æ SQL éƒ½åœ¨è¿™å¼ å¤§å®½è¡¨ä¸­è¿è¡Œï¼Œæœªè¿›è¡Œè¡¨å…³è”æŸ¥è¯¢ã€‚</p>
<h3 id="æŸ¥è¯¢æ€§èƒ½æµ‹è¯•è¯¦æƒ…">æŸ¥è¯¢æ€§èƒ½æµ‹è¯•è¯¦æƒ…</h3>
<h4 id="query-11">Query 1.1</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">LO_EXTENDEDPRICE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">LO_DISCOUNT</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">revenue</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">lineorder_flat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="p">(</span><span class="n">toYear</span><span class="p">(</span><span class="n">LO_ORDERDATE</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1993</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">((</span><span class="n">LO_DISCOUNT</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">LO_DISCOUNT</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">LO_QUANTITY</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">25</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€</span><span class="n">revenue</span><span class="err">â”€â”</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="mi">44652567249651</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">1</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="p">.</span><span class="w"> </span><span class="n">Elapsed</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">242</span><span class="w"> </span><span class="n">sec</span><span class="p">.</span><span class="w"> </span><span class="n">Processed</span><span class="w"> </span><span class="mi">91</span><span class="p">.</span><span class="mi">01</span><span class="w"> </span><span class="n">million</span><span class="w"> </span><span class="k">rows</span><span class="p">,</span><span class="w"> </span><span class="mi">728</span><span class="p">.</span><span class="mi">06</span><span class="w"> </span><span class="n">MB</span><span class="w"> </span><span class="p">(</span><span class="mi">375</span><span class="p">.</span><span class="mi">91</span><span class="w"> </span><span class="n">million</span><span class="w"> </span><span class="k">rows</span><span class="o">/</span><span class="n">s</span><span class="p">.,</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">01</span><span class="w"> </span><span class="n">GB</span><span class="o">/</span><span class="n">s</span><span class="p">.)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>æ‰«æè¡Œæ•°ï¼š91,010,000</strong> <em>å¤§çº¦9100ä¸‡</em></p>
<p><strong>è€—æ—¶(ç§’)ï¼š0.242</strong></p>
<p><strong>æŸ¥è¯¢åˆ—æ•°ï¼š2</strong></p>
<p><strong>ç»“æœè¡Œæ•°ï¼š1</strong></p>
<h4 id="query-12">Query 1.2</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">LO_EXTENDEDPRICE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">LO_DISCOUNT</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">revenue</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">lineorder_flat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="p">(</span><span class="n">toYYYYMM</span><span class="p">(</span><span class="n">LO_ORDERDATE</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">199401</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">((</span><span class="n">LO_DISCOUNT</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">LO_DISCOUNT</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">6</span><span class="p">))</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">((</span><span class="n">LO_QUANTITY</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">26</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">LO_QUANTITY</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">35</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”Œâ”€â”€â”€â”€â”€â”€â”€</span><span class="n">revenue</span><span class="err">â”€â”</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="mi">9624332170119</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">1</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="p">.</span><span class="w"> </span><span class="n">Elapsed</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">040</span><span class="w"> </span><span class="n">sec</span><span class="p">.</span><span class="w"> </span><span class="n">Processed</span><span class="w"> </span><span class="mi">7</span><span class="p">.</span><span class="mi">75</span><span class="w"> </span><span class="n">million</span><span class="w"> </span><span class="k">rows</span><span class="p">,</span><span class="w"> </span><span class="mi">61</span><span class="p">.</span><span class="mi">96</span><span class="w"> </span><span class="n">MB</span><span class="w"> </span><span class="p">(</span><span class="mi">191</span><span class="p">.</span><span class="mi">44</span><span class="w"> </span><span class="n">million</span><span class="w"> </span><span class="k">rows</span><span class="o">/</span><span class="n">s</span><span class="p">.,</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">53</span><span class="w"> </span><span class="n">GB</span><span class="o">/</span><span class="n">s</span><span class="p">.)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>æ‰«æè¡Œæ•°ï¼š7,750,000</strong> <em>775ä¸‡</em></p>
<p><strong>è€—æ—¶(ç§’)ï¼š0.040</strong></p>
<p><strong>æŸ¥è¯¢åˆ—æ•°ï¼š2</strong></p>
<p><strong>è¿”å›è¡Œæ•°ï¼š1</strong></p>
<h4 id="query-21">Query 2.1</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">sum</span><span class="p">(</span><span class="n">LO_REVENUE</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">toYear</span><span class="p">(</span><span class="n">LO_ORDERDATE</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">year</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">P_BRAND</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">lineorder_flat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="p">(</span><span class="n">P_CATEGORY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;MFGR#12&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">S_REGION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;AMERICA&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">year</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">P_BRAND</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">year</span><span class="w"> </span><span class="k">ASC</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">P_BRAND</span><span class="w"> </span><span class="k">ASC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”Œâ”€</span><span class="k">sum</span><span class="p">(</span><span class="n">LO_REVENUE</span><span class="p">)</span><span class="err">â”€â”¬â”€</span><span class="k">year</span><span class="err">â”€â”¬â”€</span><span class="n">P_BRAND</span><span class="err">â”€â”€â”€â”</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w">     </span><span class="mi">64420005618</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1992</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">MFGR</span><span class="o">#</span><span class="mi">121</span><span class="w">  </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w">     </span><span class="mi">63389346096</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1992</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">MFGR</span><span class="o">#</span><span class="mi">1210</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w">     </span><span class="p">...........</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="p">..........</span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w">     </span><span class="mi">39679892915</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1998</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">MFGR</span><span class="o">#</span><span class="mi">128</span><span class="w">  </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w">     </span><span class="mi">35300513083</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1998</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">MFGR</span><span class="o">#</span><span class="mi">129</span><span class="w">  </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">280</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="p">.</span><span class="w"> </span><span class="n">Elapsed</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">.</span><span class="mi">558</span><span class="w"> </span><span class="n">sec</span><span class="p">.</span><span class="w"> </span><span class="n">Processed</span><span class="w"> </span><span class="mi">600</span><span class="p">.</span><span class="mi">04</span><span class="w"> </span><span class="n">million</span><span class="w"> </span><span class="k">rows</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">.</span><span class="mi">20</span><span class="w"> </span><span class="n">GB</span><span class="w"> </span><span class="p">(</span><span class="mi">70</span><span class="p">.</span><span class="mi">11</span><span class="w"> </span><span class="n">million</span><span class="w"> </span><span class="k">rows</span><span class="o">/</span><span class="n">s</span><span class="p">.,</span><span class="w"> </span><span class="mi">725</span><span class="p">.</span><span class="mi">04</span><span class="w"> </span><span class="n">MB</span><span class="o">/</span><span class="n">s</span><span class="p">.)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>æ‰«æè¡Œæ•°ï¼š600,040,000</strong> <em>å¤§çº¦6äº¿</em></p>
<p><strong>è€—æ—¶(ç§’)ï¼š8.558</strong></p>
<p><strong>æŸ¥è¯¢åˆ—æ•°ï¼š3</strong></p>
<p><strong>ç»“æœè¡Œæ•°ï¼š280</strong></p>
<h4 id="query-22">Query 2.2</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">sum</span><span class="p">(</span><span class="n">LO_REVENUE</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">toYear</span><span class="p">(</span><span class="n">LO_ORDERDATE</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">year</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">P_BRAND</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">lineorder_flat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="p">((</span><span class="n">P_BRAND</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="s1">&#39;MFGR#2221&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">P_BRAND</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s1">&#39;MFGR#2228&#39;</span><span class="p">))</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">S_REGION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ASIA&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">year</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">P_BRAND</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">year</span><span class="w"> </span><span class="k">ASC</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">P_BRAND</span><span class="w"> </span><span class="k">ASC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”Œâ”€</span><span class="k">sum</span><span class="p">(</span><span class="n">LO_REVENUE</span><span class="p">)</span><span class="err">â”€â”¬â”€</span><span class="k">year</span><span class="err">â”€â”¬â”€</span><span class="n">P_BRAND</span><span class="err">â”€â”€â”€â”</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w">     </span><span class="mi">66450349438</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1992</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">MFGR</span><span class="o">#</span><span class="mi">2221</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w">     </span><span class="mi">65423264312</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1992</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">MFGR</span><span class="o">#</span><span class="mi">2222</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w">     </span><span class="p">...........</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="p">.........</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w">     </span><span class="mi">39907545239</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1998</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">MFGR</span><span class="o">#</span><span class="mi">2227</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w">     </span><span class="mi">40654201840</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1998</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">MFGR</span><span class="o">#</span><span class="mi">2228</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">56</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="p">.</span><span class="w"> </span><span class="n">Elapsed</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">242</span><span class="w"> </span><span class="n">sec</span><span class="p">.</span><span class="w"> </span><span class="n">Processed</span><span class="w"> </span><span class="mi">600</span><span class="p">.</span><span class="mi">04</span><span class="w"> </span><span class="n">million</span><span class="w"> </span><span class="k">rows</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">.</span><span class="mi">60</span><span class="w"> </span><span class="n">GB</span><span class="w"> </span><span class="p">(</span><span class="mi">482</span><span class="p">.</span><span class="mi">97</span><span class="w"> </span><span class="n">million</span><span class="w"> </span><span class="k">rows</span><span class="o">/</span><span class="n">s</span><span class="p">.,</span><span class="w"> </span><span class="mi">4</span><span class="p">.</span><span class="mi">51</span><span class="w"> </span><span class="n">GB</span><span class="o">/</span><span class="n">s</span><span class="p">.)</span><span class="w"> 
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>æ‰«æè¡Œæ•°ï¼š600,040,000</strong> <em>å¤§çº¦6äº¿</em></p>
<p><strong>è€—æ—¶(ç§’)ï¼š1.242</strong></p>
<p><strong>æŸ¥è¯¢åˆ—æ•°ï¼š3</strong></p>
<p><strong>ç»“æœè¡Œæ•°ï¼š56</strong></p>
<h4 id="query-31">Query 3.1</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">C_NATION</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">S_NATION</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">toYear</span><span class="p">(</span><span class="n">LO_ORDERDATE</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">year</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">sum</span><span class="p">(</span><span class="n">LO_REVENUE</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">revenue</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">lineorder_flat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="p">(</span><span class="n">C_REGION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ASIA&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">S_REGION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ASIA&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="k">year</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1992</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="k">year</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">1997</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">C_NATION</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">S_NATION</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">year</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">year</span><span class="w"> </span><span class="k">ASC</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">revenue</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”Œâ”€</span><span class="n">C_NATION</span><span class="err">â”€â”€â”¬â”€</span><span class="n">S_NATION</span><span class="err">â”€â”€â”¬â”€</span><span class="k">year</span><span class="err">â”€â”¬â”€â”€â”€â”€â”€â”€</span><span class="n">revenue</span><span class="err">â”€â”</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="n">INDIA</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="n">INDIA</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1992</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">537778456208</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="n">INDONESIA</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">INDIA</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1992</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">536684093041</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="p">.....</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="p">.......</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="p">............</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="n">CHINA</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="n">CHINA</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1997</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">525562838002</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="n">JAPAN</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="n">VIETNAM</span><span class="w">   </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1997</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">525495763677</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">150</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="p">.</span><span class="w"> </span><span class="n">Elapsed</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">533</span><span class="w"> </span><span class="n">sec</span><span class="p">.</span><span class="w"> </span><span class="n">Processed</span><span class="w"> </span><span class="mi">546</span><span class="p">.</span><span class="mi">67</span><span class="w"> </span><span class="n">million</span><span class="w"> </span><span class="k">rows</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">.</span><span class="mi">48</span><span class="w"> </span><span class="n">GB</span><span class="w"> </span><span class="p">(</span><span class="mi">154</span><span class="p">.</span><span class="mi">72</span><span class="w"> </span><span class="n">million</span><span class="w"> </span><span class="k">rows</span><span class="o">/</span><span class="n">s</span><span class="p">.,</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">55</span><span class="w"> </span><span class="n">GB</span><span class="o">/</span><span class="n">s</span><span class="p">.)</span><span class="w"> 
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>æ‰«æè¡Œæ•°ï¼š546,670,000</strong> <em>å¤§çº¦5äº¿4åƒå¤šä¸‡</em></p>
<p><strong>è€—æ—¶(ç§’)ï¼š3.533</strong></p>
<p><strong>æŸ¥è¯¢åˆ—æ•°ï¼š4</strong></p>
<p><strong>ç»“æœè¡Œæ•°ï¼š150</strong></p>
<h4 id="query-32">Query 3.2</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">C_CITY</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">S_CITY</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">toYear</span><span class="p">(</span><span class="n">LO_ORDERDATE</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">year</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">sum</span><span class="p">(</span><span class="n">LO_REVENUE</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">revenue</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">lineorder_flat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="p">(</span><span class="n">C_NATION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;UNITED STATES&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">S_NATION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;UNITED STATES&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="k">year</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1992</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="k">year</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">1997</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">C_CITY</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">S_CITY</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">year</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">year</span><span class="w"> </span><span class="k">ASC</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">revenue</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”Œâ”€</span><span class="n">C_CITY</span><span class="err">â”€â”€â”€â”€â”€â”¬â”€</span><span class="n">S_CITY</span><span class="err">â”€â”€â”€â”€â”€â”¬â”€</span><span class="k">year</span><span class="err">â”€â”¬â”€â”€â”€â”€</span><span class="n">revenue</span><span class="err">â”€â”</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="n">UNITED</span><span class="w"> </span><span class="n">ST6</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">UNITED</span><span class="w"> </span><span class="n">ST6</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1992</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">5694246807</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="n">UNITED</span><span class="w"> </span><span class="n">ST0</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">UNITED</span><span class="w"> </span><span class="n">ST0</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1992</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">5676049026</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="p">..........</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="p">..........</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="p">..........</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="n">UNITED</span><span class="w"> </span><span class="n">ST9</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">UNITED</span><span class="w"> </span><span class="n">ST9</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1997</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">4836163349</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="n">UNITED</span><span class="w"> </span><span class="n">ST9</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">UNITED</span><span class="w"> </span><span class="n">ST5</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1997</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">4769919410</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">600</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="p">.</span><span class="w"> </span><span class="n">Elapsed</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">000</span><span class="w"> </span><span class="n">sec</span><span class="p">.</span><span class="w"> </span><span class="n">Processed</span><span class="w"> </span><span class="mi">546</span><span class="p">.</span><span class="mi">67</span><span class="w"> </span><span class="n">million</span><span class="w"> </span><span class="k">rows</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">.</span><span class="mi">56</span><span class="w"> </span><span class="n">GB</span><span class="w"> </span><span class="p">(</span><span class="mi">546</span><span class="p">.</span><span class="mi">59</span><span class="w"> </span><span class="n">million</span><span class="w"> </span><span class="k">rows</span><span class="o">/</span><span class="n">s</span><span class="p">.,</span><span class="w"> </span><span class="mi">5</span><span class="p">.</span><span class="mi">56</span><span class="w"> </span><span class="n">GB</span><span class="o">/</span><span class="n">s</span><span class="p">.)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>æ‰«æè¡Œæ•°ï¼š546,670,000</strong> <em>å¤§çº¦5äº¿4åƒå¤šä¸‡</em></p>
<p><strong>è€—æ—¶(ç§’)ï¼š1.00</strong></p>
<p><strong>æŸ¥è¯¢åˆ—æ•°ï¼š4</strong></p>
<p><strong>ç»“æœè¡Œæ•°ï¼š600</strong></p>
<h4 id="query-41">Query 4.1</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">toYear</span><span class="p">(</span><span class="n">LO_ORDERDATE</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">year</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">C_NATION</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">sum</span><span class="p">(</span><span class="n">LO_REVENUE</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">LO_SUPPLYCOST</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">profit</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">lineorder_flat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="p">(</span><span class="n">C_REGION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;AMERICA&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">S_REGION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;AMERICA&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">((</span><span class="n">P_MFGR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;MFGR#1&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="p">(</span><span class="n">P_MFGR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;MFGR#2&#39;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">year</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">C_NATION</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">year</span><span class="w"> </span><span class="k">ASC</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">C_NATION</span><span class="w"> </span><span class="k">ASC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”Œâ”€</span><span class="k">year</span><span class="err">â”€â”¬â”€</span><span class="n">C_NATION</span><span class="err">â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€</span><span class="n">profit</span><span class="err">â”€â”</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1992</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">ARGENTINA</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1041983042066</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1992</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">BRAZIL</span><span class="w">        </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1031193572794</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="p">......</span><span class="w">        </span><span class="err">â”‚</span><span class="w">  </span><span class="p">............</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1998</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">PERU</span><span class="w">          </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">603980044827</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1998</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">UNITED</span><span class="w"> </span><span class="n">STATES</span><span class="w"> </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">605069471323</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">35</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="p">.</span><span class="w"> </span><span class="n">Elapsed</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">.</span><span class="mi">066</span><span class="w"> </span><span class="n">sec</span><span class="p">.</span><span class="w"> </span><span class="n">Processed</span><span class="w"> </span><span class="mi">600</span><span class="p">.</span><span class="mi">04</span><span class="w"> </span><span class="n">million</span><span class="w"> </span><span class="k">rows</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">.</span><span class="mi">41</span><span class="w"> </span><span class="n">GB</span><span class="w"> </span><span class="p">(</span><span class="mi">118</span><span class="p">.</span><span class="mi">43</span><span class="w"> </span><span class="n">million</span><span class="w"> </span><span class="k">rows</span><span class="o">/</span><span class="n">s</span><span class="p">.,</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">66</span><span class="w"> </span><span class="n">GB</span><span class="o">/</span><span class="n">s</span><span class="p">.)</span><span class="w">  
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>æ‰«æè¡Œæ•°ï¼š600,040,000</strong> <em>å¤§çº¦6äº¿</em></p>
<p><strong>è€—æ—¶(ç§’)ï¼š5.066</strong></p>
<p><strong>æŸ¥è¯¢åˆ—æ•°ï¼š4</strong></p>
<p><strong>ç»“æœè¡Œæ•°ï¼š35</strong></p>
<h4 id="query-42">Query 4.2</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">toYear</span><span class="p">(</span><span class="n">LO_ORDERDATE</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">year</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">S_NATION</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">P_CATEGORY</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">sum</span><span class="p">(</span><span class="n">LO_REVENUE</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">LO_SUPPLYCOST</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">profit</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">lineorder_flat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="p">(</span><span class="n">C_REGION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;AMERICA&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">S_REGION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;AMERICA&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">((</span><span class="k">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1997</span><span class="p">)</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="p">(</span><span class="k">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1998</span><span class="p">))</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">((</span><span class="n">P_MFGR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;MFGR#1&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="p">(</span><span class="n">P_MFGR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;MFGR#2&#39;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">year</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">S_NATION</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">P_CATEGORY</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">year</span><span class="w"> </span><span class="k">ASC</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">S_NATION</span><span class="w"> </span><span class="k">ASC</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">P_CATEGORY</span><span class="w"> </span><span class="k">ASC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”Œâ”€</span><span class="k">year</span><span class="err">â”€â”¬â”€</span><span class="n">S_NATION</span><span class="err">â”€â”€â”€â”€â”€â”€â”¬â”€</span><span class="n">P_CATEGORY</span><span class="err">â”€â”¬â”€â”€â”€â”€â”€â”€â”€</span><span class="n">profit</span><span class="err">â”€â”</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1997</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">ARGENTINA</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="n">MFGR</span><span class="o">#</span><span class="mi">11</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">102369950215</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1997</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">ARGENTINA</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="n">MFGR</span><span class="o">#</span><span class="mi">12</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="mi">103052774082</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="p">.........</span><span class="w">     </span><span class="err">â”‚</span><span class="w"> </span><span class="p">.......</span><span class="w">    </span><span class="err">â”‚</span><span class="w"> </span><span class="p">............</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1998</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">UNITED</span><span class="w"> </span><span class="n">STATES</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">MFGR</span><span class="o">#</span><span class="mi">24</span><span class="w">    </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">60779388345</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â”‚</span><span class="w"> </span><span class="mi">1998</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">UNITED</span><span class="w"> </span><span class="n">STATES</span><span class="w"> </span><span class="err">â”‚</span><span class="w"> </span><span class="n">MFGR</span><span class="o">#</span><span class="mi">25</span><span class="w">    </span><span class="err">â”‚</span><span class="w">  </span><span class="mi">60042710566</span><span class="w"> </span><span class="err">â”‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">100</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="p">.</span><span class="w"> </span><span class="n">Elapsed</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">826</span><span class="w"> </span><span class="n">sec</span><span class="p">.</span><span class="w"> </span><span class="n">Processed</span><span class="w"> </span><span class="mi">144</span><span class="p">.</span><span class="mi">42</span><span class="w"> </span><span class="n">million</span><span class="w"> </span><span class="k">rows</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">17</span><span class="w"> </span><span class="n">GB</span><span class="w"> </span><span class="p">(</span><span class="mi">174</span><span class="p">.</span><span class="mi">78</span><span class="w"> </span><span class="n">million</span><span class="w"> </span><span class="k">rows</span><span class="o">/</span><span class="n">s</span><span class="p">.,</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">63</span><span class="w"> </span><span class="n">GB</span><span class="o">/</span><span class="n">s</span><span class="p">.)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>æ‰«æè¡Œæ•°ï¼š144,420,000</strong> <em>å¤§çº¦1äº¿4åƒå¤šä¸‡</em></p>
<p><strong>è€—æ—¶(ç§’)ï¼š0.826</strong></p>
<p><strong>æŸ¥è¯¢åˆ—æ•°ï¼š4</strong></p>
<p><strong>ç»“æœè¡Œæ•°ï¼š100</strong></p>
<h2 id="æ€§èƒ½æµ‹è¯•ç»“æœæ±‡æ€»">æ€§èƒ½æµ‹è¯•ç»“æœæ±‡æ€»</h2>
<table>
<thead>
<tr>
<th style="text-align:left">æŸ¥è¯¢è¯­å¥</th>
<th style="text-align:left">SQLç®€è¦è¯´æ˜</th>
<th style="text-align:right">æ‰«æè¡Œæ•°</th>
<th style="text-align:right">è¿”å›è¡Œæ•°</th>
<th style="text-align:right">æŸ¥è¯¢åˆ—æ•°</th>
<th style="text-align:right">è€—æ—¶(ç§’)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Q1.1</td>
<td style="text-align:left">ä¹˜ç§¯ã€æ±‡æ€»ã€4ä¸ªæ¡ä»¶ã€é¦–æ¬¡è¿è¡Œ</td>
<td style="text-align:right">91,010,000</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">0.242</td>
</tr>
<tr>
<td style="text-align:left">Q1.2</td>
<td style="text-align:left">Q1.1å¢åŠ 1ä¸ªæ¡ä»¶è¿è¡Œ</td>
<td style="text-align:right">7,750,000</td>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">0.040</td>
</tr>
<tr>
<td style="text-align:left">Q2.1</td>
<td style="text-align:left">æ±‡æ€»ã€å‡½æ•°ã€2åˆ—åˆ†ç»„ã€2åˆ—æ’åºã€é¦–æ¬¡è¿è¡Œ</td>
<td style="text-align:right">600,040,000</td>
<td style="text-align:right">280</td>
<td style="text-align:right">3</td>
<td style="text-align:right">8.558</td>
</tr>
<tr>
<td style="text-align:left">Q2.2</td>
<td style="text-align:left">Q2.1å¢åŠ 1ä¸ªæ¡ä»¶è¿è¡Œ</td>
<td style="text-align:right">600,040,000</td>
<td style="text-align:right">56</td>
<td style="text-align:right">3</td>
<td style="text-align:right">1.242</td>
</tr>
<tr>
<td style="text-align:left">Q3.1</td>
<td style="text-align:left">æ±‡æ€»ã€å‡½æ•°ã€3åˆ—åˆ†ç»„ã€2åˆ—æ’åºã€é¦–æ¬¡è¿è¡Œ</td>
<td style="text-align:right">546,670,000</td>
<td style="text-align:right">150</td>
<td style="text-align:right">4</td>
<td style="text-align:right">3.533</td>
</tr>
<tr>
<td style="text-align:left">Q3.2</td>
<td style="text-align:left">Q3.1æ›´æ¢æ¡ä»¶è¿è¡Œ</td>
<td style="text-align:right">546,670,000</td>
<td style="text-align:right">600</td>
<td style="text-align:right">4</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:left">Q4.1</td>
<td style="text-align:left">ç›¸å‡ã€æ±‡æ€»ã€å‡½æ•°ã€2åˆ—åˆ†ç»„ã€2åˆ—æ’åºã€é¦–æ¬¡è¿è¡Œ</td>
<td style="text-align:right">600,040,000</td>
<td style="text-align:right">35</td>
<td style="text-align:right">4</td>
<td style="text-align:right">5.006</td>
</tr>
<tr>
<td style="text-align:left">Q4.2</td>
<td style="text-align:left">Q4.1å¢åŠ 2ä¸ªæ¡ä»¶è¿è¡Œ</td>
<td style="text-align:right">144,420,000</td>
<td style="text-align:right">100</td>
<td style="text-align:right">4</td>
<td style="text-align:right">0.826</td>
</tr>
</tbody>
</table>
<p>åœ¨å½“å‰è½¯ç¡¬ä»¶ç¯å¢ƒä¸‹ï¼Œæ‰«æ 6 äº¿å¤šè¡Œæ•°æ®ï¼Œå¸¸è§çš„åˆ†æè¯­å¥é¦–æ¬¡è¿è¡Œæœ€æ…¢åœ¨ 8 ç§’å·¦å³èƒ½è¿”å›ç»“æœï¼Œç›¸åŒçš„åˆ†æé€»è¾‘æ›´æ¢æ¡ä»¶å†æ¬¡æŸ¥è¯¢çš„æ—¶å€™æ•ˆç‡æœ‰æ˜æ˜¾çš„æå‡ï¼Œå¯ä»¥ç¼©çŸ­åˆ° 1 ç§’å·¦å³ï¼Œå¦‚æœåªæ˜¯ç®€å•çš„åˆ—æŸ¥è¯¢æ²¡æœ‰åŠ å‡ä¹˜é™¤ã€èšåˆç­‰é€»è¾‘ï¼Œæ‰«æå…¨è¡¨ 6 äº¿å¤šè¡Œæ•°æ®é¦–æ¬¡æŸ¥è¯¢åŸºæœ¬å¯ä»¥åœ¨ 2 ç§’å†…æ‰§è¡Œå®Œæˆã€‚</p>
<p>ä»¥ä¸Šæ˜¯å•æœºéƒ¨ç½² Clickhouse çš„æ€§èƒ½è¡¨ç°æƒ…å†µï¼Œåœ¨ä¸æå‡å•æœºç¡¬ä»¶æ€§èƒ½çš„æ¡ä»¶ä¸‹ï¼Œå¦‚æœä½¿ç”¨åˆç†çš„é›†ç¾¤éƒ¨ç½²ï¼Œæ€§èƒ½è¿˜èƒ½è¿›ä¸€æ­¥æé«˜ã€‚</p>
<p>è¿™ä¸ªè¡¨ç°ï¼Œæ¯‹åº¸ç½®ç–‘æ˜¯ç›®å‰ç¦»çº¿æ•°æ®åˆ†ææ•°æ®åº“é¢†åŸŸçš„æ€§èƒ½ç‹è€…ã€‚</p>
]]></description>
</item>
<item>
    <title>æ•°æ®ç»“æ„ä¹‹æ•°ç»„</title>
    <link>https://asimov.top/data-structures-array/</link>
    <pubDate>Tue, 02 Mar 2021 20:16:39 &#43;0800</pubDate>
    <author>asimov</author>
    <guid>https://asimov.top/data-structures-array/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="https://cdn.educba.com/academy/wp-content/uploads/2019/11/Arrays-in-data-structure.png" referrerpolicy="no-referrer">
            </div><h2 id="ç®€ä»‹">ç®€ä»‹</h2>
<p>æ•°ç»„æ˜¯ä¸€ä¸ª<strong>çº¿æ€§è¡¨</strong>ç±»å‹çš„æ•°æ®æ•°æ®ï¼Œå®ƒç”¨ä¸€ç»„<strong>è¿ç»­çš„å†…å­˜ç©ºé—´</strong>ï¼Œæ¥å­˜å‚¨ä¸€ç»„<strong>ç±»å‹ç›¸åŒçš„æ•°æ®</strong>ã€‚</p>
<p>æ•°ç»„ä¸­ä½¿ç”¨<strong>ä¸‹æ ‡</strong>æ¥è¡¨ç¤ºæŸä¸ªå…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼Œä¸‹æ ‡ä» 0 å¼€å§‹è®¡æ•°ã€‚ä¾‹å¦‚æ•°ç»„ array ä¸­ç¬¬ 6 ä¸ªå…ƒç´ ï¼Œè¡¨ç¤ºä¸ºï¼š<code>array[5]</code></p>
<p></p>
<h2 id="è¯»å–">è¯»å–</h2>
<h3 id="éšæœºè®¿é—®">éšæœºè®¿é—®</h3>
<p>åŸºäº<strong>è¿ç»­å†…å­˜ç©ºé—´</strong>å’Œ<strong>ç±»å‹ç›¸åŒ</strong>ä¸¤ä¸ªç‰¹å¾ï¼Œä½¿å¾—<strong>éšæœºè®¿é—®</strong>æ•°ç»„ä¸­çš„æ•°æ®æˆä¸ºå¯èƒ½ã€‚</p>
<p>å‡è®¾æ•°ç»„ <code>array</code> çš„èµ·å§‹å†…å­˜åœ°å€ä¸º <code>start</code>ï¼Œå› ä¸ºå‚¨å­˜çš„æ•°æ®ç±»å‹ç›¸åŒï¼Œå› æ­¤æ¯å—æ•°æ®å ç”¨çš„å†…å­˜å¤§å°ä¹Ÿç›¸åŒï¼Œå‡è®¾ä¸º <code>size</code>ï¼Œé‚£ä¹ˆè¯»å–ä¸‹æ ‡ä¸º <code>i</code> çš„æ•°æ®çš„å†…å­˜åœ°å€çš„å…¬å¼ä¸ºï¼š<code>array[i] = start + i * size</code></p>
<p>è®¡ç®—æœºå¯ä»¥é€šè¿‡è¿™æ ·çš„å…¬å¼ç›´æ¥è¯»å–è¿™ä¸ªå†…å­˜åœ°å€ä¸­å‚¨å­˜çš„æ•°æ®ï¼Œä¸éœ€è¦ä»»ä½•é¢å¤–çš„æ“ä½œï¼Œä¸€å‘å‘½ä¸­ï¼Œæ‰€ä»¥å…¶<strong>æ—¶é—´å¤æ‚åº¦ä¸º</strong> $\mathbf{O(1)}$</p>
<h3 id="è®¿é—®è¶Šç•Œ">è®¿é—®è¶Šç•Œ</h3>
<p>ç”±äºè®¿é—®æ•°ç»„éœ€è¦æŒ‡å®šä¸‹æ ‡ï¼Œé‚£ä¹ˆå½“æŒ‡å®šçš„ä¸‹æ ‡ä¸å­˜åœ¨æ—¶ï¼Œä¼šå‘ç”Ÿè¯»å–é”™è¯¯ï¼Œç§°ä¸ºè®¿é—®è¶Šç•Œã€‚è¿™ä¸ªé”™è¯¯åœ¨ä¸åŒçš„è¯­è¨€ä¸­ï¼Œæœ‰ä¸åŒçš„è¡¨ç°ã€‚</p>
<p>å¦‚æœæ˜¯ Java è¿™ç§è¯­è¨€å±‚åšäº†è¶Šç•Œæ£€æŸ¥çš„è¯­è¨€ï¼Œå°±ä¼šæŠ›å‡º <code>java.lang.ArrayIndexOutOfBoundsException</code>ï¼Œä½†æ˜¯å¦‚æœæ˜¯ C è¯­è¨€çš„è¯ï¼Œå¯èƒ½ä¼šå‘ç”Ÿä¸å¯é¢„çŸ¥çš„é”™è¯¯ï¼Œæ¯”å¦‚æ— é™å¾ªç¯ã€‚æ‰€ä»¥è®¿é—®æ•°ç»„æ—¶ï¼Œéœ€è¦è­¦æƒ•è®¿é—®è¶Šç•Œé”™è¯¯ã€‚</p>
<h3 id="æŸ¥æ‰¾">æŸ¥æ‰¾</h3>
<p>æœ‰äº›åœ°æ–¹è¯´æ•°ç»„é€‚åˆæŸ¥æ‰¾ï¼ŒæŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(1)$ï¼Œè¿™å…¶å®æ˜¯ä¸å¯¹çš„ã€‚</p>
<p>éšæœºè¯»å–çš„å‰ææ˜¯çŸ¥é“å…ƒç´ çš„ä¸‹æ ‡ï¼Œ<strong>éšæœºè¯»å–å¹¶ä¸æ˜¯æŸ¥æ‰¾</strong>ï¼ŒæŸ¥æ‰¾æ˜¯è¦åœ¨æ•°ç»„ä¸­æ‰¾åˆ°æŸä¸ªç›®æ ‡å…ƒç´ ï¼Œåœ¨æ‰¾åˆ°ä¹‹å‰æ˜¯ä¸çŸ¥é“ä¸‹æ ‡çš„ï¼Œæ‰€ä»¥<strong>æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦ä¸æ˜¯</strong> $\mathbf{O(1)}$ã€‚</p>
<p>æŸ¥æ‰¾æœ‰ä¸åŒçš„å®ç°ç®—æ³•ï¼Œå³ä¾¿æ˜¯æ’å¥½åºçš„æ•°ç»„ï¼Œç”¨äºŒåˆ†æ³•æŸ¥æ‰¾ï¼Œæ—¶é—´å¤æ‚åº¦ä¹Ÿæ˜¯ $O(log_n)$</p>
<h2 id="æ’å…¥">æ’å…¥</h2>
<p>å¦‚æœæˆ‘ä»¬è¦åœ¨ä¸€ä¸ªé•¿åº¦ä¸º 10ï¼Œä¸”å‰ 5 ä¸ªä½ç½®éƒ½å·²ç»æœ‰æ•°æ®çš„æ•°ç»„ä¸­ï¼Œæ’å…¥ä¸€ä¸ªæ–°çš„å…ƒç´ åˆ°ç¬¬ 3 ä¸ªä½ç½®ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿ</p>
<p>ä¾‹å¦‚ç°æœ‰æ•°ç»„ <code>[bily,tony,jack,oliver,james]</code>ï¼Œæˆ‘ä»¬è¦å°†æ–°åŒå­¦ <code>harry</code> æ’å…¥åˆ° <code>jack</code> ç°åœ¨çš„ä½ç½®ä¸Šï¼Œè¿™é‡Œéœ€è¦åˆ†ä¸¤ç§æƒ…å†µæ¥çœ‹</p>
<h3 id="æœ‰åºæ’å…¥">æœ‰åºæ’å…¥</h3>
<p>å¦‚æœæ’å…¥ä¹‹åéœ€è¦ä¿æŒå…ƒç´ çš„é¡ºåºï¼Œæ’å…¥åçš„æ•°ç»„åº”è¯¥æ˜¯è¿™æ · <code>[bily,tony,harry,jack,oliver,james]</code>ï¼Œé‚£ä¹ˆç¬¬ 3 ä½åŠä»¥åçš„æ‰€æœ‰å…ƒç´ éƒ½éœ€è¦å¾€åæŒªä¸€ä½ã€‚</p>
<p>è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€å¥½æ—¶é—´å¤æ‚åº¦æ˜¯ $O(1)$ï¼Œå°±æ˜¯æ’å…¥çš„å…ƒç´ åˆšå¥½åœ¨æœ€åä¸€ä½çš„æƒ…å†µï¼Œä¸éœ€è¦ç§»åŠ¨ä»»ä½•å…ƒç´ ï¼›</p>
<p>æœ€åæ—¶é—´å¤æ‚åº¦æ˜¯ $O(n)$ï¼Œå°±æ˜¯æ’å…¥çš„å…ƒç´ åœ¨ç¬¬ä¸€ä½çš„æƒ…å†µï¼Œæ‰€æœ‰å…ƒç´ éƒ½éœ€è¦ç§»åŠ¨ä¸€æ¬¡ï¼›</p>
<p>é‚£ä¹ˆå¹³å‡æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘å‘¢ï¼Ÿå› ä¸ºæ’å…¥åˆ°æ¯ä¸ªä½ç½®çš„æ¦‚ç‡éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥<strong>å¹³å‡æ—¶é—´å¤æ‚åº¦æ˜¯</strong> $\frac{1+2+\cdots+n}{n}=\mathbf{O(n)}$</p>
<h3 id="æ— é¡ºæ’å…¥">æ— é¡ºæ’å…¥</h3>
<p>å¦‚æœæ’å…¥ä¹‹åä¸éœ€è¦ä¿æŒå…ƒç´ çš„é¡ºåºï¼Œé‚£ä¹ˆæ’å…¥æ—¶ç›´æ¥äº¤æ¢ <code>jack</code> å’Œ <code>harry</code> çš„ä½ç½®å³å¯ï¼š<code>[bily,tony,harry,oliver,james,jack]</code></p>
<p>æ­¤æ—¶æ— è®ºå°†æ–°å…ƒç´ æ’å…¥åˆ°å“ªä¸ªä½ç½®ä¸Šï¼Œéƒ½åªéœ€è¦æ“ä½œæ–°æ—§ä¸¤ä¸ªå…ƒç´ ï¼Œå› æ­¤<strong>æ—¶é—´å¤æ‚åº¦æ˜¯</strong> $\mathbf{O(1)}$</p>
<h3 id="æ‰©å®¹">æ‰©å®¹</h3>
<p>å› ä¸ºæ•°ç»„ä½¿ç”¨çš„æ˜¯ä¸€å—è¿ç»­çš„å†…å­˜ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨ä¹‹å‰å°±éœ€è¦æå‰å‘è®¡ç®—æœºç”³è¯·å†…å­˜ï¼Œä¹Ÿå°±æ˜¯åœ¨å£°æ˜æ•°ç»„æ—¶ï¼Œéœ€è¦ç¡®å®šæ•°ç»„çš„å¤§å°ã€‚</p>
<p>å½“æ•°ç»„ä¸­çš„ç©ºé—´è€—å°½æ—¶ï¼Œå°±æ— æ³•æ’å…¥æ–°å…ƒç´ ï¼Œæ­¤æ—¶éœ€è¦æ‰‹åŠ¨ç»™æ•°ç»„è¿›è¡Œâ€œæ‰©å®¹â€ï¼Œä¹Ÿå°±æ˜¯æ–°ç”³è¯·ä¸€ä¸ªæ›´å¤§çš„æ•°ç»„ï¼Œç„¶åå°†åŸæ¥çš„æ•°æ®æ¬è¿‡å»ï¼Œå†æ’å…¥æ–°æ•°æ®ã€‚è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒè€—æ—¶çš„æ“ä½œï¼Œ<strong>æ—¶é—´å¤æ‚åº¦æ˜¯</strong> $\mathbf{O(n)}$</p>
<h2 id="åˆ é™¤">åˆ é™¤</h2>
<h3 id="ç«‹å³åˆ é™¤">ç«‹å³åˆ é™¤</h3>
<p>è¿˜æ˜¯å› ä¸ºæ•°ç»„ä½¿ç”¨è¿ç»­å†…å­˜ç©ºé—´çš„ç‰¹å¾ï¼Œæ‰€ä»¥åœ¨åˆ é™¤äº†å…¶ä¸­ä¸€ä¸ªå…ƒç´ åï¼Œè¿™ä¸ªä½ç½®ä¸èƒ½ç©ºç€ï¼Œå¦åˆ™å†…å­˜ç©ºé—´å°±ä¸è¿ç»­äº†ï¼Œé‚£ä¹ˆå°±éœ€è¦æŠŠåé¢çš„æ•°æ®éƒ½å¾€å‰æŒªä¸€ä½ã€‚</p>
<p>è¿™ä¸ªæ“ä½œå’Œä¿æŒé¡ºåºæ’å…¥æ˜¯æ¯”è¾ƒç±»ä¼¼çš„ï¼Œå¦‚æœåˆ é™¤çš„åˆšå¥½æ˜¯æœ€åä¸€ä¸ªå…ƒç´ ï¼Œé‚£æ—¶é—´å¤æ‚åº¦å°±æ˜¯ $O(n)$ï¼Œå¦‚æœåˆ é™¤çš„æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œé‚£æ—¶é—´å¤æ‚åº¦å°±æ˜¯ $O(n)$ï¼Œè€Œå¹³<strong>å‡æ—¶é—´å¤æ‚åº¦æ˜¯</strong> $\mathbf{O(n)}$</p>
<h3 id="å»¶ååˆ é™¤">å»¶ååˆ é™¤</h3>
<p>é™¤äº†è¸è¸å®å®çš„ç«‹å³åˆ é™¤å¤–ï¼Œä¸ºäº†ä¼˜åŒ–æ•°ç»„åˆ é™¤æ“ä½œçš„æ€§èƒ½ï¼Œå·¥ç¨‹å¸ˆä»¬æœ‰ä¸€äº›å·§æ€å¦™æƒ³ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¦åœ¨æ•°ç»„ <code>[bily,tony,harry,jack,oliver,james]</code> ä¸­ä¾æ¬¡åˆ é™¤ <code>bily</code> å’Œ<code>tony</code>ï¼Œå¦‚æœæ“ä½œä¸€æ¬¡å°±åˆ é™¤ä¸€æ¬¡ï¼Œé‚£ä¹ˆå°±ä¼šé€ æˆä¸¤æ¬¡æ•°æ®æ¬è¿ï¼Œé€ æˆæ€§èƒ½æŸè€—ã€‚</p>
<p>å®é™…ä¸Šï¼Œåœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œåˆ é™¤å°±æ˜¯ä¸ºäº†è®©è¢«åˆ é™¤çš„æ•°æ®æ— æ³•è¢«è¯»å–ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦å°†è¿™ä¸¤ä¸ªæ•°æ®æ ‡è®°ä¸ºå·²åˆ é™¤ï¼Œè€Œä¸æ˜¯çœŸæ­£çš„åˆ é™¤ï¼Œè®©å…¶æ— æ³•è¢«è¯»å–ï¼Œç„¶åç­‰åˆ°æ•°æ®ç©ºé—´ä¸å¤Ÿçš„æ—¶å€™ï¼Œå†ä¸€æ¬¡æ€§åˆ é™¤æ‰€æœ‰è¢«æ ‡è®°ä¸ºå·²åˆ é™¤çš„æ•°æ®ï¼Œåªéœ€è¦è¿›è¡Œä¸€æ¬¡æ•°æ®æ¬è¿æ“ä½œã€‚</p>
<p>åœ¨æ“ä½œé¢‘ç¹çš„æƒ…å†µä¸‹ä¸­ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§æé«˜æ•°ç»„æ“ä½œçš„æ€§èƒ½è¡¨ç°ã€‚</p>
<p>è¿™ä¸ªå…ˆæ ‡è®°å†å»¶è¿Ÿåˆ é™¤çš„æ€è·¯ï¼Œå…¶å®å°±æ˜¯ Java è™šæ‹Ÿæœºä¸­æ ‡è®°æ¸…é™¤åƒåœ¾å›æ”¶ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³ã€‚æ•°æ®ç»“æ„å’Œç®—æ³•çš„é­…åŠ›å°±åœ¨äºæ­¤ï¼Œ<strong>å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¹¶ä¸æ˜¯è¦å»æ­»è®°ç¡¬èƒŒæŸä¸ªæ•°æ®ç»“æ„æˆ–è€…ç®—æ³•ï¼Œè€Œæ˜¯è¦å­¦ä¹ å®ƒèƒŒåçš„æ€æƒ³å’Œå¤„ç†æŠ€å·§ï¼Œè¿™äº›ä¸œè¥¿æ‰æ˜¯å¯æ‹“å±•å¯è¿ç§»ï¼Œæ‰æ˜¯æœ€æœ‰ä»·å€¼çš„ã€‚</strong></p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<ul>
<li>æ•°ç»„æ˜¯ä¸€ç§é€‚åˆå¤šè¯»å°‘å†™çš„æ•°æ®ç»“æ„ï¼Œéšæœºè®¿é—®æ•ˆç‡å¾ˆé«˜ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ $O(1)$ï¼Œä½†æ˜¯æ’å…¥å’Œåˆ é™¤æ“ä½œç›¸å¯¹ä½æ•ˆï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ $O(n)$</li>
<li>æ•°æ®æœ¬èº«æ˜¯ä¸€ç§å¾ˆåŸºç¡€çš„æ•°æ®ç»“æ„ï¼Œæä¾›çš„ API æ¯”è¾ƒæœ‰é™ï¼Œå¤æ‚æ“ä½œå¹¶ä¸æ–¹ä¾¿ã€‚å¾ˆå¤šç¼–ç¨‹è¯­è¨€éƒ½æä¾›äº†ä»¥æ•°ç»„ä¸ºåŸºç¡€çš„å®¹å™¨ï¼Œæä¾›äº†æ›´å¤šçš„ APIï¼Œä½¿ç”¨èµ·æ¥æ›´åŠ æ–¹ä¾¿ï¼Œå¦‚æœä¸æ˜¯å¯¹æ€§èƒ½æœ‰éå¸¸é«˜çš„è¦æ±‚ï¼Œæ—¥å¸¸å¼€å‘ä¸­ä½¿ç”¨å®¹å™¨æ›´æ–¹ä¾¿ã€‚</li>
<li>åŸºäºæ•°ç»„æœ¬èº«çš„ç‰¹ç‚¹ï¼Œåœ¨ä½¿ç”¨æ•°æ®å®¹å™¨ï¼ˆä¾‹å¦‚ Java ä¸­çš„ ArrayListï¼‰æ—¶ï¼Œå°½é‡æå‰è®¾ç½®å¤§å°ï¼Œå¯ä»¥æé«˜æ•ˆç‡ã€‚</li>
</ul>
]]></description>
</item>
<item>
    <title>ç®—æ³•å¤æ‚åº¦åˆ†æå…¥é—¨</title>
    <link>https://asimov.top/introduction-to-algorithm-complexity-analysis/</link>
    <pubDate>Sat, 06 Feb 2021 17:04:54 &#43;0800</pubDate>
    <author>asimov</author>
    <guid>https://asimov.top/introduction-to-algorithm-complexity-analysis/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="https://img.lifelog.cool/algorithm-analysis-gate-cse-notes_waifu2x_art_noise3_scale.jpg" referrerpolicy="no-referrer">
            </div><p><strong>æ‰§è¡Œæ•ˆç‡</strong>å’Œ<strong>èµ„æºæ¶ˆè€—</strong>æ˜¯è¯„ä»·ä¸€ä¸ªç®—æ³•ä¼˜åŠ£æœ€æ ¸å¿ƒçš„ä¸¤ä¸ªç‚¹ï¼Œåˆ†åˆ«ä»£è¡¨è¿è¡Œè¿™ä¸ªç®—æ³•æ‰€éœ€è¦æ¶ˆè€—çš„<strong>æ—¶é—´</strong>å’Œ<strong>ç©ºé—´</strong>ã€‚</p>
<p>åˆ†æè¿è¡Œä¸€ä¸ªç®—æ³•éœ€è¦æ¶ˆè€—å¤šå°‘æ—¶é—´çš„è¡Œä¸ºå«åš<strong>æ—¶é—´å¤æ‚åº¦åˆ†æ</strong>ï¼ŒåŒç†ï¼Œåˆ†æè¿è¡Œä¸€ä¸ªç®—æ³•éœ€è¦æ¶ˆè€—å¤šå°‘ç©ºé—´çš„è¡Œä¸ºå«åš<strong>ç©ºé—´å¤æ‚åº¦åˆ†æ</strong>ã€‚</p>
<p>å®é™…ä¸Šï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥å°†ç®—æ³•è¿è¡Œä¸€éï¼Œè®°å½•ä¸‹è¿è¡Œè¿‡ç¨‹ä¸­æ¶ˆè€—çš„æ—¶é—´å’Œç©ºé—´ï¼Œå°±å¯ä»¥å¾—åˆ°è¿™ä¸ªç®—æ³•å‡†ç¡®çš„èµ„æºæ¶ˆè€—æƒ…å†µã€‚è¿™ç§æ€è·¯ç¡®å®æ˜¯å¯ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ç®¡è¿™ç§æ–¹æ³•å«åš<strong>äº‹åç»Ÿè®¡æ³•</strong>ã€‚</p>
<p>ä½†æ˜¯è¿™æ ·å¾—å‡ºæ¥çš„ç»“æœå˜é‡å¤ªå¤šï¼Œæ¯”å¦‚æµ‹è¯•ç¯å¢ƒçš„ç¡¬ä»¶æ€§èƒ½ï¼Œè½¯ä»¶ï¼ˆæ“ä½œç³»ç»Ÿ / SDK ç­‰ï¼‰ç‰ˆæœ¬ï¼Œæµ‹è¯•çš„æ•°æ®è§„æ¨¡ï¼Œç”šè‡³æ˜¯å®ç°ç®—æ³•æ‰€ç”¨çš„ç¼–ç¨‹è¯­è¨€ï¼Œéƒ½å¯¹ç»“æœéƒ½æœ‰æˆ–å¤šæˆ–å°‘çš„å½±å“ã€‚è€Œå¦‚æœæƒ³è¦æµ‹è¯•æ¡ä»¶è¦†ç›–å°½å¯èƒ½å¤šçš„æƒ…å†µï¼Œå°±ä¼šäº§ç”Ÿæå…¶å·¨å¤§çš„å·¥ä½œé‡ï¼Œå³ä¾¿æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ç®—æ³•ï¼Œéƒ½éœ€è¦éå¸¸å¤§é‡çš„æµ‹è¯•ã€‚è¿™æ˜¾ç„¶ä¸æ˜¯ä¸€ä¸ªå¯å–çš„æ–¹æ³•ã€‚</p>
<p>å› æ­¤ï¼Œäº‹åç»Ÿè®¡æ³•ä¸€èˆ¬åªé€‚åˆåœ¨ç‰¹å®šç¯å¢ƒä¸‹ç»™ç‰¹å®šçš„ç¨‹åºåšæ€§èƒ½æµ‹è¯•ï¼ˆä¾‹å¦‚å¾ˆå¤šç¨‹åºåœ¨ä¸Šçº¿ä¹‹å‰éƒ½è¦åšå‹åŠ›æµ‹è¯•ï¼‰ï¼Œä¸é€‚åˆç”¨æ¥å¯¹ä¸€ä¸ªé€šç”¨å‹çš„ç®—æ³•æˆ–ç¨‹åºåšæ— å·®åˆ«çš„æ€§èƒ½è¯„ä¼°ã€‚</p>
<h2 id="å¤§-o-è¡¨ç¤ºæ³•">å¤§ O è¡¨ç¤ºæ³•</h2>
<p>ä¸ºäº†åœ¨ç¨‹åºè¿è¡Œå‰ï¼Œä¸ä¾èµ–å…·ä½“æµ‹è¯•ç»“æœï¼Œå°±èƒ½æ— å·®åˆ«çš„è¯„ä¼°ä¸€ä¸ªç®—æ³•çš„æ‰§è¡Œæ•ˆç‡ï¼Œå·¥ç¨‹å¸ˆä»¬ä½¿ç”¨äº†ä¸€ä¸ªæ•°å­¦ä¸­çš„æ¦‚å¿µï¼š<a href="https://zh.wikipedia.org/wiki/%E5%A4%A7O%E7%AC%A6%E5%8F%B7" target="_blank" rel="noopener noreffer "><strong>å¤§ O ç¬¦å·ï¼Œåˆç§°æ¸è¿›ç¬¦å·</strong></a></p>
<p><strong>å¤§ O è¡¨ç¤ºæ³•</strong>æ˜¯ç›®å‰åšç®—æ³•å¤æ‚åº¦åˆ†ææ—¶æ‰€ä½¿ç”¨çš„è¡Œä¸šæ ‡å‡†ï¼Œè¿™æ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µï¼Œå®ƒ<strong>è¡¨ç¤ºçš„ä¸æ˜¯æŸä¸ªå…·ä½“çš„å€¼ï¼Œè€Œæ˜¯ä¸€ç§è¶‹åŠ¿</strong>ã€‚</p>
<p>æ¯”å¦‚ä¸‹é¢æ˜¯ä¸€ä¸ªè®¡ç®— 1 + 2 + 3 + &hellip; + n çš„ç´¯åŠ å¼çš„å‡½æ•°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">foo</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">i</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">sum</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‡å®šè®¡ç®—æœºæ¯æ‰§è¡Œä¸€è¡Œä»£ç æ‰€æ¶ˆè€—çš„æ—¶é—´ä¸º $t$ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç¬¬äºŒè¡Œæ˜¯ä¸€ä¸ªç®€å•çš„èµ‹å€¼æ“ä½œï¼Œæ¶ˆè€—æ—¶é—´ä¸º $t$ï¼Œç¬¬å››ã€äº”è¡Œæ˜¯ä¸€ä¸ªå¾ªç¯æ“ä½œï¼Œæ¶ˆè€—æ—¶é—´ä¸º $2n*t$ï¼Œé‚£ä¹ˆç¨‹åºæ€»æ¶ˆè€—æ—¶é—´ä¸º $T(n)= t + 2nt$</p>
<p>å†çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">bar</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">		<span class="o">}</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">sum</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç¬¬äºŒè¡Œè€—è´¹çš„æ—¶é—´ä¸º $t$ï¼Œä¸‰ã€å››ã€äº”è¡Œæ˜¯ä¸€ä¸ªåŒå±‚å¾ªç¯ï¼Œå…¶ä¸­ç¬¬å››ã€äº”è¡Œè€—è´¹çš„æ—¶é—´æ˜¯ $2n^2<em>t$ï¼Œç¬¬ä¸‰è¡Œè€—è´¹çš„æ—¶é—´æ˜¯ $n</em>t$ï¼Œé‚£ä¹ˆæ€»çš„æ—¶é—´æ¶ˆè€—ä¸º $T(n)=t+nt+2n^2t$</p>
<p>é€šè¿‡ä¸¤ä¸ªä¾‹å­ï¼Œå¯ä»¥å‘ç°ä¸€ä¸ªæ˜æ˜¾çš„è§„å¾‹ï¼š<strong>ä»£ç çš„æ€»æ‰§è¡Œæ—¶é—´ $T(n)$ ä¸æ¯è¡Œä»£ç çš„æ‰§è¡Œæ¬¡æ•° $n$ æˆæ­£æ¯”ã€‚</strong></p>
<p>åˆ©ç”¨å¤§ O ç¬¦å·ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªè§„å¾‹è¡¨ç¤ºä¸ºï¼š$$T(n) = O(f(n))$$
è¿™ä¸ªè¡¨è¾¾å¼ç§°ä¹‹ä¸º <strong>å¤§ O è¡¨è¾¾å¼</strong>ï¼Œå…¶ä¸­ï¼š$T(n)$ è¡¨ç¤ºç¨‹åºæ€»çš„æ‰§è¡Œæ—¶é—´ï¼Œ$f(n)$ è¡¨ç¤ºæ¯è¡Œä»£ç æ‰§è¡Œçš„æ€»æ¬¡æ•°ï¼Œ$n$ è¡¨ç¤ºæ•°æ®è§„æ¨¡çš„å¤§å°ï¼Œ$O$ è¡¨ç¤º $T(n)$ ä¸ $f(n)$ æˆæ­£æ¯”ã€‚</p>
<p>æ‰€ä»¥ï¼Œå¤§ O è¡¨è¾¾å¼å®é™…ä¸Šå¹¶ä¸æ˜¯ä»£è¡¨ç¨‹åºå…·ä½“æ‰§è¡Œçš„æ—¶é—´ï¼Œè€Œæ˜¯<strong>è¡¨ç¤ºä»£ç æ‰§è¡Œæ—¶é—´éšæ•°æ®è§„æ¨¡å¢é•¿çš„å˜åŒ–è¶‹åŠ¿</strong>ï¼Œå› æ­¤ï¼Œä¹Ÿå«åš<strong>æ¸è¿›æ—¶é—´å¤æ‚åº¦</strong>ï¼ˆasymptotic time complexityï¼‰ï¼Œç®€ç§°<strong>æ—¶é—´å¤æ‚åº¦</strong>ã€‚</p>
<p>åœ¨å¤§ O è¡¨è¾¾å¼ä¸­ï¼Œå½“ $n$ è¶‹è¿‘äºæ— é™å¤§æ—¶ï¼Œå…¬å¼ä¸­çš„<strong>å¸¸é‡ã€ç³»æ•°ã€ä½é˜¶éƒ¨åˆ†å¯¹å¢é•¿è¶‹åŠ¿çš„å½±å“éå¸¸å°ï¼Œå¯ä»¥å¿½ç•¥ä¸è®¡</strong>ï¼Œå› ä¸ºç°ä»£è®¡ç®—æœºçš„æ‰§è¡Œé€Ÿåº¦éå¸¸å¿«ï¼Œé€šå¸¸èƒ½è¾¾åˆ°æ¯ç§’å‡ ç™¾äº¿æ¬¡ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦è®°å½•ä¸€ä¸ªæœ€å¤§é‡çº§å³å¯ã€‚</p>
<p>å› æ­¤ï¼Œç¬¬ä¸€ä¸ªä¾‹å­ä¸­æˆ‘ä»¬å¾—å‡ºçš„ $T(n)=t+2nt$ï¼Œå¿½ç•¥å¸¸é‡ $t$ å’Œç³»æ•° $2t$ ä¹‹åï¼Œç”¨å¤§ O è¡¨ç¤ºæ³•ä¸ºï¼š$T(n)=O(n)$</p>
<p>ç¬¬äºŒä¸ªä¾‹å­ä¸­çš„ $T(n)=t+nt+2n^2t$ å¿½ç•¥å¸¸é‡å’Œç³»æ•°ï¼Œä¿ç•™æœ€å¤§é‡çº§åï¼Œç”¨å¤§ O è¡¨ç¤ºæ³•ä¸ºï¼š$T(n)=O(n^2)$  <em>ï¼ˆè¿™ä¸ªä¾‹å­åœ¨åæ–‡â€œåŠ æ³•æ³•åˆ™â€ä¸­ä¼šæœ‰æ›´è¯¦ç»†çš„è§£é‡Šï¼‰</em></p>
<p>è¿™ç§åˆ†ææ€è·¯æ¥æºäºæ•°å­¦ä¸­çš„ <a href="https://zh.wikipedia.org/wiki/%E6%B8%90%E8%BF%91%E5%88%86%E6%9E%90" target="_blank" rel="noopener noreffer ">æ¸è¿›åˆ†æ</a> æ–¹æ³•ï¼Œè®¡ç®—æœºç§‘å­¦å®é™…ä¸Šå°±æ˜¯ä»æ•°å­¦ä¸­ç‹¬ç«‹å‡ºæ¥çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œåœ¨è§£å†³æ¯”è¾ƒåº•å±‚å’ŒæŠ½è±¡å±‚é¢çš„é—®é¢˜ä¸Šï¼Œç”¨çš„åŸºæœ¬éƒ½æ˜¯æ•°å­¦æ–¹æ³•ã€‚</p>
<h2 id="æ—¶é—´å¤æ‚åº¦åˆ†æ">æ—¶é—´å¤æ‚åº¦åˆ†æ</h2>
<blockquote>
<p>æ—¶é—´ï¼Œæ˜¯ä¸–é—´æœ€å®è´µçš„èµ„æºã€‚</p>
</blockquote>
<p>åœ¨ç®—æ³•çš„å¤æ‚åº¦åˆ†æä¸­ï¼Œæ—¶é—´å¤æ‚åº¦åˆ†æé€šå¸¸æ¯”ç©ºé—´å¤æ‚åº¦åˆ†ææ›´é‡è¦ï¼Œä¹Ÿæ›´å¤æ‚ã€‚å› ä¸ºè®¡ç®—æœºçš„ç©ºé—´ï¼ˆç¡¬ä»¶ï¼‰æ˜¯å¯ä»¥æ‰©å®¹çš„ï¼Œè€Œäººç±»ç›®å‰çš„ç§‘æŠ€èƒ½åŠ›ï¼Œè¿˜è¿œè¿œè¾¾ä¸åˆ°â€œæ‰©å®¹æ—¶é—´â€çš„æ°´å¹³ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å…ˆé‡ç‚¹å…³æ³¨æ—¶é—´å¤æ‚åº¦åˆ†æã€‚</p>
<h3 id="åˆ†ææŠ€å·§">åˆ†ææŠ€å·§</h3>
<p>åˆ†æä»£ç çš„æ—¶é—´å¤æ‚åº¦ä¸€èˆ¬éƒ½éœ€è¦æŒ‰ç…§å…·ä½“é€»è¾‘å…·ä½“åˆ†æï¼Œä¸è¿‡ä¹Ÿæœ‰ä¸€äº›å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç®€åŒ–åˆ†æçš„æŠ€å·§ï¼Œä¸‹é¢åˆ†äº«ä¸¤ä¸ªæœ€å¸¸ç”¨çš„åˆ†ææŠ€å·§ã€‚</p>
<h4 id="ä¹˜æ³•æ³•åˆ™">ä¹˜æ³•æ³•åˆ™</h4>
<p>å¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">foo</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">bar</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">sum</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">bar</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">i</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">sum</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™å…¶å®æ˜¯ä¸€ä¸ªæ‹†æˆä¸¤ä¸ªå‡½æ•°çš„åµŒå¥—å¾ªç¯ï¼Œå¦‚æœå‡½æ•° <code>foo()</code> çš„å¾ªç¯ä½“ä¸­æ˜¯ä¸€ä¸ªç®€å•çš„æ“ä½œï¼Œé‚£ä¹ˆä¸¤ä¸ªå‡½æ•°çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ $O(n)$ï¼Œä½†æ˜¯å‡½æ•° <code>foo()</code> çš„å¾ªç¯ä½“ä¸­è°ƒç”¨äº†å‡½æ•° <code>bar()</code>ï¼Œè€Œå‡½æ•°<code>bar()</code>çš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(n)$ï¼Œå› æ­¤å‡½æ•° <code>foo()</code> çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯ $O(n)*O(n) = O(n^2)$</p>
<p>å¦‚ä¸Šæ‰€ç¤ºï¼Œ<strong>å¤æ‚åº¦åˆ†æçš„ä¹˜æ³•æ³•åˆ™æŠ½è±¡ä¸ºæ•°å­¦å…¬å¼å°±æ˜¯ï¼š</strong>
<data id="id-1" data-raw></data></p>
<p>å½“ç¢°åˆ°åµŒå¥—å¾ªç¯ä»£ç æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¹˜æ³•æ³•åˆ™å¸®åŠ©æˆ‘ä»¬åˆ†æå¤æ‚åº¦ï¼š<strong>åµŒå¥—ä»£ç çš„å¤æ‚åº¦ç­‰äºåµŒå¥—å†…å¤–ä»£ç å¤æ‚åº¦çš„ä¹˜ç§¯ã€‚</strong></p>
<p>ä¾‹å¦‚å¤–å±‚å¾ªç¯æ—¶é—´å¤æ‚åº¦ä¸º $O(f(n))$ï¼Œå†…å±‚å¾ªç¯æ—¶é—´å¤æ‚åº¦ä¸º $O(g(n))$ï¼Œé‚£ä¹ˆæ€»çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯ $O(f(n)*g(n))$</p>
<h4 id="åŠ æ³•æ³•åˆ™">åŠ æ³•æ³•åˆ™</h4>
<p>å¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">cal</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">100</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">i</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">foo</span><span class="o">(</span><span class="n">n</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">bar</span><span class="o">(</span><span class="n">n</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">sum</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">foo</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">i</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">sum</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">bar</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">foo</span><span class="o">(</span><span class="n">n</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">sum</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ ¹æ®ä¸Šé¢çš„è®¡ç®—è§„åˆ™ï¼Œæˆ‘ä»¬çŸ¥é“å‡½æ•° <code>foo()</code> çš„æ—¶é—´å¤æ‚åº¦ $T_1(n) = O(n)$ï¼Œå‡½æ•° <code>bar()</code> çš„æ—¶é—´å¤æ‚åº¦ $T_2(n) = O(n^2)$ï¼Œè€Œå‡½æ•° <code>cal()</code> ä¸­çš„ç¬¬ä¸€æ®µæ˜¯ä¸ª 100 æ¬¡çš„å¾ªç¯ï¼Œè™½ç„¶æ˜¯ä¸ªå¾ªç¯ï¼Œä½†æ˜¯ä¸ªå·²çŸ¥æ¬¡æ•°çš„å¸¸é‡å¾ªç¯ï¼Œä¸æ•°æ®è§„æ¨¡ $n$ æ— å…³ã€‚</p>
<p>åŒæ—¶ï¼Œéšç€æ•°æ®è§„æ¨¡çš„å¢å¤§ï¼Œ$O(n^2)$ çš„æ—¶é—´å¤æ‚åº¦ä¼šè¿œé«˜äº $O(n)$ï¼Œæ­¤æ—¶åªéœ€è¦å–å¤æ‚åº¦æœ€é«˜çš„å€¼å³å¯ï¼Œå› æ­¤æ€»å¤æ‚åº¦</p>
<data id="id-2" data-raw></data>
<p>å¦‚ä¸Šæ‰€ç¤ºï¼Œ<strong>å¤æ‚åº¦åˆ†æçš„åŠ æ³•æ³•åˆ™æŠ½è±¡ä¸ºæ•°æ®å…¬å¼å°±æ˜¯ï¼š</strong></p>
<data id="id-3" data-raw></data>
<p>å½“ç¢°åˆ°ç¨‹åºä¸­åŒ…å«å¤šä¸ªå­å‡½æ•°/ç®—æ³•æ—¶ï¼Œå¯ä»¥ä½¿ç”¨åŠ æ³•æ³•åˆ™å¸®åŠ©æˆ‘ä»¬åˆ†æå¤æ‚åº¦ï¼š<strong>æ€»å¤æ‚åº¦ç­‰äºé‡çº§æœ€å¤§çš„é‚£æ®µä»£ç çš„å¤æ‚åº¦ã€‚</strong></p>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw" aria-hidden="true"></i>æŠ€å·§<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">å¦‚æœåœ¨å¤šæ®µä»£ç ä¸­ï¼Œæ— æ³•ç¡®å®šå“ªä¸€æ®µå¤æ‚åº¦æœ€å¤§ï¼Œé‚£ä¹ˆç›´æ¥ç›¸åŠ å³å¯ã€‚</div>
        </div>
    </div>
<p>å¦‚ $T_1=O(n)$ï¼Œ$T_2=O(m)$ï¼Œåœ¨æ— æ³•ç¡®å®š $m$ å’Œ $n$ è°æ›´å¤§æ—¶ï¼Œåˆ™ $T(n)=O(n+m)$</p>
<p>å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œå¤æ‚çš„ç®—æ³•æˆ–è€…ç¨‹åºéƒ½æ˜¯ç”±ç®€å•çš„ç®—æ³•æ­¥éª¤ç»„åˆè€Œæˆï¼Œè¿™ä¸¤ä¸ªæŠ€å·§æœ‰åŠ©äºæˆ‘ä»¬åœ¨åˆ†æå¤æ‚ç®—æ³•çš„æ—¶å€™ç†æ¸…æ€è·¯ï¼Œä¸è¢«ç»•æ™•ã€‚ç†è§£è¿™ä¸¤ä¸ªæ³•åˆ™ä¹‹åä¼šå‘ç°ï¼Œéƒ½æ˜¯å¾ˆè‡ªç„¶çš„è§„å¾‹ï¼Œæ‰€ä»¥ä¸ç”¨åˆ»æ„å»è®°å¿†å’Œå¥—ç”¨ï¼Œå¤šåˆ†æå‡ ä¸ªå®ä¾‹ï¼Œè‡ªç„¶å°±ç†Ÿæ‚‰äº†ï¼Œè€Œä¸”å¯ä»¥æ€»ç»“å‡ºæ›´é€‚åˆè‡ªå·±æ€ç»´ä¹ æƒ¯çš„æŠ€å·§ã€‚</p>
<h3 id="åˆ†æå®ä¾‹">åˆ†æå®ä¾‹</h3>
<p>è™½ç„¶ä»£ç åƒå˜ä¸‡åŒ–ï¼Œä½†æ˜¯å¾—ç›Šäºæ•°å­¦æ€æƒ³çš„é«˜åº¦æŠ½è±¡æ€§ï¼Œä»¥ä¸‹å‡ ç§å½¢å¼å°±èƒ½å›Šæ‹¬ç»å¤§éƒ¨åˆ†ç®—æ³•çš„å¤æ‚åº¦ï¼ˆæŒ‰æ—¶é—´å¤æ‚åº¦é‡çº§å‡åºæ’åˆ—ï¼‰ï¼š</p>
<ol>
<li>å¸¸æ•°é˜¶ï¼š$O(1)$</li>
<li>å¯¹æ•°é˜¶ï¼š$O(log\ n)$</li>
<li>çº¿æ€§é˜¶ï¼š$O(n)$</li>
<li>çº¿æ€§å¯¹æ•°é˜¶ï¼š$O(n*log\ n)$</li>
<li>kæ¬¡æ–¹é˜¶ï¼š$O(n^k)$</li>
<li>æŒ‡æ•°é˜¶ï¼š$O(k^n)$</li>
<li>é˜¶ä¹˜é˜¶ï¼š$O(n!)$</li>
</ol>
<p>ä»¥ä¸Š 7 ç§é‡çº§çš„å¤æ‚åº¦ï¼Œå¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼š<strong>å¤šé¡¹å¼é‡çº§</strong>å’Œ<strong>éå¤šé¡¹å¼é‡çº§</strong>ï¼Œå…¶ä¸­<strong>éå¤šé¡¹å¼é‡çº§åªæœ‰ä¸¤ä¸ªï¼š$O(k^n)$ å’Œ $O(n!)$</strong>ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦ä¸ºéå¤šé¡¹å¼é‡çº§çš„ç®—æ³•é—®é¢˜ä¹Ÿå«åš <a href="https://zh.wikipedia.org/wiki/NP_%28%E8%A4%87%E9%9B%9C%E5%BA%A6%29" target="_blank" rel="noopener noreffer ">NPï¼ˆNon-Deterministic Polynomial éç¡®å®šå¤šé¡¹å¼ï¼‰é—®é¢˜</a></p>
<p>éšç€æ•°æ®è§„æ¨¡çš„å¢å¤§ï¼Œéå¤šé¡¹å¼æ—¶é—´å¤æ‚åº¦é‡çº§çš„ç®—æ³•ï¼Œæ‰§è¡Œæ—¶é—´ä¼šæ€¥å‰§å¢åŠ ï¼Œæ‰€ä»¥ï¼Œ<strong>éå¤šé¡¹å¼æ—¶é—´å¤æ‚åº¦çš„ç®—æ³•ä¸€èˆ¬æ•ˆç‡éƒ½å¾ˆä½</strong>ï¼Œé™¤éæ˜¯ç¡®å®šæ€§çš„å°è§„æ¨¡æ•°æ®åº”ç”¨åœºæ™¯ï¼Œå¤§å¤šæ˜¯æƒ…å†µä¸‹éƒ½<strong>ä¸åº”è¯¥ä½¿ç”¨</strong>ï¼Œå¦åˆ™å®¹æ˜“é€ æˆç¨‹åºæ€§èƒ½æ€¥å‰§ä¸‹é™ã€‚</p>
<p>æˆ‘ä»¬ä¸»è¦çœ‹ä¸‹å‡ ç§å¸¸è§çš„<strong>å¤šé¡¹å¼æ—¶é—´å¤æ‚åº¦</strong>çš„ä¾‹å­ï¼š</p>
<h4 id="å¸¸æ•°é˜¶">å¸¸æ•°é˜¶</h4>
<p>é¦–å…ˆè¿˜æ˜¯è¦é‡ç”³ä¸€ä¸‹å¤§ O è¡¨è¾¾å¼çš„æ¦‚å¿µï¼šè¡¨ç¤ºç¨‹åºæ‰§è¡Œæ—¶é—´éšæ•°æ®è§„æ¨¡å¢é•¿çš„å˜åŒ–è¶‹åŠ¿ã€‚</p>
<p>æ‰€ä»¥ $O(1)$ å¹¶ä¸æ˜¯è¯´åªæ‰§è¡Œä¸€è¡Œä»£ç ï¼Œè€Œæ˜¯æŒ‡æ‰§è¡Œæ—¶é—´ä¸ä¼šéšç€æ•°æ®è§„æ¨¡çš„å¢å¤§è€Œæ— å¢å¤§ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">sum</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">2</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å³ä¾¿éœ€è¦æ‰§è¡Œ 3 è¡Œä»£ç ï¼Œå®ƒçš„æ—¶é—´å¤æ‚åº¦ä¹Ÿæ˜¯ $O(1)$ï¼Œè€Œä¸æ˜¯ $O(3)$</p>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€æ®µä»£ç é‡Œæ²¡æœ‰å¾ªç¯ã€é€’å½’ï¼Œå…¶æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ $O(1)$ï¼Œå…¶å‡½æ•°å›¾å½¢å¦‚ä¸‹</p>
<p></p>
<h4 id="çº¿æ€§é˜¶">çº¿æ€§é˜¶</h4>
<p>çº¿æ€§é˜¶ä¹Ÿæ˜¯ä¸€ç§éå¸¸å¸¸è§çš„æ—¶é—´å¤æ‚åº¦é‡çº§ï¼Œæ¯”å¦‚æ–‡ç« ä¸€å¼€å§‹æˆ‘ä»¬å°±åˆ†æè¿‡çš„ç¬¬ä¸€ä¸ªä¾‹å­ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">foo</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">i</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">sum</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„ $O(n)$ å¤æ‚åº¦çš„ä¾‹å­ï¼Œç¨‹åºæ‰§è¡Œæ—¶é—´çš„å¢é•¿å¹…åº¦å’Œæ•°æ®è§„æ¨¡çš„å¢é•¿å¹…åº¦ä¿æŒä¸€è‡´ã€‚</p>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸€ä¸ªç®€å•çš„å•å±‚å¾ªç¯çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯ $O(n)$ ï¼Œå…¶å‡½æ•°å›¾å½¢å¦‚ä¸‹ï¼š</p>
<p></p>
<h4 id="å¯¹æ•°é˜¶">å¯¹æ•°é˜¶</h4>
<p>å¯¹æ•°é˜¶æ˜¯ä¹Ÿæ˜¯å¾ˆå¸¸è§ï¼Œä½†æ˜¯åˆ†æèµ·æ¥å¤æ‚ä¸€äº›çš„æ—¶é—´å¤æ‚åº¦ç±»å‹ã€‚çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">foo</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">2</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">i</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// è¿™æ®µä»£ç çš„é€»è¾‘æ˜¯ï¼š i åœ¨å¾ªç¯ä¸­ä¸æ–­ä¹˜ 2 ï¼Œç›´åˆ° i &gt;= n æ—¶ï¼Œé€€å‡ºå¾ªç¯
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ ¹æ®ä¸Šæ–‡çš„åˆ†æï¼Œæˆ‘ä»¬åªè¦åˆ†æå‡ºè¿™ä¸ªå¾ªç¯æ‰§è¡Œäº†å¤šå°‘æ¬¡ï¼Œå°±èƒ½ç®—å‡ºè¿™æ®µä»£ç çš„æ—¶é—´å¤æ‚åº¦ã€‚</p>
<p>å®é™…ä¸Šå°±æ˜¯ç­‰æ¯”æ•°åˆ—ï¼š<data id="id-4" data-raw></data>ï¼Œä¹Ÿå°±æ˜¯ $2^x = n$ æ±‚è§£ $x$ï¼Œé«˜ä¸­æ•°å­¦ç»™äº†æˆ‘ä»¬ç­”æ¡ˆï¼š$x = log_2n$ ï¼Œæ‰€ä»¥è¿™ä¸ªå¾ªç¯æ‰§è¡Œäº† $log_2n$ éï¼Œå› æ­¤è¿™æ®µä»£ç çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(log_2n)$</p>
<p>å¦‚æœæˆ‘ä»¬æŠŠä¸Šè¿°ä¾‹å­ä¸­çš„å¸¸é‡ä¹˜æ•° <code>2</code> æ¢æˆ <code>3</code>ï¼Œé‚£ä¹ˆæ—¶é—´å¤æ‚åº¦å°±å˜æˆäº† $O(log_3n)$</p>
<p>æ ¹æ®å¯¹æ•°çš„<a href="https://zh.wikipedia.org/wiki/%E5%AF%B9%E6%95%B0#%E8%BF%90%E7%AE%97%E5%85%AC%E5%BC%8F" target="_blank" rel="noopener noreffer ">é“¾å¼è¿ç®—</a>ï¼Œæˆ‘ä»¬çŸ¥é“ $log_3n = log_32 * log_2n$ï¼Œé‚£ä¹ˆ $O(log_3n) = O(log_32 * log_2n)$ï¼Œå…¶ä¸­ $log_32$ æ˜¯ä¸€ä¸ªå¸¸é‡ç³»æ•°ï¼ŒåŸºäºä¸Šæ–‡æˆ‘ä»¬çš„åˆ†æï¼Œ<strong>åœ¨å¤§ O è¡¨ç¤ºæ³•ä¸­ï¼Œå¯ä»¥å¿½ç•¥ç³»æ•°ï¼Œå³ï¼š</strong></p>
<p>$O(C*f(n)) = O(f(n))$</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ $O(log_kn)$ è¿™æ ·çš„å¯¹æ•°é˜¶å¤æ‚åº¦ä¸­ï¼Œæ— è®ºåº•æ•°å¸¸é‡ $k$ æ˜¯å¤šå°‘ï¼Œå¤æ‚åº¦éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»Ÿä¸€å¿½ç•¥åº•æ•°ï¼Œå°†å¯¹æ•°é˜¶å¤æ‚åº¦è¡¨ç¤ºä¸ºï¼š$O(log\ n)$ï¼Œå…¶å‡½æ•°å›¾åƒå›¾ä¸‹ï¼š</p>
<p></p>
<h4 id="çº¿æ€§å¯¹æ•°é˜¶">çº¿æ€§å¯¹æ•°é˜¶</h4>
<p>ç†è§£äº†å¯¹æ•°é˜¶ $O(log\ n)$ ä¹‹åï¼Œç†è§£çº¿æ€§å¯¹æ•°é˜¶å°±å®¹æ˜“å¾ˆå¤šäº†ã€‚å°†ä¸€ä¸ª $O(log\ n)$ å¤æ‚åº¦çš„æ­¥éª¤ï¼Œæ‰§è¡Œ $n$ éï¼Œå…¶å¤æ‚åº¦å°±æ˜¯ $O(nlog\ n)$</p>
<p>å¦‚ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ $O(nlog_n)$ æ—¶é—´å¤æ‚åº¦ç¨‹åºçš„ç¤ºä¾‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">foo</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">		<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">while</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">2</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">		<span class="o">}</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// è¿™æ®µä»£ç ä¸­ï¼Œå¤–é¢å¥—çš„è¿™å±‚ for å¾ªç¯å¹¶æ²¡æœ‰ä»€ä¹ˆå®é™…æ„ä¹‰ï¼Œä»…ä½œä¸ºæ¼”ç¤ºè¯´æ˜
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ ¹æ®å‰æ–‡æˆ‘ä»¬æåˆ°çš„ä¹˜æ³•æ³•åˆ™ï¼Œè¿™æ®µä»£ç çš„æ—¶é—´å¤æ‚åº¦å¾ˆå®¹æ˜“è®¡ç®—å¾—å‡ºï¼š</p>
<p>$T(n) = O(n) * O(log_n) = O(nlog_n)$</p>
<p>è¿™å°±æ˜¯çº¿æ€§å¯¹æ•°é˜¶ï¼Œå…¶å‡½æ•°å›¾åƒå¦‚ä¸‹ï¼š</p>
<p></p>
<h4 id="k-æ¬¡æ–¹é˜¶">K æ¬¡æ–¹é˜¶</h4>
<p>è¿™ä¹Ÿæ˜¯æœ€å¸¸è§çš„æ—¶é—´å¤æ‚åº¦ä¹‹ä¸€ï¼Œ$K$ æ˜¯å¸¸æ•°ï¼Œå¦‚ä¸‹æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„å¹³æ–¹é˜¶æ—¶é—´å¤æ‚åº¦ç¤ºä¾‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">foo</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">		<span class="o">}</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åˆ©ç”¨ä¸Šæ–‡ä»‹ç»çš„ä¹˜æ³•æ³•åˆ™ï¼Œå¾ˆå¿«å°±èƒ½è®¡ç®—å‡ºè¿™æ®µä»£ç çš„æ—¶é—´å¤æ‚åº¦ï¼š</p>
<p>$T(n)=O(n)*O(n)=O(n^2)$</p>
<p>å…¶å‡½æ•°å›¾åƒå›¾ä¸‹ï¼š</p>
<p></p>
<p>âš ï¸ æ³¨æ„ï¼š<strong>æ¬¡æ–¹é˜¶ $O(n^k)$ å®¹æ˜“å’ŒæŒ‡æ•°é˜¶ $O(k^n)$ æ··æ·†</strong>ï¼Œå®ƒä»¬éƒ½æ˜¯æŒ‡æ•°å‡½æ•°ï¼Œ<strong>åŒºåˆ«åœ¨äºæ•°æ®è§„æ¨¡ $n$ æ˜¯åº•æ•°è¿˜æ˜¯æŒ‡æ•°</strong>ï¼Œå¦‚æœæ•°æ®è§„æ¨¡ $n$ æ˜¯æŒ‡æ•°çš„è¯ï¼Œå¤æ‚åº¦ä¼šæ€¥å‰§ä¸Šå‡ï¼Œå‚è€ƒå‰æ–‡çš„ <a href="https://zh.wikipedia.org/wiki/NP_%28%E8%A4%87%E9%9B%9C%E5%BA%A6%29" target="_blank" rel="noopener noreffer ">NP é—®é¢˜</a></p>
<h3 id="åˆ†æè¿›é˜¶">åˆ†æè¿›é˜¶</h3>
<p>ä»¥ä¸Šéƒ½æ˜¯ä¸€äº›é€»è¾‘ç›¸å¯¹ç®€å•çš„ä¾‹å­ï¼Œæˆ‘ä»¬åœ¨å®é™…ç¼–å†™ç¨‹åºçš„æ—¶å€™ï¼Œé€šå¸¸ä¼šæœ‰ä¸€äº›æå‡æ•ˆç‡çš„æ“ä½œå’ŒæŠ€å·§ï¼Œè¿™ä¼šè®©æˆ‘ä»¬åœ¨åˆ†ææ—¶é—´å¤æ‚çš„è¿‡ç¨‹ä¸­è¦è€ƒè™‘çš„å› ç´ æ›´å¤šä¸€äº›ã€‚</p>
<p>å¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// array æ˜¯ä¸€ä¸ªæ•°ç»„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">find</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">array</span><span class="o">,</span> <span class="kt">int</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">array</span><span class="o">.</span><span class="na">length</span> <span class="o">-</span><span class="n">1</span> <span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="o">(</span><span class="n">array</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">==</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="n">i</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">		<span class="o">}</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="o">-</span><span class="n">1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// è¿™ä¸ªå‡½æ•°çš„é€»è¾‘æ˜¯æ‰¾å‡ºæ•°ç»„ array ä¸­ç›®æ ‡æ•°å€¼ x çš„ä¸‹æ ‡ä½ç½®ï¼Œå¦‚æœæ•°ç»„ä¸­æ²¡æœ‰ç›®æ ‡å€¼ x ï¼Œå°±è¿”å› -1
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ®µç¨‹åºæ˜¯åœ¨éå†æ•°ç»„ï¼Œä½†åˆä¸å®Œå…¨æ˜¯åœ¨éå†æ•°ç»„ã€‚å› ä¸ºå¾ªç¯ä¸­é—´çš„è¿™ä¸ª <code>return</code> å¯¼è‡´æˆ‘ä»¬ä¸å¾—ä¸æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœ <code>x</code> å°±åœ¨æ•°ç»„çš„ç¬¬ä¸€ä½ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å°±å¹¶ä¸ä¼šéå†æ•´ä¸ªæ•°ç»„ï¼Œè€Œæ˜¯åœ¨ç¬¬ä¸€æ¬¡å¾ªç¯å°±é€€å‡ºï¼Œè¿™ä¸ªæ—¶å€™æ—¶é—´å¤æ‚åº¦å°±æ˜¯ $O(1)$ï¼Œä½†æ˜¯å¦‚æœ <code>x</code> åœ¨æ•°ç»„ä¸­çš„æœ€åä¸€ä½ï¼Œæˆ–æ˜¯æ•°ç»„ä¸­æ ¹æœ¬ä¸å­˜åœ¨ <code>x</code>ï¼Œé‚£ä¹ˆå°±éœ€è¦éå†æ•´ä¸ªæ•°ç»„ï¼Œè¿™ä¸ªæ—¶å€™æ—¶é—´å¤æ‚åº¦å°±å˜æˆäº† $O(n)$ ï¼ˆ$n$ æ˜¯æ•°ç»„çš„é•¿åº¦ï¼‰</p>
<p>æ‰€ä»¥è¿™æ®µä»£ç åœ¨ä¸åŒæƒ…å†µä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ä¸ä¸€æ ·çš„ã€‚</p>
<p>ä¸ºäº†è¡¨ç¤ºä¸åŒæƒ…å†µä¸‹çš„æ—¶é—´å¤æ‚åº¦ï¼Œæˆ‘ä»¬éœ€è¦å†å¼•å…¥ä¸‰ä¸ªæ¦‚å¿µï¼š<strong>æœ€å¥½æ—¶é—´å¤æ‚åº¦</strong>ï¼Œ<strong>æœ€åæ—¶é—´å¤æ‚åº¦</strong>å’Œ<strong>å¹³å‡æ—¶é—´å¤æ‚åº¦</strong>ã€‚</p>
<h4 id="æœ€å¥½æœ€åæ—¶é—´å¤æ‚åº¦">æœ€å¥½/æœ€åæ—¶é—´å¤æ‚åº¦</h4>
<p><strong>æœ€å¥½å’Œæœ€åæ—¶é—´å¤æ‚åº¦</strong>æ¯”è¾ƒç®€å•ï¼Œé¡¾åæ€ä¹‰ï¼Œå®ƒä»¬<strong>åˆ†åˆ«è¡¨ç¤ºåœ¨æœ€ç†æƒ³å’Œæœ€ä¸ç†æƒ³çš„æƒ…å†µä¸‹ä»£ç çš„æ—¶é—´å¤æ‚åº¦</strong>ã€‚</p>
<p>å¯¹åº”ä¸Šè¿°çš„ä¾‹å­ï¼Œå°±æ˜¯ <code>x</code> åœ¨æ•°ç»„ç¬¬ä¸€ä½ï¼Œå’Œ <code>x</code> åœ¨æ•°ç»„æœ€åä¸€ä½æˆ–è€…ä¸åœ¨æ•°ç»„ä¸­çš„æƒ…å†µã€‚</p>
<h4 id="å¹³å‡æ—¶é—´å¤æ‚åº¦">å¹³å‡æ—¶é—´å¤æ‚åº¦</h4>
<p>å¾ˆæ˜æ˜¾ï¼Œæœ€ç†æƒ³å’Œæœ€ä¸ç†æƒ³çš„æƒ…å†µå‘ç”Ÿçš„æ¦‚ç‡éƒ½å¾ˆä½ï¼Œè¿™æ ·è¯„ä¼°å¤æ‚åº¦çš„è¯ï¼Œä¸å¤Ÿå‡†ç¡®ã€‚ä¸ºäº†æ›´å‡†ç¡®çš„è¯„ä¼°è¿™ç§æƒ…å†µä¸‹çš„æ—¶é—´å¤æ‚åº¦ï¼Œæˆ‘ä»¬å°±éœ€è¦å¦ä¸€ä¸ªæ¦‚å¿µï¼šå¹³å‡æ—¶é—´å¤æ‚åº¦ã€‚</p>
<p>è¿˜æ˜¯ä¸Šé¢é‚£ä¸ªä¾‹å­ï¼Œ<code>x</code> åœ¨æ•°ç»„ä¸­ä½ç½®çš„å¯èƒ½æ€§æœ‰ $n+1$ ç§æƒ…å†µï¼Œåˆ†åˆ«æ˜¯åœ¨æ•°ç»„ä¸­çš„ä»»æ„ä½ç½®å’Œä¸åœ¨æ•°ç»„ä¸­ã€‚æˆ‘ä»¬æŠŠæ¯ç§æƒ…å†µä¸‹éœ€è¦æ‰§è¡Œçš„æ¬¡æ•°åŠ èµ·æ¥ï¼Œå†é™¤ä»¥ $n+1$ å°±å¯ä»¥å¾—åˆ°å¹³å‡æƒ…å†µä¸‹çš„æ—¶é—´å¤æ‚åº¦ï¼š$$\frac{1+2+3+\cdots+n+n}{n+1}$$</p>
<p>æˆ‘ä»¬æŠŠè¿™ä¸ªå¼å­ç¨å¾®ç®€åŒ–ä¸€ä¸‹ï¼Œæˆ‘ä»¬çŸ¥é“ $1+2+3+\cdots+n=\frac{n(n+1)}{2}$ï¼ˆæ¨å¯¼è¿‡ç¨‹å¯ä»¥çœ‹<a href="https://zhuanlan.zhihu.com/p/88704434" target="_blank" rel="noopener noreffer ">è¿™é‡Œ</a>ï¼‰æ‰€ä»¥ï¼š$$\frac{1+2+\cdots n+n}{n+1}=\frac{n(n+1)/2+n}{n+1}=\frac{n(n+3)}{2(n+1)}$$</p>
<p>å¿½ç•¥å¸¸é‡å’Œç³»æ•°ä¹‹åå¯ä»¥çœ‹å‡ºï¼Œè¿™æ˜¯ä¸ªçº¿æ€§é˜¶çš„æ—¶é—´å¤æ‚åº¦ï¼ˆçœ‹ä¸å‡ºæ¥çš„è¯å¸¦å…¥å‡ ä¸ªæ•°ç®—ç®—ä¹Ÿè¡Œï¼‰ï¼Œä¹Ÿå°±æ˜¯ $O(n)$ï¼Œè¿™ä¸ªå°±æ˜¯å¹³å‡æ—¶é—´å¤æ‚åº¦ã€‚</p>
<p>ä½†æ˜¯è¿™æ ·è®¡ç®—å¹³å‡æ—¶é—´å¤æ‚åº¦ï¼Œè¿˜æ˜¯ä¸å¤Ÿå‡†ç¡®ï¼Œå› ä¸ºæ¯ç§æƒ…å†µå‡ºç°çš„æ¦‚ç‡å¹¶ä¸ä¸€æ ·ã€‚é¦–å…ˆä»å¤§æ–¹å‘ä¸Šçœ‹ï¼Œ <code>X</code> åªèƒ½æ˜¯åœ¨æˆ–ä¸åœ¨æ•°ç»„ä¸­ï¼Œè¿™ä¸¤ç§æƒ…å†µå‡†ç¡®çš„æ¦‚ç‡ç»Ÿè®¡èµ·æ¥å¹¶ä¸å®¹æ˜“ã€‚ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œæˆ‘ä»¬å°†å…¶æ¦‚ç‡åˆ†åˆ«å‡è®¾ä¸º <code>1/2</code> ï¼ŒåŒæ—¶ï¼Œ<code>x</code> åœ¨æ•°ç»„ä¸­ä¸åŒä½ç½®å‡ºç°çš„æ¦‚ç‡ä¹Ÿåˆ†åˆ«ä¸º <code>1/n</code>ï¼Œæ‰€ä»¥ï¼Œæ ¹æ®æ¦‚ç‡ä¹˜æ³•æ³•åˆ™ï¼Œ<code>x</code> å‡ºç°åœ¨æ•°ç»„ä¸­å„ä¸ªä¸åŒä½ç½®çš„æ¦‚ç‡ä¸ºï¼š$$\frac{1}{2}\star\frac{1}{n}=\frac{1}{2n}$$</p>
<p>ç„¶åï¼Œæˆ‘ä»¬å†å°†å„ç§æƒ…å†µçš„æ¦‚ç‡å› ç´ è€ƒè™‘è¿›å»ï¼Œå¹³å‡æ—¶é—´å¤æ‚åº¦çš„è®¡ç®—å°±å˜æˆäº†ï¼š$$1*\frac{1}{2n}+2*\frac{1}{2n}+\cdots+n*\frac{1}{2n}+n*\frac{1}{2}=\frac{3n+1}{4}$$
è¿™ä¸ªå€¼å°±æ˜¯æ¦‚ç‡è®ºä¸­çš„åŠ æƒå¹³å‡å€¼ï¼Œä¹Ÿå«åš<strong>æœŸæœ›å€¼</strong>ï¼Œæ‰€ä»¥æ›´å‡†ç¡®çš„å¹³å‡æ—¶é—´å¤æ‚åº¦ï¼Œåº”è¯¥å«åš<strong>åŠ æƒå¹³å‡æ—¶é—´å¤æ‚åº¦</strong>ï¼Œæˆ–è€…<strong>æœŸæœ›æ—¶é—´å¤æ‚åº¦</strong>ã€‚</p>
<p>$\frac{3n+1}{4}$å»æ‰å¸¸é‡å’Œç³»æ•°ä¹‹åï¼Œç”¨å¤§Oè¡¨è¾¾å¼æè¿°ï¼ŒåŠ ä¸Šæ¦‚ç‡ä¹‹åçš„å¹³å‡å¤æ‚åº¦è¿˜æ˜¯ $O(n)$ï¼Œæœ‰æ—¶ç®€å•å¹³å‡å’ŒåŠ æƒå¹³å‡å¤æ‚åº¦æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿæœ‰æ—¶ä¼šä¸ä¸€æ ·ã€‚</p>
<p>å¹³å‡æ—¶é—´å¤æ‚åº¦çš„è®¡ç®—æ–¹å¼ç¡®å®æœ‰äº›å¤æ‚ï¼Œä½†æ˜¯å¹³æ—¶ä½¿ç”¨å¾—å…¶å®å¹¶ä¸å¤šï¼Œå¤šæ•°æƒ…å†µä¸‹ä½¿ç”¨å•ä¸€å¤æ‚åº¦è¯„ä¼°å³å¯ã€‚</p>
<h4 id="å‡æ‘Šæ—¶é—´å¤æ‚åº¦">å‡æ‘Šæ—¶é—´å¤æ‚åº¦</h4>
<p>ä¸Šæ–‡æåˆ°ï¼Œåªæœ‰åœ¨ä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹æ‰éœ€è¦ä½¿ç”¨å¹³å‡æ—¶é—´å¤æ‚åº¦å»è¯„ä¼°ç¨‹åºï¼Œè€Œå‡æ‘Šæ—¶é—´å¤æ‚åº¦æ›´åŠ ç‰¹æ®Šï¼Œä½¿ç”¨åˆ°çš„æƒ…å†µæ›´å°‘ã€‚å¦‚ä¸‹ä»£ç ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// arrayè¡¨ç¤ºä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„ 
</span></span></span><span class="line"><span class="cl"><span class="c1">// ä»£ç ä¸­çš„array.lengthå°±ç­‰äºn 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span><span class="o">[]</span> <span class="n">array</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">n</span><span class="o">];</span> 
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> 
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">insert</span><span class="o">(</span><span class="kt">int</span> <span class="n">val</span><span class="o">)</span> <span class="o">{</span> 
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="o">(</span><span class="n">count</span> <span class="o">==</span> <span class="n">array</span><span class="o">.</span><span class="na">length</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">		<span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> 
</span></span><span class="line"><span class="cl">		<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">array</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span> 
</span></span><span class="line"><span class="cl">			<span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">array</span><span class="o">[</span><span class="n">i</span><span class="o">];</span> 
</span></span><span class="line"><span class="cl">		<span class="o">}</span> 
</span></span><span class="line"><span class="cl">		<span class="n">array</span><span class="o">[</span><span class="n">0</span><span class="o">]</span> <span class="o">=</span> <span class="n">sum</span><span class="o">;</span> 
</span></span><span class="line"><span class="cl">		<span class="n">count</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span> 
</span></span><span class="line"><span class="cl">	<span class="o">}</span> 
</span></span><span class="line"><span class="cl">	<span class="n">array</span><span class="o">[</span><span class="n">count</span><span class="o">]</span> <span class="o">=</span> <span class="n">val</span><span class="o">;</span> 
</span></span><span class="line"><span class="cl">	<span class="o">++</span><span class="n">count</span><span class="o">;</span> 
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ®µä»£ç å®ç°äº†ä¸€ä¸ªå¾€æ•°ç»„ä¸­æ’å…¥æ•°æ®çš„åŠŸèƒ½ã€‚å½“æ•°ç»„æ»¡äº†ä¹‹åï¼Œä¹Ÿå°±æ˜¯ä»£ç ä¸­çš„ <code>count == array.length</code> æ—¶ï¼Œæˆ‘ä»¬ç”¨ for å¾ªç¯éå†æ•°ç»„æ±‚å’Œï¼Œå¹¶æ¸…ç©ºæ•°ç»„ï¼Œå°†æ±‚å’Œä¹‹åçš„ <code>sum</code> å€¼æ”¾åˆ°æ•°ç»„çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼Œç„¶åå†å°†æ–°çš„æ•°æ®æ’å…¥ã€‚ä½†å¦‚æœæ•°ç»„ä¸€å¼€å§‹å°±æœ‰ç©ºé—²ç©ºé—´ï¼Œåˆ™ç›´æ¥å°†æ•°æ®æ’å…¥æ•°ç»„ã€‚</p>
<p>æˆ‘ä»¬åˆ†æä¸‹è¿™æ®µä»£ç çš„æœ€å¥½ã€æœ€åå’Œå¹³å‡æ—¶é—´å¤æ‚åº¦ã€‚</p>
<p>æœ€å¥½çš„æƒ…å†µå°±æ˜¯æ•°ç»„åˆšå¥½æœ‰ç©ºé—²ï¼Œäºæ˜¯ç›´æ¥æ’å…¥å³å¯ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ $O(1)$ï¼Œæœ€åçš„æƒ…å†µå°±æ˜¯åˆšå¥½  <code>count == array.length</code> ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦éå†æ•´ä¸ªæ•°ç»„ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ $O(n)$</p>
<p>ç„¶åæˆ‘ä»¬å†æ¥åˆ†æä¸€ä¸‹æœŸæœ›æ—¶é—´å¤æ‚åº¦ï¼Œè¿™é‡Œä¸€å…±æœ‰ <code>n+1</code> ç§æƒ…å†µï¼Œå…¶ä¸­æœ‰ç©ºä½çš„ç§æƒ…å†µæœ‰ n ç§çš„ï¼Œæ²¡æœ‰ç©ºä½çš„æƒ…å†µæœ‰ä¸€ç§ï¼Œè€Œä¸”æ¯ç§æƒ…å†µå‡ºç°çš„æ¦‚ç‡éƒ½æ˜¯ <code>n+1</code>ï¼Œå› æ­¤ï¼ŒæœŸæœ›æ—¶é—´å¤æ‚åº¦ä¸ºï¼š
$$1*\frac{1}{n+1}+1*\frac{1}{n+1}+\cdots+1*\frac{1}{n+1}+n*\frac{1}{n+1}=\frac{2n}{n+1}$$
çœç•¥ç³»æ•°å’Œå¸¸é‡ä¹‹åï¼Œå°±æ˜¯ $O(1)$</p>
<p>ä½†æ˜¯è¿™ä¸ªä¾‹å­ä¸­åˆ†æå¹³å‡æ—¶é—´å¤æ‚åº¦ï¼Œå…¶å®å¹¶ä¸éœ€è¦è¿™ä¹ˆå¤æ‚çš„è®¡ç®—ï¼Œä¸ºä»€å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å¯¹æ¯”ä¸€ä¸‹è¿™ä¸¤ä¸ªä¾‹å­ï¼Œä¼šå‘ç°ä¸¤ä¸ªå¾ˆå¤§çš„åŒºåˆ«ï¼š</p>
<ol>
<li><code>find()</code> å‡½æ•°ä¸­ï¼Œåªæœ‰åœ¨æå°‘æ•°æœ€ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦æ‰ä¼šæ˜¯ $O(1)$ï¼Œè€Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ $O(n)$ï¼Œä½†æ˜¯ <code>insert()</code> å‡½æ•°å¾ˆä¸ä¸€æ ·ï¼Œåœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ $O(1)$ï¼Œåªæœ‰åœ¨æå°‘æ•°çš„æœ€ä¸ç†æƒ³æƒ…å†µä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦æ‰ä¼šæ˜¯ $O(n)$</li>
<li><code>insert()</code> å‡½æ•°ä¸­ $O(n)$ æ“ä½œå’Œ $O(1)$ æ“ä½œæœ‰å¾ˆå¼ºçš„è§„å¾‹æ€§å’Œé¡ºåºæ€§ï¼šæ¯ä¸€æ¬¡ $O(n)$ çš„æ’å…¥æ“ä½œä¹‹åï¼Œç´§æ¥ç€ $n-1$ æ¬¡çš„ $O(1)$ æ’å…¥æ“ä½œï¼Œå¦‚æ­¤å¾ªç¯</li>
</ol>
<p>é’ˆå¯¹è¿™ç§æ›´åŠ ç‰¹æ®Šçš„æƒ…å†µï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸€ç§æ›´åŠ æ–¹æ³•çš„åˆ†ææ–¹æ³•ï¼š<strong>æ‘Šè¿˜åˆ†ææ³•</strong>ï¼Œé€šè¿‡è¿™ç§æ–¹æ³•åˆ†æå¾—å‡ºçš„æ—¶é—´å¤æ‚åº¦æˆ‘ä»¬ç§°ä¹‹ä¸ºï¼š<strong>æ‘Šè¿˜æ—¶é—´å¤æ‚åº¦</strong>ã€‚</p>
<p>è¿™ç§åˆ†ææ–¹æ³•çš„æ ¸å¿ƒæ€è·¯æ˜¯ <strong>åˆ†ç»„</strong>ã€‚</p>
<p>æˆ‘ä»¬çœ‹è¿™ä¸ªä¾‹å­ï¼Œæ¯ä¸€æ¬¡ $O(n)$ å¤æ‚åº¦çš„æ’å…¥æ“ä½œä¹‹åï¼Œç´§æ¥ç€ $n-1$ æ¬¡ $O(1)$ å¤æ‚åº¦çš„æ’å…¥æ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬æŠŠè¿™ n æ¬¡æ“ä½œåˆ†æˆä¸€ç»„ï¼Œå°†ç¬¬ä¸€æ¬¡ $O(n)$ è€—æ—¶å¤šçš„æ“ä½œä¸­æ¶ˆè€—çš„æ—¶é—´ï¼Œå‡æ‘Šåˆ°åé¢ $n-1$ è€—æ—¶å°‘çš„æ“ä½œä¸­ï¼Œè¿™æ ·ä¸€ç»„è¿ç»­æ“ä½œä¸‹æ¥å‡æ‘Šçš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯ $O(1)$ã€‚è¿™å°±æ˜¯æ‘Šè¿˜åˆ†ææ–¹æ³•çš„å¤§è‡´æ€è·¯ã€‚</p>
<p>æ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼Œåœ¨ä¸€ä¸ªç¨‹åºä¸­ï¼Œå¤§éƒ¨åˆ†æ—¶å€™æ—¶é—´å¤æ‚åº¦éƒ½å¾ˆä½ï¼Œåªæœ‰æå°‘æ•°æ—¶å€™æ—¶é—´å¤æ‚åº¦æ¯”è¾ƒé«˜ï¼Œè€Œä¸”è¿™äº›æ“ä½œä¹‹é—´å­˜åœ¨å¾ˆå¼ºçš„é¡ºåºå…³ç³»ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥æŠŠè¿™ä¸ªç¨‹åºçš„æ“ä½œè¿›è¡Œåˆ†ç»„ï¼Œå°†è€—æ—¶å¤šçš„æƒ…å†µä¸‹å¤šæ¶ˆè€—çš„æ—¶é—´ï¼Œå‡æ‘Šåˆ°è€—æ—¶å°‘çš„æƒ…å†µä¸­å»ï¼Œè¿™æ ·å°±èƒ½æ›´å¿«çš„å¾—åˆ°è¿™ä¸ªç¨‹åºçš„æ—¶é—´å¤æ‚åº¦ã€‚</p>
<p>ä»è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½çœ‹å‡ºæ¥ï¼Œ<strong>åœ¨èƒ½å¤Ÿä½¿ç”¨æ‘Šè¿˜åˆ†ææ–¹æ³•çš„åœºæ™¯ä¸­ï¼Œä¸€èˆ¬å‡æ‘Šæ—¶é—´å¤æ‚åº¦å°±ç­‰äºæœ€å¥½æ—¶é—´å¤æ‚åº¦</strong>ã€‚</p>
<p>é€šè¿‡ä¸Šè¿°å¹³å‡æ—¶é—´å¤æ‚åº¦å’Œå‡æ‘Šæ—¶é—´å¤æ‚åº¦çš„ä¸¤ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬èƒ½çœ‹å‡ºæ¥ï¼Œå¹³å‡æ—¶é—´å¤æ‚åº¦æ˜¯åˆ†æç¨‹åºæ—¶é—´å¤æ‚åº¦çš„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œè€Œå‡æ‘Šæ—¶é—´å¤æ‚åº¦åˆæ˜¯å¹³å‡æ—¶é—´å¤æ‚åº¦çš„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œå› æ­¤ï¼Œä¼šç”¨åˆ°å‡æ‘Šæ—¶é—´å¤æ‚åº¦çš„åœºåˆå°±æ›´å°‘äº†ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬é‡ç‚¹æ˜¯è¦çŸ¥é“è¿™ç§åˆ†ææ€è·¯ï¼Œå¹¶ä¸ç”¨èŠ±å¤ªå¤šç²¾åŠ›åœ¨å»åŒºåˆ†å’Œè®°å¿†ã€‚</p>
<p>ä¸Šæ–‡èŠ±äº†å¾ˆé•¿çš„ç¯‡å¹…è®²äº†æ—¶é—´å¤æ‚åº¦åˆ†æï¼Œç†è§£äº†è¿™äº›å†…å®¹ï¼Œä¸‹é¢æˆ‘ä»¬å†æ¥åˆ†æç©ºé—´å¤æ‚åº¦ï¼Œå°±ç®€å•å¾ˆå¤šäº†ã€‚</p>
<h2 id="ç©ºé—´å¤æ‚åº¦åˆ†æ">ç©ºé—´å¤æ‚åº¦åˆ†æ</h2>
<p>åˆ†æç©ºé—´å¤æ‚åº¦å’Œåˆ†ææ—¶é—´å¤æ‚åº¦çš„æ¡†æ¶æ˜¯ä¸€è‡´çš„ï¼Œéƒ½æ˜¯ä½¿ç”¨å¤§ O è¡¨è¾¾å¼ï¼Œä¹Ÿéƒ½æ˜¯è¡¨ç¤ºæ•°æ®è§„æ¨¡ä¸å¤æ‚åº¦ä¹‹é—´çš„è¶‹åŠ¿å…³ç³»ã€‚é‚£ä¹ˆï¼Œç±»æ¯”ä¸€ä¸‹ï¼Œç©ºé—´å¤æ‚åº¦å…¨ç§°å°±æ˜¯<strong>æ¸è¿›ç©ºé—´å¤æ‚åº¦</strong>ï¼ˆasymptotic space complexityï¼‰ï¼Œ<strong>è¡¨ç¤ºç®—æ³•æ¶ˆè€—çš„å­˜å‚¨ç©ºé—´ä¸æ•°æ®è§„æ¨¡ä¹‹é—´çš„å¢é•¿å…³ç³»</strong>ã€‚</p>
<p>ç©ºé—´å¤æ‚åº¦åˆ†æç›¸è¾ƒäºæ—¶é—´å¤æ‚åº¦åˆ†æï¼Œè¦ç®€å•å¾ˆå¤šã€‚çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">print</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span><span class="o">[]</span> <span class="n">array</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">n</span><span class="o">];</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">-</span><span class="n">1</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">array</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">)(</span><span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()*</span><span class="n">100</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">-</span><span class="n">1</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">array</span><span class="o">[</span><span class="n">j</span><span class="o">]);</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ®µä»£ç æ˜¯å°†ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•°ç»„ç”¨ 100 ä»¥å†…çš„éšæœºæ•°å¡«æ»¡ï¼Œç„¶åå†éå†è¾“å‡ºã€‚</p>
<p>åœ¨ç©ºé—´ä½¿ç”¨æ–¹é¢ï¼Œé™¤äº†ç¬¬äºŒè¡Œç”³è¯·äº†ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•°ç»„ arrayï¼Œå…¶ä»–æ“ä½œå‡æ²¡æœ‰æ¶‰åŠï¼Œå› æ­¤è¿™æ®µä»£ç çš„ç©ºé—´å¤æ‚åº¦å’Œ n çš„å¤§å°æˆæ­£æ¯”ï¼Œä¹Ÿå°±æ˜¯ $O(n)$</p>
<p>å¸¸ç”¨çš„ç©ºé—´å¤æ‚åº¦æ¯”å¸¸ç”¨çš„æ—¶é—´å¤æ‚åº¦ä¹Ÿå°‘å¾ˆå¤šï¼Œä¸€èˆ¬å°±æ˜¯ $O(1)$ã€ $O(n)$ã€ $O(n^2)$ è¿™ä¸‰ç§ã€‚å¦‚æœç¢°åˆ°ç‰¹æ®Šæƒ…å†µï¼Œä½¿ç”¨åˆ†ææ—¶é—´å¤æ‚åº¦çš„æ€è·¯å»åˆ†æå³å¯ã€‚</p>
<blockquote>
<p>æœ¬æ–‡ä¸»è¦å‚è€ƒ<a href="https://time.geekbang.org/column/intro/100017301" target="_blank" rel="noopener noreffer ">ã€Šæ•°æ®ç»“æ„ä¸ç®—æ³•ä¹‹ç¾ã€‹</a>å’Œç»´åŸºç™¾ç§‘ã€‚</p>
</blockquote>
]]></description>
</item>
<item>
    <title>Redis åˆ†å¸ƒå¼é«˜å¯ç”¨ç»ˆææŒ‡å—</title>
    <link>https://asimov.top/the-ultimate-guide-to-redis-distributed-high-availability/</link>
    <pubDate>Tue, 20 Oct 2020 22:19:32 &#43;0800</pubDate>
    <author>asimov</author>
    <guid>https://asimov.top/the-ultimate-guide-to-redis-distributed-high-availability/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="https://www.mortensi.com/wp-content/uploads/2021/12/OSS-Cluster-background.png" referrerpolicy="no-referrer">
            </div><p>æœ€è¿‘é¡¹ç›®ä¸Šéœ€è¦ç”¨åˆ° redis é«˜å¯ç”¨æ–¹æ¡ˆï¼Œé‚ä¸Šç½‘æ‰¾äº†ä¸€äº›èµ„æ–™å­¦ä¹ ï¼Œä½†æ˜¯ç½‘ä¸Šå…³äº redis é«˜å¯ç”¨çš„å‡ ç§å®ç°æ–¹å¼æˆ–å£å¾„ä¸ä¸€ï¼Œæˆ–å«ç³Šä¸æ¸…ï¼Œæˆ–ç¼ºæ–¤å°‘ä¸¤ã€‚ç»å†äº†å¤šæ–¹èµ„æ–™å­¦ä¹ å’Œå®é™…éªŒè¯ï¼Œæœ¬æ–‡è¯•å›¾å°† redis åˆ†å¸ƒå¼å’Œé›†ç¾¤æ–¹æ¡ˆä»æ¦‚å¿µç†è§£åˆ°æŠ€æœ¯é€‰å‹åˆ°æ­å»ºä½¿çš„æ•´ä¸ªè¿‡ç¨‹ç”¨æœ€ç®€å•çš„è¯­è¨€è®²è¿°æ¸…æ¥šã€‚</p>
<h2 id="åˆ†å¸ƒå¼ä¸é›†ç¾¤">åˆ†å¸ƒå¼ä¸é›†ç¾¤</h2>
<p>ä¸‹æ–‡ä¼šæ¶‰åŠåˆ°å¤§é‡çš„åˆ†å¸ƒå¼å’Œé›†ç¾¤æœ¯è¯­ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆæ¥å¤ä¹ ä¸€ä¸‹é›†ç¾¤å’Œåˆ†å¸ƒå¼çš„æ¦‚å¿µï¼ŒåŠ æ·±ä¸€ä¸‹ç†è§£ã€‚</p>
<p>ç›®å‰çš„é¡¹ç›®å¾ˆå°‘ä¼šé‡‡ç”¨å•æœºæ¶æ„äº†ï¼Œä¸€æ˜¯å› ä¸ºå•æœºæ€§èƒ½æœ‰é™ï¼ŒäºŒæ˜¯å› ä¸ºå•æœºæœåŠ¡ä¸€æ—¦æ•…éšœæ•´ä¸ªç³»ç»Ÿå°±æ— æ³•ç»§ç»­æä¾›æœåŠ¡äº†ã€‚æ‰€ä»¥ç›®å‰é›†ç¾¤å’Œåˆ†å¸ƒå¼çš„æ¶æ„ä½¿ç”¨å¾—å¾ˆå¹¿æ³›ï¼Œä¸»è¦å°±æ˜¯ä¸ºäº†è§£å†³ä¸Šè¿°ä¸¤ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªæ€§èƒ½é—®é¢˜ï¼Œä¸€ä¸ªæ•…éšœé—®é¢˜ï¼Œ<strong>é€šè¿‡åˆ†å¸ƒå¼æ¶æ„è§£å†³æ€§èƒ½ï¼ˆé«˜å¹¶å‘ï¼‰é—®é¢˜ï¼Œé€šè¿‡é›†ç¾¤æ¶æ„è§£å†³æ•…éšœæœåŠ¡ï¼ˆé«˜å¯ç”¨ï¼‰é—®é¢˜ã€‚</strong></p>
<h3 id="åˆ†å¸ƒå¼æ¶æ„">åˆ†å¸ƒå¼æ¶æ„</h3>
<blockquote>
<p>åˆ†å¸ƒå¼ï¼šä¸€ä¸ªä¸šåŠ¡åˆ†æ‹†å¤šä¸ªå­ä¸šåŠ¡ï¼Œéƒ¨ç½²åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Š</p>
</blockquote>
<p>ç½‘ä¸Šå¾ˆå¤šæ–‡ç« æŠŠåˆ†å¸ƒå¼æ¶æ„è¯´å¾—å¾ˆå¤æ‚ï¼Œä½†éƒ½æ²¡æœ‰åˆ‡ä¸­å…³é”®ï¼Œå…¶å®ç†è§£èµ·æ¥å¾ˆç®€å•ï¼Œæ‰€æœ‰çš„è®¡ç®—æœºç³»ç»Ÿéƒ½æ˜¯ä¸ºä¸šåŠ¡æœåŠ¡çš„ï¼Œå°†åŒä¸€ä¸ªä¸šåŠ¡æ‹†åˆ†æˆå¤šä¸ªå­ä¸šåŠ¡ï¼Œå„ä¸ªå­ä¸šåŠ¡éƒ¨ç½²åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œè¿™å°±æ˜¯åˆ†å¸ƒå¼æ¶æ„ï¼Œé€šè¿‡å°†ä¸šåŠ¡æ‹†ç»†ï¼Œä¸ºä¸åŒçš„å­ä¸šåŠ¡é…ç½®ä¸åŒæ€§èƒ½çš„æœåŠ¡å™¨ï¼Œæé«˜æ•´ä¸ªç³»ç»Ÿçš„æ€§èƒ½ã€‚<em>æˆ‘ä¸ªäººè®¤ä¸ºç›®å‰å¾ˆç«çš„å¾®æœåŠ¡æ¦‚å¿µå…¶å®æœ¬è´¨ä¸Šå°±æ˜¯åˆ†å¸ƒå¼ã€‚</em></p>
<p>æŒ‰ç…§ç±»å‹å¤§è‡´å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼š<strong>åˆ†å¸ƒå¼è®¡ç®—</strong>å’Œ<strong>åˆ†å¸ƒå¼å­˜å‚¨</strong>ã€‚</p>
<p>åˆ†å¸ƒå¼è®¡ç®—å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯å°†å¤§é‡è®¡ç®—ä»»åŠ¡åˆ†é…åˆ°å¤šä¸ªè®¡ç®—å•å…ƒä¸Šä»¥æé«˜æ€»è®¡ç®—æ€§èƒ½ã€‚ä¾‹å¦‚æš´åŠ›ç ´è§£æŸä¸ªå¯†ç éœ€è¦éå†æŸä¸ªå­—ç¬¦ç»„åˆ10ä¸‡æ¬¡ï¼Œå‡è®¾ä¸€å°è®¡ç®—æœºéœ€è¦10åˆ†é’Ÿï¼Œé‚£ä¹ˆ10å°è®¡ç®—æœºåŒæ—¶éå†ï¼Œæ¯å°éå†1ä¸‡æ¬¡ï¼Œæœ€åå°†ç»“æœæ±‡æ€»ï¼Œé‚£ä¹ˆå°±åªéœ€è¦1åˆ†é’Ÿã€‚è¿™10å°è®¡ç®—æœºç»„åˆèµ·æ¥å°±æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼è®¡ç®—ç³»ç»Ÿï¼Œè¿™é‡Œçš„ä¸šåŠ¡å°±æ˜¯è®¡ç®—ã€‚</p>
<p>åŒç†ï¼Œåˆ†å¸ƒå¼å‚¨å­˜ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯å°†å¤§é‡æ•°æ®åˆ†é…åˆ°å¤šä¸ªå‚¨å­˜å•å…ƒä¸Šä»¥æé«˜æ€»å­˜å‚¨é‡ã€‚ä¾‹å¦‚100ZBçš„æ•°æ®ä¸€ä¸ªå‚¨å­˜å•å…ƒæ”¾ä¸ä¸‹ï¼Œé‚£å°±æ‹†æˆ100ä»½ï¼Œæ¯ä¸ªå‚¨å­˜å•å…ƒå­˜1ä»½ï¼Œé‚£ä¹ˆè¿™100ä¸ªå­˜å‚¨å•å…ƒç»„åˆèµ·æ¥å°±æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼å‚¨å­˜ç³»ç»Ÿï¼Œè¿™é‡Œçš„ä¸šåŠ¡å°±æ˜¯å­˜å‚¨ã€‚ç›®å‰ä¸»æµçš„å…³ç³»å‹æ•°æ®åº“éƒ½æœ‰æ¯”è¾ƒæˆç†Ÿçš„åˆ†å¸ƒå¼å­˜å‚¨æ–¹æ¡ˆï¼Œå¦‚ MySQL çš„ MySQL Fabricã€MyCat ç­‰ï¼ŒOracle Database æœ‰Oracle Sharding ç­‰ã€‚Redis ä½œä¸ºæµè¡Œçš„éå…³ç³»å‹æ•°æ®åº“ï¼Œç”±äºæ˜¯å†…å­˜æ•°æ®åº“ï¼Œç†è®ºä¸Šä¸€èˆ¬ä¸ä¼šåœ¨ Redis ä¸­å­˜æ”¾å¤ªå¤šçš„æ•°æ®ï¼Œä½†æ˜¯åœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹è¿˜æ˜¯ä¼šæœ‰å‚¨å­˜ç©ºé—´ä¸å¤Ÿçš„æƒ…å†µï¼Œæˆ–è€…éœ€è¦é¢„é˜²å‚¨å­˜ç©ºé—´ä¸å¤Ÿçš„æƒ…å†µå‘ç”Ÿï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ Redis åˆ†å¸ƒå¼æ¶æ„äº†ã€‚</p>
<p>ä¾‹å¦‚æŸé›†å›¢ä¸‹æœ‰å¾ˆå¤šçš„å­å…¬å¸ï¼Œæ¯ä¸ªå­å…¬å¸éƒ½æœ‰å¤šå¥— IT ç³»ç»Ÿï¼Œå…¶ä¸­å¾ˆå¤š IT ç³»ç»Ÿéƒ½æ˜¯éœ€è¦ä½¿ç”¨ Redis çš„ï¼Œé›†å›¢ä¸ºäº†ç»Ÿä¸€ç®¡ç†ï¼Œæ­å»ºäº†ä¸€å¥—ä¸­å¤® Redis ç³»ç»Ÿï¼Œè¦æ±‚æ‰€æœ‰å­å…¬å¸ä¸‹çš„ IT ç³»ç»Ÿç»Ÿä¸€ä½¿ç”¨é›†å›¢çš„ä¸­å¤® Redis åº“ï¼Œè¿™ä¸ªæ—¶å€™å³ä½¿å½“å‰å‚¨å­˜å®¹é‡å¤Ÿç”¨ï¼Œä½†æ˜¯ä¸ºäº†åº”å¯¹åæœŸå‘å±•å°±å¿…é¡»ä½¿ç”¨åˆ°åˆ†å¸ƒå¼å‚¨å­˜ï¼Œå› ä¸ºåˆ†å¸ƒå¼æ¶æ„ç†è®ºä¸Šéƒ½æ”¯æŒæ— é™æ°´å¹³æ‹“å±•ã€‚</p>
<h3 id="é›†ç¾¤æ¶æ„">é›†ç¾¤æ¶æ„</h3>
<blockquote>
<p>é›†ç¾¤ï¼šåŒä¸€ä¸ªä¸šåŠ¡ï¼Œéƒ¨ç½²åœ¨å¤šä¸ªæœåŠ¡å™¨ä¸Š</p>
</blockquote>
<p>é›†ç¾¤åŒæ ·ä¹Ÿéå¸¸å¥½ç†è§£ï¼Œå°±æ˜¯åœ¨å¤šä¸ªæœåŠ¡å™¨ä¸Šéƒ¨ç½²åŒä¸€ä¸ªä¸šåŠ¡ï¼Œè¿™æ ·å¯ä»¥èµ·åˆ°ä¸¤ä¸ªä½œç”¨ï¼š</p>
<ol>
<li>åˆ†æ•£æ¯å°æœåŠ¡å™¨çš„å‹åŠ›</li>
<li>ä»»æ„ä¸€å°æˆ–è€…å‡ å°æœåŠ¡å™¨å®•æœºä¹Ÿä¸ä¼šå½±å“æ•´ä¸ªç³»ç»Ÿ</li>
</ol>
<p>ä¾‹å¦‚ä¸€ä¸ªå…¸å‹çš„ Web é›†ç¾¤æœåŠ¡æ¶æ„å›¾å¦‚ä¸‹ï¼š</p>
<p></p>
<p>è¿™é‡Œä¸‰ä¸ª Web Server æœåŠ¡å™¨å®é™…ä¸Šéƒ½æ˜¯è¿è¡Œç€åŒä¸€å¥—ä¸šåŠ¡ï¼Œä½†æ˜¯ä¸‰å°æœåŠ¡å™¨å°±å¯ä»¥æ˜¾è‘—åˆ†æ•£å•å°æœåŠ¡å™¨å‹åŠ›ï¼Œå¹¶ä¸”ä»»æ„ä¸€å°å®•æœºä¹Ÿä¸ä¼šå¯¼è‡´æ— æ³•æä¾›æœåŠ¡ã€‚</p>
<h3 id="åˆ†å¸ƒå¼ä¸é›†ç¾¤çš„å…³ç³»">åˆ†å¸ƒå¼ä¸é›†ç¾¤çš„å…³ç³»</h3>
<p>åˆ†å¸ƒå¼å’Œé›†ç¾¤åŒºåˆ«å¾ˆå¥½ç†è§£ï¼Œç”¨ä¸‹é¢ä¸€å¼ å›¾è¡¨ç¤ºï¼š</p>
<p></p>
<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯åˆ†å¸ƒå¼ä¸ä¸€å®šèƒ½ç”¨ä¸Šï¼Œä½†æ˜¯é›†ç¾¤ä¸€èˆ¬éƒ½æ˜¯éœ€è¦çš„ã€‚å› ä¸ºä¸æ˜¯æ‰€æœ‰ç³»ç»Ÿéƒ½éœ€è¦åº”å¯¹é«˜å¹¶å‘åœºæ™¯ï¼Œä½†é«˜å¯ç”¨æ˜¯ä¸€ä¸ªç³»ç»Ÿèƒ½å¤Ÿé•¿æœŸç¨³å®šè¿è¡ŒåŸºæœ¬ä¿éšœã€‚å› æ­¤ç”¨åˆ°åˆ†å¸ƒå¼æ¶æ„çš„ç³»ç»ŸåŸºæœ¬ä¸Šéƒ½ä¼šç”¨åˆ°é›†ç¾¤ï¼Œè€Œç”¨é›†ç¾¤æ¶æ„çš„ç³»ç»Ÿå´ä¸ä¸€å®šä¼šç”¨åˆ°åˆ†å¸ƒå¼ã€‚</strong></p>
<h2 id="redis-éƒ¨ç½²æŒ‡å—">Redis éƒ¨ç½²æŒ‡å—</h2>
<h3 id="å•èŠ‚ç‚¹æ–¹æ¡ˆredis-standalone">å•èŠ‚ç‚¹æ–¹æ¡ˆï¼šRedis Standalone</h3>
<h4 id="åŸç†ç®€ä»‹">åŸç†ç®€ä»‹</h4>
<p>è¿™æ˜¯æœ€ç®€å•çš„ redis éƒ¨ç½²æ–¹æ¡ˆï¼Œæ‰€æœ‰æ•°æ®å­˜å‚¨å’Œè¯»å†™æ“ä½œéƒ½åœ¨åŒä¸€ä¸ª redis æœåŠ¡ä¸Šã€‚</p>
<p>è¿™ç§æ–¹å¼ä¼˜ç‚¹å¾ˆæ˜æ˜¾ï¼šéƒ¨ç½²ç®€å•ï¼Œæ— è®ºæ˜¯éƒ¨ç½²æˆæœ¬è¿˜æ˜¯è¿ç»´æˆæœ¬éƒ½å¾ˆä½ï¼Œæœ¬åœ°æµ‹è¯•æ—¶æœ€å¸¸è§ä¹Ÿæ˜¯æœ€æ–¹ä¾¿çš„æ–¹å¼ã€‚</p>
<p>ä½†åŒæ—¶ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼šä¸èƒ½å®ç°é«˜å¯ç”¨ï¼Œä¹Ÿä¸èƒ½åº”å¯¹é«˜å¹¶å‘åœºæ™¯ï¼Œä¹Ÿæ— æ³•è½»æ˜“æ°´å¹³æ‹“å±•ï¼Œæ•°æ®å‚¨å­˜é‡å¾ˆå®¹æ˜“è§é¡¶ã€‚</p>
<h4 id="éƒ¨ç½²å®ä¾‹">éƒ¨ç½²å®ä¾‹</h4>
<p>å•èŠ‚ç‚¹æ¨¡å¼çš„éƒ¨ç½²æ˜¯æœ€ç®€å•çš„ï¼Œä¸€ä¸‹æ˜¯ Linux ç³»ç»Ÿä¸‹éƒ¨ç½²å•èŠ‚ç‚¹ redis çš„æ–¹æ³•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># ä¸‹è½½ Redis äºŒè¿›åˆ¶å®‰è£…åŒ…ï¼š</span>
</span></span><span class="line"><span class="cl">wget http://download.redis.io/releases/redis-5.0.4.tar.gz
</span></span><span class="line"><span class="cl"><span class="c1"># è§£å‹äºŒè¿›åˆ¶åŒ…</span>
</span></span><span class="line"><span class="cl">tar â€“zxvf redis-5.0.4.tar.gz
</span></span><span class="line"><span class="cl"><span class="c1"># è¿›å…¥è§£å‹æ–‡ä»¶å¤¹å¹¶ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> redis-5.0.4
</span></span><span class="line"><span class="cl">make
</span></span><span class="line"><span class="cl"><span class="c1"># å®‰è£…</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> src
</span></span><span class="line"><span class="cl">make <span class="nb">test</span>
</span></span><span class="line"><span class="cl">make install
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨ make install å’Œ make test çš„æ—¶å€™å¯èƒ½ä¼šé‡åˆ°ä¸‹é¢è¿™ä¸ªé—®é¢˜ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">You need tcl 8.5 or newer in order to run the Redis <span class="nb">test</span>
</span></span><span class="line"><span class="cl">make: *** <span class="o">[</span>test<span class="o">]</span> Error <span class="m">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ˜¯å› ä¸ºç³»ç»Ÿä¸­çš„ TCL è¯­è¨€ç‰ˆæœ¬å¤ªä½ï¼ŒTCL è¯­è¨€æ˜¯ä¸€ç§å·¥å…·è„šæœ¬è¯­è¨€ï¼Œåœ¨å®‰è£… Redis çš„è¿‡ç¨‹ä¸­ make test å‘½ä»¤éœ€è¦ç”¨åˆ°è¿™ä¸ªè„šæœ¬è¯­è¨€ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦å‡çº§ä¸€ä¸‹ç³»ç»Ÿä¸­çš„ TCL ç‰ˆæœ¬ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># ä¸‹è½½ä¸€ä¸ªé«˜äº 8.5 ç‰ˆæœ¬çš„ TCL å®‰è£…åŒ…ï¼Œæ¯”å¦‚ 8.6.8</span>
</span></span><span class="line"><span class="cl">wget http://downloads.sourceforge.net/tcl/tcl8.6.8-src.tar.gz
</span></span><span class="line"><span class="cl"><span class="c1"># è§£å‹</span>
</span></span><span class="line"><span class="cl">tar -zxvf tcl8.6.8-src.tar.gz  -C /usr/local/  
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ‡æ¢åˆ°è§£å‹åçš„æºç ç›®å½•</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span>  /usr/local/tcl8.6.8/unix/
</span></span><span class="line"><span class="cl"><span class="c1"># ç¼–è¯‘å’Œå®‰è£…</span>
</span></span><span class="line"><span class="cl">sudo ./configure  
</span></span><span class="line"><span class="cl">sudo make  
</span></span><span class="line"><span class="cl">sudo make install
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‡çº§ TCL åˆ° 8.5 ç‰ˆæœ¬ä»¥åï¼Œç»§ç»­æ‰§è¡Œä¹‹å‰æŠ¥é”™çš„è¯­å¥ï¼Œå®Œæˆ Redis çš„å®‰è£…ï¼Œå®‰è£…å®Œæˆåç”¨ <code>redis-server -v</code> éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸï¼Œè‹¥æˆåŠŸè¾“å‡ºå¦‚ä¸‹ç‰ˆæœ¬ä¿¡æ¯åˆ™ä»£è¡¨å®‰è£…æˆåŠŸï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">Redis server <span class="nv">v</span><span class="o">=</span>5.0.4
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®‰è£…æˆåŠŸå°±å¯ä»¥ç›´æ¥è¿è¡Œäº†ï¼Œä½†æ˜¯é»˜è®¤é…ç½®ä¸‹æ˜¯ä¸æ”¯æŒåå°è¿è¡Œçš„ï¼Œè§‚ç‚¹å‘½ä»¤çª—å£å°±ä¼šç»“æŸ redis è¿›ç¨‹ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸è¡Œçš„ã€‚æ‰€ä»¥æˆ‘ä»¬å†ç®€å•æ”¹ä¸€ä¸‹ redis çš„é…ç½®ï¼Œè®©å…¶èƒ½å¤Ÿç›´æ¥åå°è¿è¡Œã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># è¿›å…¥åˆ° redis çš„å®‰è£…ç›®å½•ï¼Œç¼–è¾‘ redis.conf</span>
</span></span><span class="line"><span class="cl">vim /usr/redis/redis-5.0.4/redis.conf
</span></span><span class="line"><span class="cl"><span class="c1"># å°† daemonize no ä¿®æ”¹æˆ daemonize yes ï¼ˆä½¿ redis æœåŠ¡å¯ä»¥åœ¨åå°è¿è¡Œï¼‰</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åœ¨æŒ‡å®šé…ç½®ä¸‹è¿è¡ŒredisæœåŠ¡</span>
</span></span><span class="line"><span class="cl">/usr/local/bin/redis-server /usr/redis/redis-5.0.4/redis.conf 
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹redisè¿è¡Œæƒ…å†µ</span>
</span></span><span class="line"><span class="cl">ps -ef <span class="p">|</span> grep redis
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¾“å‡º</span>
</span></span><span class="line"><span class="cl">app	  <span class="m">21794</span>   <span class="m">1</span>  <span class="m">0</span> Jan28 ?  03:31:25 ./redis-server *:6379
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ° redis åœ¨é»˜è®¤çš„ 6379 ç«¯å£ä¸‹è¿è¡Œï¼Œé…ç½®æ–‡ä»¶ä¸­è¿˜æœ‰ä¸€äº›å¯ä»¥è°ƒæ•´çš„åœ°æ–¹ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ã€‚</p>
<p>é‚£ä¹ˆå•èŠ‚ç‚¹æ¨¡å¼ redis æœåŠ¡å°±éƒ¨ç½²å®Œæˆäº†</p>
<h3 id="redis-é«˜å¯ç”¨æ–¹æ¡ˆredis-sentinel">Redis é«˜å¯ç”¨æ–¹æ¡ˆï¼šRedis Sentinel</h3>
<h4 id="åŸç†ç®€ä»‹-1">åŸç†ç®€ä»‹</h4>
<p><strong>Redis Sentinel æ˜¯ Redis å®˜æ–¹æ¨èçš„é«˜å¯ç”¨æ€§(HA)è§£å†³æ–¹æ¡ˆï¼Œè¿™æ˜¯ç”Ÿäº§ç¯å¢ƒä¸­æœ€å®ç”¨ä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„æ–¹æ¡ˆã€‚</strong></p>
<p>è¿™é‡Œæ¶‰åŠåˆ°å¦ä¸€ä¸ªæ¦‚å¿µï¼šmaster-slaverï¼ˆä¸»ä»æ¨¡å¼ï¼‰ã€‚å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯å¸¸ç”¨çš„ä¸»å¤‡æ¨¡å¼ï¼Œä¾‹å¦‚ nginx çš„ä¸»å¤‡æ¨¡å¼ã€‚ä¸€ä¸ªä¸» redis èŠ‚ç‚¹å¯ä»¥é…ç½®å¤šä¸ªä»èŠ‚ç‚¹ï¼Œå½“ä¸»èŠ‚ç‚¹æŒ‚æ‰æ—¶ï¼Œä»èŠ‚ç‚¹è‡ªåŠ¨é¡¶ä¸Šä»£æ›¿ä¸»èŠ‚ç‚¹ï¼Œè¿™æ ·å°±å¯ä»¥æœ‰æ•ˆçš„é¿å…ä¸€ä¸ªèŠ‚ç‚¹æŒ‚æ‰å¯¼è‡´æ•´ä¸ªç³»ç»ŸæŒ‚æ‰çš„é—®é¢˜ï¼Œå®ç° redis æœåŠ¡çš„é«˜å¯ç”¨ã€‚å¦‚ä¸‹å›¾ï¼š</p>
<p></p>
<p>ä½†æ˜¯è¿™ä¸ªæ–¹æ¡ˆéœ€è¦è§£å†³ä¸¤ä¸ªåŸºæœ¬é—®é¢˜ï¼š</p>
<ol>
<li>å¦‚ä½•æå‰åˆ¤æ–­å„ä¸ªèŠ‚ç‚¹ï¼ˆå°¤å…¶æ˜¯ä¸»èŠ‚ç‚¹ï¼‰çš„è¿è¡Œå¥åº·çŠ¶å†µï¼Ÿ</li>
<li>å½“ä¸»èŠ‚ç‚¹å®•æœºçš„æ—¶å€™å¦‚ä½•ä»å¤šä¸ªä»èŠ‚ç‚¹ä¸­é€‰å‡ºä¸€ä¸ªä½œä¸ºæ–°çš„ä¸»èŠ‚ç‚¹å¹¶å®ç°è‡ªåŠ¨åˆ‡æ¢ï¼Ÿ</li>
</ol>
<p>è¿™æ—¶ Redis Sentinel åº”è¿è€Œç”Ÿï¼Œå®ƒä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ä¸ªç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>ç›‘æ§ï¼ˆMonitoring</strong>ï¼‰ï¼šSentinel ä¼šä¸æ–­åœ°æ£€æŸ¥ä½ çš„ä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨æ˜¯å¦è¿ä½œæ­£å¸¸ã€‚</li>
<li><strong>æé†’ï¼ˆNotificationï¼‰</strong>ï¼šå½“è¢«ç›‘æ§çš„æŸä¸ª Redis æœåŠ¡å™¨å‡ºç°é—®é¢˜æ—¶ï¼ŒSentinel å¯ä»¥é€šè¿‡ API å‘ç®¡ç†å‘˜æˆ–è€…å…¶ä»–åº”ç”¨ç¨‹åºå‘é€é€šçŸ¥ã€‚</li>
<li><strong>è‡ªåŠ¨æ•…éšœè¿ç§»ï¼ˆAutomatic failoverï¼‰</strong>ï¼šå½“ä¸€ä¸ªä¸»æœåŠ¡å™¨ä¸èƒ½æ­£å¸¸å·¥ä½œæ—¶ï¼ŒSentinel ä¼šå¼€å§‹ä¸€æ¬¡è‡ªåŠ¨æ•…éšœè¿ç§»æ“ä½œï¼Œ å®ƒä¼šå°†å¤±æ•ˆä¸»æœåŠ¡å™¨çš„å…¶ä¸­ä¸€ä¸ªä»æœåŠ¡å™¨å‡çº§ä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ï¼Œå¹¶è®©å¤±æ•ˆä¸»æœåŠ¡å™¨çš„å…¶ä»–ä»æœåŠ¡å™¨æ”¹ä¸ºå¤åˆ¶æ–°çš„ä¸»æœåŠ¡å™¨ï¼› å½“å®¢æˆ·ç«¯è¯•å›¾è¿æ¥å¤±æ•ˆçš„ä¸»æœåŠ¡å™¨æ—¶ï¼Œ é›†ç¾¤ä¹Ÿä¼šå‘å®¢æˆ·ç«¯è¿”å›æ–°ä¸»æœåŠ¡å™¨çš„åœ°å€ï¼Œä½¿å¾—é›†ç¾¤å¯ä»¥ä½¿ç”¨æ–°ä¸»æœåŠ¡å™¨ä»£æ›¿å¤±æ•ˆæœåŠ¡å™¨ã€‚</li>
</ul>
<p>æ€»ç»“æ¥è¯´å°±æ˜¯ sentinel å¯ä»¥ç›‘æ§ä¸€ä¸ªæˆ–è€…å¤šä¸ª master-slaver é›†ç¾¤ï¼Œå®šæ—¶å¯¹æ¯ä¸ªèŠ‚ç‚¹è¿›è¡Œå¥åº·æ£€æŸ¥ï¼Œå¯ä»¥é€šè¿‡ API å‘é€é€šçŸ¥ï¼Œå¹¶è‡ªåŠ¨è¿›è¡Œæ•…éšœè½¬ç§»ã€‚è¿™æ—¶r redis ç»“æ„å°±å˜æˆäº†</p>
<p><strong>ä½¿ç”¨äº† redis sentinel ä¹‹åå®¢æˆ·ç«¯ä¸å†ç›´æ¥è¿æ¥ redis èŠ‚ç‚¹è·å–æœåŠ¡ï¼Œè€Œæ˜¯ä½¿ç”¨ sentinel ä»£ç†è·å– redis æœåŠ¡</strong>ï¼Œç±»ä¼¼ Nginx çš„ä»£ç†æ¨¡å¼ã€‚é‚£ä¹ˆè¿™é‡Œåˆæœ‰ä¸€ä¸ªæ–°é—®é¢˜ï¼Œå°±æ˜¯<strong>å¦‚æœ sentinel å®•æœºäº†ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å°±æ‰¾ä¸åˆ° redis æœåŠ¡äº†ï¼Œæ‰€ä»¥ sentinel æœ¬èº«ä¹Ÿæ˜¯éœ€è¦æ”¯æŒé«˜å¯ç”¨ã€‚</strong></p>
<p>**å¥½åœ¨sentinel æœ¬èº«ä¹Ÿæ”¯æŒé›†ç¾¤éƒ¨ç½²ï¼Œå¹¶ä¸”å„ä¸ª sentinel ä¹‹é—´æ”¯æŒè‡ªåŠ¨ç›‘æ§ï¼Œå¦‚æ­¤ä¸€æ¥ redis ä¸»ä»æœåŠ¡å’Œ sentinel æœåŠ¡éƒ½å¯ä»¥æ”¯æŒé«˜å¯ç”¨ã€‚**é¢„æœŸç»“æ„å¦‚ä¸‹ï¼š</p>
<p></p>
<h4 id="éƒ¨ç½²å®ä¾‹-1">éƒ¨ç½²å®ä¾‹</h4>
<h5 id="master-slaver-ä¸€ä¸»äºŒä»">master-slaver ä¸€ä¸»äºŒä»</h5>
<p>é‚£ä¹ˆä¸‹é¢æˆ‘ä»¬å°±æ¥å®æ“ä¸€ä¸‹ï¼Œä»¥ä¸‹è¿‡ç¨‹å¤§éƒ¨åˆ†å‚è€ƒ redis å®˜æ–¹ <a href="https://redis.io/topics/sentinel#redis-sentinel-documentation" target="_blank" rel="noopener noreffer ">Redis Sentinel æ–‡æ¡£</a>ã€‚</p>
<p>å®‰è£… redis å°±ä¸é‡å¤äº†ï¼Œå’Œå•æœº redis ä¸€æ ·ã€‚</p>
<p>redis è§£å‹åï¼Œredis home ç›®å½•ä¸‹æœ‰ redis é…ç½®çš„æ ·ä¾‹æ–‡ä»¶ï¼Œæˆ‘ä»¬ä¸ç›´æ¥åœ¨æ­¤æ–‡ä»¶ä¸Šå°±è¡Œä¿®æ”¹ï¼Œåœ¨redis homeç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶å¤¹ master-slave ï¼Œå°†é…ç½®æ–‡ä»¶éƒ½æ”¾äºæ­¤ç›®å½•ä¸‹ï¼Œä¸‹é¢æ˜¯ä¸‰ä¸ª redis èŠ‚ç‚¹é…ç½®çš„å…³é”®éƒ¨åˆ†</p>
<ul>
<li>master é…ç½®æ–‡ä»¶ï¼šredis-6379.conf</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">port <span class="m">6379</span>
</span></span><span class="line"><span class="cl">daemonize yes
</span></span><span class="line"><span class="cl">logfile <span class="s2">&#34;6379.log&#34;</span>
</span></span><span class="line"><span class="cl">dbfilename <span class="s2">&#34;dump-6379.rdb&#34;</span>
</span></span><span class="line"><span class="cl">dir <span class="s2">&#34;/opt/soft/redis/data&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>slave-1 é…ç½®æ–‡ä»¶ï¼šredis-6380.conf</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">port <span class="m">6380</span>
</span></span><span class="line"><span class="cl">daemonize yes
</span></span><span class="line"><span class="cl">logfile <span class="s2">&#34;6380.log&#34;</span>
</span></span><span class="line"><span class="cl">dbfilename <span class="s2">&#34;dump-6380.rdb&#34;</span>
</span></span><span class="line"><span class="cl">dir <span class="s2">&#34;/opt/soft/redis/data&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># å…³é”®é…ç½®ï¼šå°†è¿™ä¸ª redis æŒ‡å®šä¸ºæŸä¸ªç¬¬ä¸€ä¸ª redis çš„ slaver</span>
</span></span><span class="line"><span class="cl">slaveof 127.0.0.1 <span class="m">6379</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>slave-2 é…ç½®æ–‡ä»¶ï¼šredis-6381.conf</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">port <span class="m">6381</span>
</span></span><span class="line"><span class="cl">daemonize yes
</span></span><span class="line"><span class="cl">logfile <span class="s2">&#34;6381.log&#34;</span>
</span></span><span class="line"><span class="cl">dbfilename <span class="s2">&#34;dump-6381.rdb&#34;</span>
</span></span><span class="line"><span class="cl">dir <span class="s2">&#34;/opt/soft/redis/data&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># å…³é”®é…ç½®ï¼šå°†è¿™ä¸ª redis æŒ‡å®šä¸ºæŸä¸ªç¬¬ä¸€ä¸ª redis çš„ slaver</span>
</span></span><span class="line"><span class="cl">slaveof 127.0.0.1 <span class="m">6379</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åˆ†åˆ«å¯åŠ¨è¿™ä¸‰ä¸ª redis æœåŠ¡ï¼Œå¯åŠ¨è¿‡ç¨‹å°±ä¸ç½—å—¦äº†ï¼Œå’Œåˆ†åˆ«å¯åŠ¨ä¸‰ä¸ªå•æœº redis æ˜¯ä¸€æ ·çš„ï¼Œåˆ†åˆ«æŒ‡å®šä¸‰ä¸ªé…ç½®æ–‡ä»¶å³å¯ã€‚å¯åŠ¨åå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p></p>
<p>6379ã€6380ã€6381 ç«¯å£åˆ†åˆ«åœ¨è¿è¡Œä¸€ä¸ª redis-serverã€‚</p>
<p>æ¥ä¸‹æ¥æŸ¥çœ‹è¿™ä¸‰ä¸ª redis-server ä¹‹é—´çš„å…³ç³»ï¼šè¿æ¥åˆ°ä¸» redis ä¸Šç”¨ <code>info replication</code>å³å¯æŸ¥çœ‹</p>
<p></p>
<p>å¯ä»¥çœ‹åˆ°å½“å‰è¿æ¥çš„ redis æœåŠ¡ä¸º master è§’è‰²ï¼Œä¸‹é¢æœ‰ä¸¤ä¸ª slaverï¼ŒIP å’Œç«¯å£éƒ½èƒ½çœ‹åˆ°ã€‚</p>
<p><strong>è¿™æ ·æˆ‘ä»¬å°±é¡ºåˆ©çš„å®Œæˆäº† ä¸€ä¸»äºŒä» redis ç¯å¢ƒçš„æ­å»ºï¼Œä¸‹é¢å¼€å§‹æ­å»º sentinel é›†ç¾¤ã€‚</strong></p>
<h5 id="sentinel-é›†ç¾¤">sentinel é›†ç¾¤</h5>
<p>sentinel æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ redisï¼Œå¤§éƒ¨åˆ†é…ç½®å’Œæ™®é€šçš„ redis æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä¸»è¦åŒºåˆ«åœ¨äºç«¯å£å’Œå…¶å“¨å…µç›‘æ§è®¾ç½®ï¼Œä¸‹é¢æ˜¯ä¸‰ä¸ªå…¸å‹çš„ sentinel é…ç½®æ–‡ä»¶ä¸­çš„å…³é”®å†…å®¹ï¼š</p>
<ul>
<li>sentinel-26379.conf</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">#è®¾ç½® sentinel å·¥ä½œç«¯å£</span>
</span></span><span class="line"><span class="cl">port <span class="m">26379</span>
</span></span><span class="line"><span class="cl"><span class="c1">#åå°è¿è¡Œ </span>
</span></span><span class="line"><span class="cl">daemonize yes
</span></span><span class="line"><span class="cl"><span class="c1">#æ—¥å¿—æ–‡ä»¶åç§°</span>
</span></span><span class="line"><span class="cl">logfile <span class="s2">&#34;26379.log&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è®¾ç½®å½“å‰ sentinel ç›‘æ§çš„ redis ip å’Œ ç«¯å£</span>
</span></span><span class="line"><span class="cl">sentinel monitor mymaster 127.0.0.1 <span class="m">6379</span> <span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è®¾ç½®åˆ¤æ–­ redis èŠ‚ç‚¹å®•æœºæ—¶é—´</span>
</span></span><span class="line"><span class="cl">sentinel down-after-milliseconds mymaster <span class="m">60000</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è®¾ç½®è‡ªåŠ¨æ•…éšœè½¬ç§»è¶…æ—¶</span>
</span></span><span class="line"><span class="cl">sentinel failover-timeout mymaster <span class="m">180000</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è®¾ç½®åŒæ—¶æ•…éšœè½¬ç§»ä¸ªæ•°</span>
</span></span><span class="line"><span class="cl">sentinel parallel-syncs mymaster <span class="m">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>sentinel-26380.conf</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">#è®¾ç½® sentinel å·¥ä½œç«¯å£</span>
</span></span><span class="line"><span class="cl">port <span class="m">26380</span>
</span></span><span class="line"><span class="cl"><span class="c1">#åå°è¿è¡Œ </span>
</span></span><span class="line"><span class="cl">daemonize yes
</span></span><span class="line"><span class="cl"><span class="c1">#æ—¥å¿—æ–‡ä»¶åç§°</span>
</span></span><span class="line"><span class="cl">logfile <span class="s2">&#34;26380.log&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è®¾ç½®å½“å‰ sentinel ç›‘æ§çš„ redis ip å’Œ ç«¯å£</span>
</span></span><span class="line"><span class="cl">sentinel monitor mymaster 127.0.0.1 <span class="m">6379</span> <span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è®¾ç½®åˆ¤æ–­ redis èŠ‚ç‚¹å®•æœºæ—¶é—´</span>
</span></span><span class="line"><span class="cl">sentinel down-after-milliseconds mymaster <span class="m">60000</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è®¾ç½®è‡ªåŠ¨æ•…éšœè½¬ç§»è¶…æ—¶</span>
</span></span><span class="line"><span class="cl">sentinel failover-timeout mymaster <span class="m">180000</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è®¾ç½®åŒæ—¶æ•…éšœè½¬ç§»ä¸ªæ•°</span>
</span></span><span class="line"><span class="cl">sentinel parallel-syncs mymaster <span class="m">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>sentinel-26381.conf</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">#è®¾ç½® sentinel å·¥ä½œç«¯å£</span>
</span></span><span class="line"><span class="cl">port <span class="m">26391</span>
</span></span><span class="line"><span class="cl"><span class="c1">#åå°è¿è¡Œ </span>
</span></span><span class="line"><span class="cl">daemonize yes
</span></span><span class="line"><span class="cl"><span class="c1">#æ—¥å¿—æ–‡ä»¶åç§°</span>
</span></span><span class="line"><span class="cl">logfile <span class="s2">&#34;26381.log&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è®¾ç½®å½“å‰ sentinel ç›‘æ§çš„ redis ip å’Œ ç«¯å£</span>
</span></span><span class="line"><span class="cl">sentinel monitor mymaster 127.0.0.1 <span class="m">6379</span> <span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è®¾ç½®åˆ¤æ–­ redis èŠ‚ç‚¹å®•æœºæ—¶é—´</span>
</span></span><span class="line"><span class="cl">sentinel down-after-milliseconds mymaster <span class="m">60000</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è®¾ç½®è‡ªåŠ¨æ•…éšœè½¬ç§»è¶…æ—¶</span>
</span></span><span class="line"><span class="cl">sentinel failover-timeout mymaster <span class="m">180000</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è®¾ç½®åŒæ—¶æ•…éšœè½¬ç§»ä¸ªæ•°</span>
</span></span><span class="line"><span class="cl">sentinel parallel-syncs mymaster <span class="m">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é’ˆå¯¹å‡ ä¸ªç›‘æ§è®¾ç½®çš„é…ç½®åšä¸€ä¸‹è¯¦ç»†è¯´æ˜ï¼š</p>
<ul>
<li><strong>sentinel monitor [master-group-name] [ip] [port] [quorum]</strong></li>
</ul>
<p>è¿™ä¸ªå‘½ä»¤ä¸­ã€master-group-nameã€‘æ˜¯ master redis çš„åç§°ï¼›ã€ipã€‘å’Œã€portã€‘åˆ†åˆ«æ˜¯å…¶ ip å’Œç«¯å£ï¼Œå¾ˆå¥½ç†è§£ã€‚æœ€åä¸€ä¸ªå‚æ•°ã€quorumã€‘æ˜¯â€æŠ•ç¥¨æ•°â€œ</p>
<p>ä¸¾ä¸ªæ —å­ï¼Œredis é›†ç¾¤ä¸­æœ‰3ä¸ª sentinel å®ä¾‹ï¼Œå…¶ä¸­ master æŒ‚æ‰äº†ï¼Œå¦‚æœè¿™é‡Œçš„ç¥¨æ•°æ˜¯2ï¼Œè¡¨ç¤ºæœ‰2ä¸ª sentinel è®¤ä¸º master æŒ‚æ‰å•¦ï¼Œæ‰èƒ½è¢«è®¤ä¸ºæ˜¯æ­£çœŸçš„æŒ‚æ‰å•¦ã€‚å…¶ä¸­ sentinel é›†ç¾¤ä¸­å„ä¸ª sentinel ä¹‹é—´é€šè¿‡ gossip åè®®äº’ç›¸é€šä¿¡ã€‚
å…·ä½“æ€æ ·æŠ•ç¥¨è¿˜æ¶‰åŠåˆ° redis é›†ç¾¤ä¸­çš„ã€ä¸»è§‚ä¸‹çº¿ã€‘å’Œã€å®¢è§‚ä¸‹çº¿ã€‘çš„æ¦‚å¿µï¼Œåé¢å†è¯¦ç»†ä»‹ç»ã€‚</p>
<ul>
<li><strong>down-after-milliseconds</strong></li>
</ul>
<p>sentinel ä¼šå‘ master å‘é€å¿ƒè·³ PING æ¥ç¡®è®¤ master æ˜¯å¦å­˜æ´»ï¼Œå¦‚æœ master åœ¨â€œä¸€å®šæ—¶é—´èŒƒå›´â€å†…ä¸å›åº”PONG æˆ–è€…æ˜¯å›å¤äº†ä¸€ä¸ªé”™è¯¯æ¶ˆæ¯ï¼Œé‚£ä¹ˆè¿™ä¸ª sentinel ä¼šä¸»è§‚åœ°è®¤ä¸ºè¿™ä¸ª master å·²ç»ä¸å¯ç”¨äº†ã€‚è€Œè¿™ä¸ªdown-after-milliseconds å°±æ˜¯ç”¨æ¥æŒ‡å®šè¿™ä¸ªâ€œä¸€å®šæ—¶é—´èŒƒå›´â€çš„ï¼Œå•ä½æ˜¯æ¯«ç§’ã€‚</p>
<ul>
<li><strong>failover-timeout</strong></li>
</ul>
<p>è¿™ä¸ªå‚æ•° redis å®˜æ–¹æ–‡æ¡£ä¸­å¹¶æœªåšè¯¦ç»†è¯´æ˜ï¼Œä½†æ˜¯å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯ sentinel å¯¹ redis èŠ‚ç‚¹è¿›è¡Œè‡ªåŠ¨æ•…éšœè½¬ç§»çš„è¶…æ—¶è®¾ç½®ï¼Œå½“ failoverï¼ˆæ•…éšœè½¬ç§»ï¼‰å¼€å§‹åï¼Œåœ¨æ­¤æ—¶é—´å†…ä»ç„¶æ²¡æœ‰è§¦å‘ä»»ä½• failover æ“ä½œï¼Œå½“å‰sentinel  å°†ä¼šè®¤ä¸ºæ­¤æ¬¡æ•…éšœè½¬ç§»å¤±è´¥ã€‚</p>
<ul>
<li><strong>parallel-syncs</strong></li>
</ul>
<p>å½“æ–°masteräº§ç”Ÿæ—¶ï¼ŒåŒæ—¶è¿›è¡Œ slaveof åˆ°æ–° master å¹¶è¿›è¡ŒåŒæ­¥å¤åˆ¶çš„ slave ä¸ªæ•°,ä¹Ÿå°±æ˜¯åŒæ—¶å‡ ä¸ª slave è¿›è¡ŒåŒæ­¥ã€‚å› ä¸ºåœ¨ salve æ‰§è¡Œ salveof ä¸æ–° master åŒæ­¥æ—¶ï¼Œå°†ä¼šç»ˆæ­¢å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå› æ­¤è¿™ä¸ªå€¼éœ€è¦æƒè¡¡ã€‚æ­¤å€¼è¾ƒå¤§ï¼Œæ„å‘³ç€â€œé›†ç¾¤â€ç»ˆæ­¢å®¢æˆ·ç«¯è¯·æ±‚çš„æ—¶é—´æ€»å’Œå’Œè¾ƒå¤§ï¼Œæ­¤å€¼è¾ƒå°,æ„å‘³ç€â€œé›†ç¾¤â€åœ¨æ•…éšœè½¬ç§»æœŸé—´ï¼Œå¤šä¸ª salve å‘å®¢æˆ·ç«¯æä¾›æœåŠ¡æ—¶ä»ç„¶ä½¿ç”¨æ—§æ•°æ®ã€‚</p>
<p>æˆ‘ä»¬é…ç½®ä¸‰ä¸ª sentinel å‡ ç‚¹ç»„æˆä¸€ä¸ª sentinel é›†ç¾¤ï¼Œç«¯å£åˆ†åˆ«æ˜¯ 23679ï¼Œ23680ï¼Œ23681</p>
<p>ç„¶åå°±å¯ä»¥å¯åŠ¨ sentinel é›†ç¾¤äº†</p>
<p>å¯åŠ¨ sentinel æœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<ol>
<li><code>redis-sentinel /path/to/sentinel.conf</code></li>
<li><code>redis-server /path/to/sentinel.conf --sentinel</code></li>
</ol>
<p>è¿™ä¸¤ç§å¯åŠ¨æ–¹å¼æ²¡æœ‰åŒºåˆ«ï¼ŒæŒ‰ç…§é¡ºåºåˆ†åˆ«å¯åŠ¨ä¸‰ä¸ª sentinel èŠ‚ç‚¹ä¹‹åï¼Œæˆ‘ä»¬ä»»æ„è¿æ¥å…¶ä¸­çš„ä¸€ä¸ª sentinel èŠ‚ç‚¹æŸ¥çœ‹é›†ç¾¤å…³ç³»ï¼Œå¦‚ä¸‹å›¾ï¼š
</p>
<p>æˆ‘ä»¬è¿æ¥ 26379 è¿™ä¸ªç«¯å£çš„ sentinelï¼Œç”¨ <code>info sentinel</code>å‘½ä»¤å¯ä»¥çœ‹åˆ°è¿™ä¸ª sentinel ç›‘æ§çš„ master redis æœåŠ¡çš„ ipï¼Œç«¯å£ï¼Œä»¥åŠ maste çš„ slaver èŠ‚ç‚¹æ•°é‡ï¼Œä»¥åŠ sentinel çš„æ•°é‡ã€‚</p>
<p>å†è¿æ¥ 26380 è¿™ä¸ªèŠ‚ç‚¹è¯•è¯•ï¼š</p>
<p></p>
<p>å¯ä»¥çœ‹åˆ°ç»“æœå’Œä¸Šé¢ä¸€æ ·ã€‚</p>
<p><strong>å¦‚æ­¤ï¼Œæˆ‘ä»¬çš„ sentinel é›†ç¾¤ä¹Ÿéƒ¨ç½²å®Œæˆäº†</strong></p>
<p>é‚£ä¹ˆï¼Œå½“å‰è¿™ä¸ª redis sentinel é«˜å¯ç”¨é›†ç¾¤çš„åšç§æ‹“æ‰‘å›¾å¦‚ä¸‹ï¼š</p>
<p></p>
<h4 id="é«˜å¯ç”¨æ•…éšœæµ‹è¯•">é«˜å¯ç”¨æ•…éšœæµ‹è¯•</h4>
<p>ä¸‹é¢æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹è¿™ä¸ªé«˜å¯ç”¨æ–¹æ¡ˆçš„å®é™…èƒ½åŠ›ã€‚</p>
<p>æˆ‘ä»¬æ‰‹åŠ¨æŠŠä¸€ä¸»äºŒä»ä¸­çš„ä¸»èŠ‚ç‚¹ kill æ‰ï¼š</p>
<p></p>
<p>ç„¶åè¿æ¥ 6380 èŠ‚ç‚¹ï¼ŒæŸ¥çœ‹é›†ç¾¤çŠ¶æ€ï¼š
</p>
<p>å¯ä»¥çœ‹åˆ° 6380 èŠ‚ç‚¹å·²ç»è‡ªåŠ¨å‡çº§ä¸ºäº† master èŠ‚ç‚¹ï¼Œè¿˜æœ‰ 6381 è¿™ä¸€ä¸ª slaver èŠ‚ç‚¹ï¼Œ<strong>è‡ªåŠ¨æ•…éšœè½¬ç§»æˆåŠŸ</strong></p>
<p>æˆ‘ä»¬å†æ‰‹åŠ¨å¯åŠ¨ 6379 èŠ‚ç‚¹ï¼Œè§‚å¯Ÿé›†ç¾¤çŠ¶æ€ï¼š</p>
<p></p>
<p>å¦‚å›¾ï¼Œ6379èŠ‚ç‚¹é‡æ–°å¯åŠ¨åï¼Œè‡ªåŠ¨å˜æˆäº† 6380 èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹ã€‚</p>
<p><strong>å¦‚æ­¤ä¸€å¥—å®Œæ•´çš„ redis é«˜å¯ç”¨æ–¹æ¡ˆå°±éƒ¨ç½²å®Œæˆäº†ã€‚</strong></p>
<h4 id="redis-ä¸»è§‚ä¸‹çº¿å’Œå®¢è§‚ä¸‹çº¿">Redis ä¸»è§‚ä¸‹çº¿å’Œå®¢è§‚ä¸‹çº¿</h4>
<p>å‰é¢è¯´è¿‡ï¼Œ Redis çš„ Sentinel ä¸­å…³äºä¸‹çº¿ï¼ˆdownï¼‰æœ‰ä¸¤ä¸ªä¸åŒçš„æ¦‚å¿µï¼š</p>
<ul>
<li>ä¸»è§‚ä¸‹çº¿ï¼ˆSubjectively Downï¼Œ ç®€ç§° SDOWNï¼‰æŒ‡çš„æ˜¯å•ä¸ª Sentinel å®ä¾‹å¯¹æœåŠ¡å™¨åšå‡ºçš„ä¸‹çº¿åˆ¤æ–­ã€‚</li>
<li>å®¢è§‚ä¸‹çº¿ï¼ˆObjectively Downï¼Œ ç®€ç§° ODOWNï¼‰æŒ‡çš„æ˜¯å¤šä¸ª Sentinel å®ä¾‹åœ¨å¯¹åŒä¸€ä¸ªæœåŠ¡å™¨åšå‡º SDOWN åˆ¤æ–­ï¼Œ å¹¶ä¸”é€šè¿‡ SENTINEL is-master-down-by-addr å‘½ä»¤äº’ç›¸äº¤æµä¹‹åï¼Œ å¾—å‡ºçš„æœåŠ¡å™¨ä¸‹çº¿åˆ¤æ–­ã€‚ ï¼ˆä¸€ä¸ª Sentinel å¯ä»¥é€šè¿‡å‘å¦ä¸€ä¸ª Sentinel å‘é€ SENTINEL is-master-down-by-addr å‘½ä»¤æ¥è¯¢é—®å¯¹æ–¹æ˜¯å¦è®¤ä¸ºç»™å®šçš„æœåŠ¡å™¨å·²ä¸‹çº¿ï¼‰</li>
</ul>
<p>å¦‚æœä¸€ä¸ªæœåŠ¡å™¨æ²¡æœ‰åœ¨ master-down-after-milliseconds é€‰é¡¹æ‰€æŒ‡å®šçš„æ—¶é—´å†…ï¼Œ å¯¹å‘å®ƒå‘é€ PING å‘½ä»¤çš„ Sentinel è¿”å›ä¸€ä¸ªæœ‰æ•ˆå›å¤ï¼ˆvalid replyï¼‰ï¼Œ é‚£ä¹ˆ Sentinel å°±ä¼šå°†è¿™ä¸ªæœåŠ¡å™¨æ ‡è®°ä¸ºä¸»è§‚ä¸‹çº¿ã€‚</p>
<p>æœåŠ¡å™¨å¯¹ PING å‘½ä»¤çš„æœ‰æ•ˆå›å¤å¯ä»¥æ˜¯ä»¥ä¸‹ä¸‰ç§å›å¤çš„å…¶ä¸­ä¸€ç§ï¼š</p>
<ul>
<li>è¿”å› +PONG ã€‚</li>
<li>è¿”å› -LOADING é”™è¯¯ã€‚</li>
<li>è¿”å› -MASTERDOWN é”™è¯¯ã€‚</li>
</ul>
<p>å¦‚æœæœåŠ¡å™¨è¿”å›é™¤ä»¥ä¸Šä¸‰ç§å›å¤ä¹‹å¤–çš„å…¶ä»–å›å¤ï¼Œ åˆæˆ–è€…åœ¨æŒ‡å®šæ—¶é—´å†…æ²¡æœ‰å›å¤ PING å‘½ä»¤ï¼Œ é‚£ä¹ˆ Sentinel è®¤ä¸ºæœåŠ¡å™¨è¿”å›çš„å›å¤æ— æ•ˆï¼ˆnon-validï¼‰ã€‚</p>
<p>æ³¨æ„ï¼Œ ä¸€ä¸ªæœåŠ¡å™¨å¿…é¡»åœ¨ master-down-after-milliseconds æ¯«ç§’å†…ï¼Œ ä¸€ç›´è¿”å›æ— æ•ˆå›å¤æ‰ä¼šè¢« Sentinel æ ‡è®°ä¸ºä¸»è§‚ä¸‹çº¿ã€‚</p>
<p>ä¸¾ä¸ªæ —å­ï¼Œ å¦‚æœ master-down-after-milliseconds é€‰é¡¹çš„å€¼ä¸º 30000 æ¯«ç§’ï¼ˆ30 ç§’ï¼‰ï¼Œ é‚£ä¹ˆåªè¦æœåŠ¡å™¨èƒ½åœ¨æ¯ 29 ç§’ä¹‹å†…è¿”å›è‡³å°‘ä¸€æ¬¡æœ‰æ•ˆå›å¤ï¼Œ è¿™ä¸ªæœåŠ¡å™¨å°±ä»ç„¶ä¼šè¢«è®¤ä¸ºæ˜¯å¤„äºæ­£å¸¸çŠ¶æ€çš„ã€‚</p>
<p>ä»ä¸»è§‚ä¸‹çº¿çŠ¶æ€åˆ‡æ¢åˆ°å®¢è§‚ä¸‹çº¿çŠ¶æ€å¹¶æ²¡æœ‰ä½¿ç”¨ä¸¥æ ¼çš„æ³•å®šäººæ•°ç®—æ³•ï¼ˆstrong quorum algorithmï¼‰ï¼Œ è€Œæ˜¯ä½¿ç”¨äº†æµè¨€åè®®ï¼š å¦‚æœ Sentinel åœ¨ç»™å®šçš„æ—¶é—´èŒƒå›´å†…ï¼Œ ä»å…¶ä»– Sentinel é‚£é‡Œæ¥æ”¶åˆ°äº†è¶³å¤Ÿæ•°é‡çš„ä¸»æœåŠ¡å™¨ä¸‹çº¿æŠ¥å‘Šï¼Œ é‚£ä¹ˆ Sentinel å°±ä¼šå°†ä¸»æœåŠ¡å™¨çš„çŠ¶æ€ä»ä¸»è§‚ä¸‹çº¿æ”¹å˜ä¸ºå®¢è§‚ä¸‹çº¿ã€‚ å¦‚æœä¹‹åå…¶ä»– Sentinel ä¸å†æŠ¥å‘Šä¸»æœåŠ¡å™¨å·²ä¸‹çº¿ï¼Œ é‚£ä¹ˆå®¢è§‚ä¸‹çº¿çŠ¶æ€å°±ä¼šè¢«ç§»é™¤ã€‚</p>
<p>æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå®¢è§‚ä¸‹çº¿æ¡ä»¶<strong>åªé€‚ç”¨äºä¸»æœåŠ¡å™¨</strong>ï¼š å¯¹äºä»»ä½•å…¶ä»–ç±»å‹çš„ Redis å®ä¾‹ï¼Œ Sentinel åœ¨å°†å®ƒä»¬åˆ¤æ–­ä¸ºä¸‹çº¿å‰ä¸éœ€è¦è¿›è¡Œåå•†ï¼Œ æ‰€ä»¥ä»æœåŠ¡å™¨æˆ–è€…å…¶ä»– Sentinel æ°¸è¿œä¸ä¼šè¾¾åˆ°å®¢è§‚ä¸‹çº¿æ¡ä»¶ã€‚</p>
<p>åªè¦ä¸€ä¸ª Sentinel å‘ç°æŸä¸ªä¸»æœåŠ¡å™¨è¿›å…¥äº†å®¢è§‚ä¸‹çº¿çŠ¶æ€ï¼Œ è¿™ä¸ª Sentinel å°±å¯èƒ½ä¼šè¢«å…¶ä»– Sentinel æ¨é€‰å‡ºï¼Œ å¹¶å¯¹å¤±æ•ˆçš„ä¸»æœåŠ¡å™¨æ‰§è¡Œè‡ªåŠ¨æ•…éšœè¿ç§»æ“ä½œã€‚</p>
<h3 id="redis-åˆ†å¸ƒå¼é«˜å¯ç”¨æ–¹æ¡ˆredis-cluster">Redis åˆ†å¸ƒå¼é«˜å¯ç”¨æ–¹æ¡ˆï¼šRedis Cluster</h3>
<h4 id="åŸç†ç®€ä»‹-2">åŸç†ç®€ä»‹</h4>
<p>ä½œä¸ºä¸€ä¸ªå†…å­˜æ•°æ®åº“ï¼Œå®ç°é«˜å¯ç”¨æ˜¯ä¸€ä¸ªåŸºæœ¬ä¿éšœï¼Œå½“å‚¨å­˜æœåŠ¡åœ¨å¯é¢„è§çš„å°†æ¥éœ€è¦åšå­˜å‚¨æ‹“å±•æ—¶ï¼Œåˆ†å¸ƒå¼å‚¨å­˜å°±æ˜¯ä¸€ä¸ªå¿…é¡»è¦è€ƒè™‘åˆ°çš„äº‹æƒ…ã€‚ä¾‹å¦‚éƒ¨ç½²ä¸€ä¸ªä¸­å¤® redis å‚¨å­˜æœåŠ¡ï¼Œæä¾›ç»™é›†å›¢ä¸‹æ‰€æœ‰çš„å­å…¬å¸æ‰€æœ‰éœ€è¦çš„ç³»ç»Ÿä½¿ç”¨ï¼Œå¹¶ä¸”ç³»ç»Ÿæ•°é‡åœ¨ä¸æ–­çš„å¢åŠ ï¼Œæ­¤æ—¶åœ¨éƒ¨ç½²æœåŠ¡çš„æ—¶å€™ï¼Œåˆ†å¸ƒå¼å‚¨å­˜ç»“æ„å‡ ä¹æ˜¯å¿…ç„¶çš„é€‰æ‹©ã€‚</p>
<p><strong>Redis 3.0 ç‰ˆæœ¬ä¹‹å‰ï¼Œå¯ä»¥é€šè¿‡å‰é¢è¯´æ‰€çš„ Redis Sentinelï¼ˆå“¨å…µï¼‰æ¥å®ç°é«˜å¯ç”¨ ( HA )ï¼Œä» 3.0 ç‰ˆæœ¬ä¹‹åï¼Œå®˜æ–¹æ¨å‡ºäº†Redis Clusterï¼Œå®ƒçš„ä¸»è¦ç”¨é€”æ˜¯å®ç°æ•°æ®åˆ†ç‰‡(Data Sharding)ï¼ŒåŒæ—¶æä¾›äº†å®Œæ•´çš„ shardingã€replicationï¼ˆå¤åˆ¶æœºåˆ¶ä»ä½¿ç”¨åŸæœ‰æœºåˆ¶ï¼Œå¹¶ä¸”å…·å¤‡æ„ŸçŸ¥ä¸»å¤‡çš„èƒ½åŠ›ï¼‰ã€failover è§£å†³æ–¹æ¡ˆï¼Œç§°ä¸º Redis Clusterï¼ŒåŒæ ·å¯ä»¥å®ç° HAï¼Œæ˜¯å®˜æ–¹å½“å‰æ¨èçš„æ–¹æ¡ˆã€‚</strong></p>
<p>åœ¨ Redis Sentinel æ¨¡å¼ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹éœ€è¦ä¿å­˜å…¨é‡æ•°æ®ï¼Œå†—ä½™æ¯”è¾ƒå¤šï¼Œè€Œåœ¨Redis Cluster æ¨¡å¼ä¸­ï¼Œæ¯ä¸ªåˆ†ç‰‡åªéœ€è¦ä¿å­˜ä¸€éƒ¨åˆ†çš„æ•°æ®ï¼Œå¯¹äºå†…å­˜æ•°æ®åº“æ¥è¯´ï¼Œè¿˜æ˜¯è¦å°½é‡çš„å‡å°‘å†—ä½™ã€‚åœ¨æ•°æ®é‡å¤ªå¤§çš„æƒ…å†µä¸‹ï¼Œæ•…éšœæ¢å¤éœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œå¦å¤–ï¼Œå†…å­˜çš„ä»·æ ¼ä¹Ÿæ˜¯éå¸¸é«˜æ˜‚çš„ã€‚</p>
<p>Redis Cluste rçš„å…·ä½“å®ç°ç»†èŠ‚æ˜¯é‡‡ç”¨äº† Hash æ§½çš„æ¦‚å¿µï¼Œé›†ç¾¤ä¼šé¢„å…ˆåˆ†é…16384ä¸ªæ§½ï¼ˆ<strong>slot</strong>ï¼‰ï¼Œå¹¶å°†è¿™äº›æ§½åˆ†é…ç»™å…·ä½“çš„æœåŠ¡èŠ‚ç‚¹ï¼Œé€šè¿‡å¯¹ Key è¿›è¡Œ CRC16(key)%16384 è¿ç®—å¾—åˆ°å¯¹åº”çš„æ§½æ˜¯å“ªä¸€ä¸ªï¼Œä»è€Œå°†è¯»å†™æ“ä½œè½¬å‘åˆ°è¯¥æ§½æ‰€å¯¹åº”çš„æœåŠ¡èŠ‚ç‚¹ã€‚å½“æœ‰æ–°çš„èŠ‚ç‚¹åŠ å…¥æˆ–è€…ç§»é™¤çš„æ—¶å€™ï¼Œå†æ¥è¿ç§»è¿™äº›æ§½ä»¥åŠå…¶å¯¹åº”çš„æ•°æ®ã€‚åœ¨è¿™ç§è®¾è®¡ä¹‹ä¸‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„è¿›è¡ŒåŠ¨æ€æ‰©å®¹æˆ–ç¼©å®¹ã€‚</p>
<p>å½“ç„¶ï¼Œå…³äºé«˜å¯ç”¨çš„å®ç°æ–¹æ¡ˆï¼Œä¹Ÿå¯ä»¥å°† Redis-Sentinel å’Œ Redis-Cluster ä¸¤ç§æ¨¡å¼ç»“åˆèµ·æ¥ä½¿ç”¨ï¼Œä¸è¿‡æ¯”è¾ƒå¤æ‚ï¼Œå¹¶ä¸å¤ªæ¨èã€‚</p>
<p>ä¸‹å›¾å±•ç¤ºäº† Redis Cluster åˆ†é… key å’Œ slot çš„åŸºæœ¬åŸç†ï¼š</p>
<p></p>
<p>ä¸€ä¸ªå…¸å‹çš„ Redis Cluster åˆ†å¸ƒå¼é›†ç¾¤ç”±å¤šä¸ªRedisèŠ‚ç‚¹ç»„æˆã€‚ä¸åŒçš„èŠ‚ç‚¹ç»„æœåŠ¡çš„æ•°æ®æ— äº¤é›†ï¼Œæ¯ä¸ªèŠ‚ç‚¹å¯¹åº”æ•°æ® sharding çš„ä¸€ä¸ªåˆ†ç‰‡ã€‚èŠ‚ç‚¹ç»„å†…éƒ¨åˆ†ä¸ºä¸»å¤‡ 2 ç±»ï¼Œå¯¹åº”å‰é¢å™è¿°çš„ master å’Œ slaveã€‚ä¸¤è€…æ•°æ®å‡†å®æ—¶ä¸€è‡´ï¼Œé€šè¿‡å¼‚æ­¥åŒ–çš„ä¸»å¤‡å¤åˆ¶æœºåˆ¶ä¿è¯ã€‚ä¸€ä¸ªèŠ‚ç‚¹ç»„æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª masterï¼ŒåŒæ—¶æœ‰0åˆ°å¤šä¸ª slaveã€‚<strong>åªæœ‰ master å¯¹å¤–æä¾›å†™æœåŠ¡ï¼Œè¯»æœåŠ¡å¯ç”± master/slave æä¾›</strong>ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p></p>
<p>ä¸Šå›¾ä¸­ï¼Œkey-value å…¨é›†è¢«åˆ†æˆäº† 5 ä»½ï¼Œ5ä¸ª slotï¼ˆå®é™…ä¸ŠRedis Clusteræœ‰ 16384 [0-16383] ä¸ªslotï¼Œæ¯ä¸ªèŠ‚ç‚¹æœåŠ¡ä¸€æ®µåŒºé—´çš„slotï¼Œè¿™é‡Œé¢ä»…ä»…ä¸¾ä¾‹ï¼‰ã€‚Aå’ŒBä¸ºmasterèŠ‚ç‚¹ï¼Œå¯¹å¤–æä¾›å†™æœåŠ¡ã€‚åˆ†åˆ«è´Ÿè´£ 1/2/3 å’Œ 4/5 çš„slotã€‚A/A1 å’ŒB/B1/B2 ä¹‹é—´é€šè¿‡ä¸»å¤‡å¤åˆ¶çš„æ–¹å¼åŒæ­¥æ•°æ®ã€‚</p>
<p>ä¸Šè¿°çš„5ä¸ªèŠ‚ç‚¹ï¼Œä¸¤ä¸¤é€šè¿‡ Redis Cluster Bus äº¤äº’ï¼Œç›¸äº’äº¤æ¢å¦‚ä¸‹çš„ä¿¡æ¯ï¼š</p>
<p>1ã€æ•°æ®åˆ†ç‰‡ï¼ˆslotï¼‰å’ŒèŠ‚ç‚¹çš„å¯¹åº”å…³ç³»ï¼›</p>
<p>2ã€é›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹å¯ç”¨çŠ¶æ€ï¼›</p>
<p>3ã€é›†ç¾¤ç»“æ„å‘ç”Ÿå˜æ›´æ—¶ï¼Œé€šè¿‡ä¸€å®šçš„åè®®å¯¹é…ç½®ä¿¡æ¯è¾¾æˆä¸€è‡´ã€‚æ•°æ®åˆ†ç‰‡çš„è¿ç§»ã€ä¸»å¤‡åˆ‡æ¢ã€å•ç‚¹ master çš„å‘ç°å’Œå…¶å‘ç”Ÿä¸»å¤‡å…³ç³»å˜æ›´ç­‰ï¼Œéƒ½ä¼šå¯¼è‡´é›†ç¾¤ç»“æ„å˜åŒ–ã€‚</p>
<p>4ã€publish/subscribeï¼ˆå‘å¸ƒè®¢é˜…ï¼‰åŠŸèƒ½ï¼Œåœ¨Clusterç‰ˆå†…éƒ¨å®ç°æ‰€éœ€è¦äº¤äº’çš„ä¿¡æ¯ã€‚</p>
<p>Redis Cluster Bus é€šè¿‡å•ç‹¬çš„ç«¯å£è¿›è¡Œè¿æ¥ï¼Œç”±äºBusæ˜¯èŠ‚ç‚¹é—´çš„å†…éƒ¨é€šä¿¡æœºåˆ¶ï¼Œäº¤äº’çš„æ˜¯å­—èŠ‚åºåˆ—åŒ–ä¿¡æ¯ã€‚ç›¸å¯¹ Client çš„å­—ç¬¦åºåˆ—åŒ–æ¥è¯´ï¼Œæ•ˆç‡è¾ƒé«˜ã€‚</p>
<p>Redis Clusteræ˜¯ä¸€ä¸ª<strong>å»ä¸­å¿ƒåŒ–</strong>çš„åˆ†å¸ƒå¼å®ç°æ–¹æ¡ˆï¼Œå®¢æˆ·ç«¯å’Œé›†ç¾¤ä¸­ä»»ä¸€èŠ‚ç‚¹è¿æ¥ï¼Œç„¶åé€šè¿‡åé¢çš„äº¤äº’æµç¨‹ï¼Œé€æ¸çš„å¾—åˆ°å…¨å±€çš„æ•°æ®åˆ†ç‰‡æ˜ å°„å…³ç³»ã€‚</p>
<p>æ›´å¤šæ›´è¯¦ç»†çš„ redis cluster çš„è¯´æ˜è¯·ç§»æ­¥<a href="https://redis.io/topics/cluster-tutorial" target="_blank" rel="noopener noreffer ">Redis Cluster å®˜æ–¹æ–‡æ¡£</a></p>
<h4 id="éƒ¨ç½²å®ä¾‹-2">éƒ¨ç½²å®ä¾‹</h4>
<p>Redis Cluster é›†ç¾¤<strong>è‡³å°‘éœ€è¦ä¸‰ä¸ª master èŠ‚ç‚¹</strong>ï¼Œæœ¬æ–‡å°†ä»¥å•æœºå¤šå®ä¾‹çš„æ–¹å¼éƒ¨ç½²3ä¸ªä¸»èŠ‚ç‚¹åŠ3ä¸ªä»èŠ‚ç‚¹ï¼Œ6ä¸ªèŠ‚ç‚¹å®ä¾‹åˆ†åˆ«ä½¿ç”¨ä¸åŒçš„ç«¯å£åŠå·¥ä½œç›®å½•</p>
<p>å®‰è£… redis åŒä¸Šï¼Œä¸èµ˜è¿°ã€‚</p>
<ol>
<li>ä¸ºæ¯ä¸ª redis èŠ‚ç‚¹åˆ†åˆ«åˆ›å»ºå·¥ä½œç›®å½•</li>
</ol>
<p>åœ¨rediså®‰è£…ç›®å½• /usr/local/redis-5.0.2 ä¸‹æ–°å»ºç›®å½• redis-clusterï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹å†æ–°å»º6ä¸ªå­ç›®å½•ï¼Œ7000,7001,8000,8001,9000,9001ï¼Œæ­¤æ—¶ç›®å½•ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p></p>
<ol start="2">
<li>ä¿®æ”¹é…ç½®</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">#å¼€å¯åå°è¿è¡Œ</span>
</span></span><span class="line"><span class="cl">daemonize yes
</span></span><span class="line"><span class="cl"><span class="c1">#å·¥ä½œç«¯å£</span>
</span></span><span class="line"><span class="cl">port <span class="m">7000</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ç»‘å®šæœºå™¨çš„å†…ç½‘IPæˆ–è€…å…¬ç½‘IP,ä¸€å®šè¦è®¾ç½®ï¼Œä¸è¦ç”¨ 127.0.0.1</span>
</span></span><span class="line"><span class="cl"><span class="nb">bind</span> 172.27.0.8  
</span></span><span class="line"><span class="cl"><span class="c1">#æŒ‡å®šå·¥ä½œç›®å½•ï¼Œrdb,aofæŒä¹…åŒ–æ–‡ä»¶å°†ä¼šæ”¾åœ¨è¯¥ç›®å½•ä¸‹ï¼Œä¸åŒå®ä¾‹ä¸€å®šè¦é…ç½®ä¸åŒçš„å·¥ä½œç›®å½•</span>
</span></span><span class="line"><span class="cl">dir /usr/local/redis-cluster/7000/
</span></span><span class="line"><span class="cl"><span class="c1">#å¯ç”¨é›†ç¾¤æ¨¡å¼</span>
</span></span><span class="line"><span class="cl">cluster-enabled yes 
</span></span><span class="line"><span class="cl"><span class="c1">#ç”Ÿæˆçš„é›†ç¾¤é…ç½®æ–‡ä»¶åç§°ï¼Œé›†ç¾¤æ­å»ºæˆåŠŸåä¼šè‡ªåŠ¨ç”Ÿæˆï¼Œåœ¨å·¥ä½œç›®å½•ä¸‹</span>
</span></span><span class="line"><span class="cl">cluster-config-file nodes-7000.conf 
</span></span><span class="line"><span class="cl"><span class="c1">#èŠ‚ç‚¹å®•æœºå‘ç°æ—¶é—´ï¼Œå¯ä»¥ç†è§£ä¸ºä¸»èŠ‚ç‚¹å®•æœºåä»èŠ‚ç‚¹å‡çº§ä¸ºä¸»èŠ‚ç‚¹æ—¶é—´</span>
</span></span><span class="line"><span class="cl">cluster-node-timeout <span class="m">5000</span> 
</span></span><span class="line"><span class="cl"><span class="c1">#å¼€å¯AOFæ¨¡å¼</span>
</span></span><span class="line"><span class="cl">appendonly yes 
</span></span><span class="line"><span class="cl"><span class="c1">#pid fileæ‰€åœ¨ç›®å½•</span>
</span></span><span class="line"><span class="cl">pidfile /var/run/redis_8001.pid 
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>
<p>æŒ‰ç…§ä¸Šé¢çš„æ ·ä¾‹å°†é…ç½®æ–‡ä»¶å¤åˆ¶åˆ°å¦å¤–5ä¸ªç›®å½•ä¸‹ï¼Œå¹¶å¯¹ portã€dirã€cluster-config-file ä¸‰ä¸ªå±æ€§åšå¯¹åº”ä¿®æ”¹ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ã€‚</p>
</li>
<li>
<p>å®‰è£… Ruby å’Œ RubyGems</p>
</li>
</ol>
<p>ç”±äºåˆ›å»º redis cluster éœ€è¦ç”¨åˆ° redis-trib å‘½ä»¤ï¼Œè€Œè¿™ä¸ªå‘½ä»¤ä¾èµ– Ruby å’Œ RubyGemsï¼Œå› æ­¤éœ€è¦å®‰è£…ä¸€ä¸‹ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>root@VM_0_15_centos redis-cluster<span class="o">]</span><span class="c1"># yum install ruby</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@VM_0_15_centos redis-cluster<span class="o">]</span><span class="c1"># yum install rubygems</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@VM_0_15_centos redis-cluster<span class="o">]</span><span class="c1"># gem install redis --version 3.3.3</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="5">
<li>åˆ†åˆ«å¯åŠ¨6ä¸ªèŠ‚ç‚¹</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>root@VM_0_15_centos redis-4.0.6<span class="o">]</span><span class="c1"># ./src/redis-server redis-cluster/7000/redis.conf</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@VM_0_15_centos redis-4.0.6<span class="o">]</span><span class="c1"># ./src/redis-server redis-cluster/7001/redis.conf</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@VM_0_15_centos redis-4.0.6<span class="o">]</span><span class="c1"># ./src/redis-server redis-cluster/8000/redis.conf</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@VM_0_15_centos redis-4.0.6<span class="o">]</span><span class="c1"># ./src/redis-server redis-cluster/8001/redis.conf</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@VM_0_15_centos redis-4.0.6<span class="o">]</span><span class="c1"># ./src/redis-server redis-cluster/9000/redis.conf</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@VM_0_15_centos redis-4.0.6<span class="o">]</span><span class="c1"># ./src/redis-server redis-cluster/9001/redis.conf</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="6">
<li>æŸ¥çœ‹æœåŠ¡è¿è¡ŒçŠ¶æ€</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>root@VM_0_15_centos redis-4.0.6<span class="o">]</span><span class="c1"># ps -ef | grep redis</span>
</span></span><span class="line"><span class="cl">root     <span class="m">20290</span>     <span class="m">1</span>  <span class="m">0</span> 18:33 ?        00:00:02 ./src/redis-server *:8001 <span class="o">[</span>cluster<span class="o">]</span>
</span></span><span class="line"><span class="cl">root     <span class="m">20295</span>     <span class="m">1</span>  <span class="m">0</span> 18:33 ?        00:00:02 ./src/redis-server *:8002 <span class="o">[</span>cluster<span class="o">]</span>
</span></span><span class="line"><span class="cl">root     <span class="m">20300</span>     <span class="m">1</span>  <span class="m">0</span> 18:33 ?        00:00:02 ./src/redis-server *:8003 <span class="o">[</span>cluster<span class="o">]</span>
</span></span><span class="line"><span class="cl">root     <span class="m">20305</span>     <span class="m">1</span>  <span class="m">0</span> 18:33 ?        00:00:02 ./src/redis-server *:8004 <span class="o">[</span>cluster<span class="o">]</span>
</span></span><span class="line"><span class="cl">root     <span class="m">20310</span>     <span class="m">1</span>  <span class="m">0</span> 18:33 ?        00:00:02 ./src/redis-server *:8005 <span class="o">[</span>cluster<span class="o">]</span>
</span></span><span class="line"><span class="cl">root     <span class="m">20312</span>     <span class="m">1</span>  <span class="m">0</span> 18:33 ?        00:00:02 ./src/redis-server *:8006 <span class="o">[</span>cluster<span class="o">]</span>
</span></span><span class="line"><span class="cl">root     <span class="m">22913</span> <span class="m">15679</span>  <span class="m">0</span> 19:31 pts/2    00:00:00 grep --color<span class="o">=</span>auto redis
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°6ä¸ªèŠ‚ç‚¹ä»¥åŠå…¨éƒ¨æˆåŠŸå¯åŠ¨</p>
<ol start="7">
<li>åˆ›å»º redis cluster</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[root@VM_0_15_centos redis-4.0.6]# ./src/redis-trib.rb create --replicas 1 172.27.0.8:7000 172.27.0.8:7001 172.27.0.8:8000 172.27.0.8:8001 172.27.0.8:9000 172.27.0.8:90001
</span></span></code></pre></td></tr></table>
</div>
</div><p>åˆ›å»ºè¿‡ç¨‹ä¸­ä¼šæœ‰éƒ¨åˆ†éœ€è¦ç¡®è®¤çš„åœ°æ–¹ï¼ŒæŒ‰ç…§æç¤ºè¾“å…¥å³å¯ï¼Œé›†ç¾¤åˆ›å»ºå®Œæ¯•åè§‚å¯Ÿä¸€ä¸‹è¿™ä¸ªé›†ç¾¤çš„èŠ‚ç‚¹çŠ¶æ€</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">172.27.0.8:7000&gt; cluster nodes
</span></span><span class="line"><span class="cl">068ac2afe1ade8b69b83226453fecc2b79cd93ae 172.27.0.8:7001@17001 slave 421ebe9e0a5ac6c811935ecd9dba83ef119dec17 <span class="m">0</span> <span class="m">1531008204920</span> <span class="m">4</span> connected
</span></span><span class="line"><span class="cl">784c727c83a5952d3714ac211021f909cc4dfee4 172.27.0.8:8001@18001 slave eb5d700e2f030c02fb1f30ba4420d0b4f7170d84 <span class="m">0</span> <span class="m">1531008203000</span> <span class="m">5</span> connected
</span></span><span class="line"><span class="cl">0537099e7cc7ab595c7aad5f0c96985251b85ec0 172.27.0.8:9001@19001 slave 79262341417df0a11eaf31e72bbf3e26f5f60ebf <span class="m">0</span> <span class="m">1531008204419</span> <span class="m">6</span> connected
</span></span><span class="line"><span class="cl">421ebe9e0a5ac6c811935ecd9dba83ef119dec17 172.27.0.8:7000@17000 myself,master - <span class="m">0</span> <span class="m">1531008204000</span> <span class="m">1</span> connected 0-5460
</span></span><span class="line"><span class="cl">eb5d700e2f030c02fb1f30ba4420d0b4f7170d84 172.27.0.8:8000@18000 master - <span class="m">0</span> <span class="m">1531008203000</span> <span class="m">2</span> connected 5461-10922
</span></span><span class="line"><span class="cl">79262341417df0a11eaf31e72bbf3e26f5f60ebf 172.27.0.8:9000@19000 master - <span class="m">0</span> <span class="m">1531008203419</span> <span class="m">3</span> connected 10923-16383
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚ä¸Šæ‰€ç¤ºï¼Œä¸€ä¸ª 3ä¸»3ä»çš„ redis cluster åˆ†å¸ƒå¼é›†ç¾¤å°±æ­å»ºæˆåŠŸäº†ï¼Œ7000ã€8000ã€9000åˆ†åˆ«æ˜¯ä¸‰ä¸ª master èŠ‚ç‚¹ï¼Œ7001ã€8001å’Œ9001ä¸ºå¯¹åº”çš„ slaver èŠ‚ç‚¹ã€‚</p>
<p>å…¶å®å¦‚æœä½ å¹¶ä¸æƒ³ç®¡è¿™ä¹ˆå¤šé…ç½®è€Œåªæ˜¯æƒ³åœ¨æœ€å¿«çš„é€Ÿåº¦å†…åˆ›å»ºä¸€ä¸ª redis cluster ç”¨ä½œæµ‹è¯•æˆ–è€…å…¶ä»–ç”¨é€”ï¼Œ redis å®˜æ–¹åœ¨ redis å®‰è£…ç›®å½•çš„ Utils ç›®å½•ä¸‹æä¾›äº†ä¸€ä¸ª create-cluster çš„è„šæœ¬ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p></p>
<p>åªè¦æ‰§è¡Œä¸€ä¸‹è¿™ä¸ªè„šæœ¬å°±èƒ½è‡ªåŠ¨åˆ›å»ºä¸€ä¸ª clusterï¼š</p>
<p>[å›¾ç‰‡ä¸Šä¼ å¤±è´¥&hellip;(image-c6eea0-1554881540128)]</p>
<p>è¿›å…¥åˆ°è¿™ä¸ªç›®å½•ä¸‹ï¼Œæ‰§è¡Œ<code>./create-cluster start</code>ï¼Œå³å¯ç«‹å³å®Œæˆä¸€ä¸ª ä¸‰ä¸»ä¸‰ä»çš„ redis-cluster çš„æ­å»ºï¼š</p>
<p></p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºå°±æ˜¯ç›´æ¥ä½¿ç”¨è¿™ä¸ªè„šæœ¬åˆ›å»ºçš„ redis clusterï¼š</p>
<p></p>
<h4 id="tips">Tips</h4>
<ol>
<li>
<p>å¦‚æœæƒ³é‡æ–°åˆ›å»ºé›†ç¾¤ï¼Œéœ€è¦ç™»å½•åˆ°æ¯ä¸ªèŠ‚ç‚¹ï¼Œæ‰§è¡Œ flushdbï¼Œç„¶åæ‰§è¡Œcluster resetï¼Œé‡å¯èŠ‚ç‚¹ï¼›</p>
</li>
<li>
<p>å¦‚æœè¦æ‰¹é‡æ€æ‰Redisè¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ pkill redis-serverå‘½ä»¤ï¼›</p>
</li>
<li>
<p>å¦‚æœrediså¼€å¯äº†å¯†ç è®¤è¯ï¼Œåˆ™éœ€è¦åœ¨redis.confä¸­å¢åŠ å±æ€§ : masterauth yourpassword ï¼Œå¹¶ä¸”éœ€è¦ä¿®æ”¹/usr/local/share/gems/gems/redis-3.3.3/lib/redisç›®å½•ä¸‹çš„client.rbæ–‡ä»¶ï¼Œå°†passwordå±æ€§è®¾ç½®ä¸ºredis.confä¸­çš„requirepassçš„å€¼ï¼Œä¸åŒçš„æ“ä½œç³»ç»Ÿclient.rbçš„ä½ç½®å¯èƒ½ä¸ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨ find / -name &ldquo;client.rb&quot;å…¨ç›˜æŸ¥æ‰¾ä¸€ä¸‹ï¼›</p>
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="nv">DEFAULTS</span> <span class="o">=</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">      :url <span class="o">=</span>&gt; lambda <span class="o">{</span> ENV<span class="o">[</span><span class="s2">&#34;REDIS_URL&#34;</span><span class="o">]</span> <span class="o">}</span>,
</span></span><span class="line"><span class="cl">      :scheme <span class="o">=</span>&gt; <span class="s2">&#34;redis&#34;</span>,
</span></span><span class="line"><span class="cl">      :host <span class="o">=</span>&gt; <span class="s2">&#34;127.0.0.1&#34;</span>,
</span></span><span class="line"><span class="cl">      :port <span class="o">=</span>&gt; 6379,
</span></span><span class="line"><span class="cl">      :path <span class="o">=</span>&gt; nil,
</span></span><span class="line"><span class="cl">      :timeout <span class="o">=</span>&gt; 5.0,
</span></span><span class="line"><span class="cl">      :password <span class="o">=</span>&gt; <span class="s2">&#34;yourpassword&#34;</span>,
</span></span><span class="line"><span class="cl">      :db <span class="o">=</span>&gt; 0,
</span></span><span class="line"><span class="cl">      :driver <span class="o">=</span>&gt; nil,
</span></span><span class="line"><span class="cl">      :id <span class="o">=</span>&gt; nil,
</span></span><span class="line"><span class="cl">      :tcp_keepalive <span class="o">=</span>&gt; 0,
</span></span><span class="line"><span class="cl">      :reconnect_attempts <span class="o">=</span>&gt; 1,
</span></span><span class="line"><span class="cl">      :inherit_socket <span class="o">=</span>&gt; <span class="nb">false</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="4">
<li>Rediså¼€å¯å¯†ç è®¤è¯åï¼Œåœ¨é›†ç¾¤æ“ä½œæ—¶é—®é¢˜ä¼šæ¯”è¾ƒå¤šï¼Œå› æ­¤åœ¨éç‰¹æ®Šæƒ…å†µä¸‹ä¸å»ºè®®å¼€å¯å¯†ç è®¤è¯ï¼Œå¯ä»¥æ­é…ä½¿ç”¨é˜²ç«å¢™ä¿è¯ Redis çš„å®‰å…¨ã€‚</li>
</ol>
<p>æ•…éšœæµ‹è¯•çš„æ–¹æ³•ä¸ä¸Šé¢ä¸€æ ·ï¼Œæ•…ä¸èµ˜è¿°ã€‚</p>
<h3 id="æ€»ç»“">æ€»ç»“</h3>
<p>Redis æœåŠ¡çš„éƒ¨ç½²æ–¹æ¡ˆçš„é€‰å‹å¤§å®¶æ ¹æ®è‡ªå·±é¡¹ç›®çš„éœ€æ±‚éƒ¨ç½²å³å¯ï¼Œä¸€èˆ¬æ¥è¯´ redis sentinel å°±å¤Ÿç”¨äº†ï¼Œä¹Ÿæ˜¯ç›®å‰ç”¨å¾—æœ€å¤šçš„æ¨¡å¼ï¼Œä½†æ˜¯ redis 3.0 ä¹‹åå®˜æ–¹æ¨å‡ºçš„ redis-cluster è™½ç„¶æœ¬è´¨æ˜¯ç”¨äºå®ç°æ•°æ®åˆ†ç‰‡å’Œåˆ†å¸ƒå¼å­˜å‚¨ï¼Œä½†æ˜¯å…¶ä¹Ÿå®ç°äº† redis sentinel çš„å…¨éƒ¨åŠŸèƒ½ï¼Œæœ‰å®Œå…¨çš„ HA èƒ½åŠ›ï¼Œå¹¶ä¸”éƒ¨ç½²èµ·æ¥æ›´ç®€å•ï¼Œå› æ­¤æˆä¸ºäº†å®˜æ–¹æ¨èçš„ HA æ–¹æ¡ˆã€‚æˆ‘ä¸ªäººä¹Ÿæ›´åŠ æ¨è redis cluster æ–¹æ¡ˆã€‚</p>]]></description>
</item>
</channel>
</rss>
